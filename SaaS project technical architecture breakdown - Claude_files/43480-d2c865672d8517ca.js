try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4467d364-62fe-4ca6-8e9e-3cc34e8aaca5",e._sentryDebugIdIdentifier="sentry-dbid-4467d364-62fe-4ca6-8e9e-3cc34e8aaca5")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43480],{0x6700eaaa:(e,n,t)=>{t.d(n,{ak:()=>l,cO:()=>i,xI:()=>o});var a=t(0x1b813d90),r=t(0x10a2d47e3);let i="settings",o=e=>a.sb[e]||e,l=()=>{let e=(0,r.wc)();return n=>n===a.v8.FIDDLEHEAD&&e[r.Wj]?e[r.Wj]:n===a.v8.CUTTLEFISH&&e[r.in]?e[r.in]:a.sb[n]||n}},0xe0c26d90:(e,n,t)=>{t.d(n,{tn:()=>w,nB:()=>p,rW:()=>x,bo:()=>S,Cq:()=>m,b4:()=>y,yL:()=>_,VX:()=>L});var a=t(0x12c9046cd),r=t(0x14de19ae8),i=t(0x49fac030),o=t(0xac309a83),l=t(0x1b813d90),s=t(0x1bd175d8c),d=t(0x17e725145),u=t(0x20892a038),c=t(0x4d348f95),f=t(0xfc89b4a4),h=t(0x21fe74567),g=t(0x18175ce17),b=t(0xc6857cab);let v="github_success",p=function(){var e;let{callerIdentifier:n,toggleGithubModalOpen:t,fetchImmediately:o=!1,pathname:l,queryString:d,shouldRedirectToDesktopApp:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:b}=(0,r.YL)(),p=null==b?void 0:b.uuid,x=m(),[y,_]=(0,f.useState)(o),w=(e=>{let{shouldFetch:n=!1}=e,{activeOrganization:t}=(0,r.YL)(),o=null==t?void 0:t.uuid,l=m();return(0,a.Sk)("/api/organizations/".concat(o,"/sync/github/auth"),{queryKey:[i.Hv,{orgUuid:o}],enabled:!!(n&&t&&l),meta:{noToast:!0}})})({shouldFetch:y}),S=(0,f.useCallback)(async function(){var e,n;let{forceRefetch:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!y||t?(_(!0),null==(e=(await w.refetch()).data)?void 0:e.is_authenticated):null==(n=w.data)?void 0:n.is_authenticated},[w,y]),{mutate:L}=(0,a.L2)("/api/organizations/".concat(p,"/sync/github/auth/start"),"POST",{enabled:!!(b&&x),onSuccess:e=>{if(function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===n.length)return!1;try{if(!e.startsWith("http://")&&!e.startsWith("https://"))return!1;let t=new URL(e);return"https:"===t.protocol&&n.some(e=>t.hostname===e||t.hostname.endsWith(".".concat(e)))}catch(e){return!1}}(e.redirect_url,["github.com"]))window.location.href=e.redirect_url;else throw Error("Invalid redirect URL received from auth endpoint")}}),j="".concat(v,"=").concat(n).concat(d?"&".concat(d):"");(0,g.FZ)({callerIdentifier:n,successParam:v,handleOpen:()=>{null==t||t(!0)}});let C=(0,c.useSearchParams)(),D=(0,s.V)(),I=(0,f.useRef)(!1),E=(0,c.usePathname)(),A=(0,h.d)({pathname:l||E,searchParams:C,queryString:j,shouldOpenInClaudeApp:D||!!u});return{checkIsGithubAuthenticated:S,initGithubAuth:()=>{if(x){if(D)return void window.open("/settings/connectors?open_in_browser=1&auth_start=github&origin=".concat(A));I.current||(I.current=!0,L({pre_auth_state:{origin:A}}))}},isGithubAuthenticated:null==(e=w.data)?void 0:e.is_authenticated,isLoading:w.isLoading}},x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,r.YL)(),t=null==n?void 0:n.uuid,o=m(),l=(0,d.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/sync/github/auth"),"DELETE",{enabled:!!(n&&o),...e,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];l.invalidateQueries({queryKey:[i.Hv,{orgUuid:t}]}),null==(n=e.onSuccess)||n.call(e,...r)}})},m=()=>{let{data:e}=(0,g.LN)(),n=(0,r.mV)(),t=!!(Array.isArray(e)&&e.find(e=>e.type===l.v8.GITHUB&&e.enabled));return!!(!b.env.NEXT_PUBLIC_DISABLE_GITHUB_INTEGRATION&&(!n||t))},y=()=>{let{activeOrganization:e}=(0,r.YL)(),n=null==e?void 0:e.uuid,t=m();return(0,a.Sk)("/api/organizations/".concat(n,"/sync/github/repos"),{queryKey:[i.jL,{orgUuid:n}],enabled:!!(e&&t),meta:{noToast:!0}})},_=function(){let{skipStatus:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,r.YL)(),t=null==n?void 0:n.uuid,i=m(),l=(0,o.fS)("bad_moon_rising_skip_status"),s=null!=e?e:l,d=new URLSearchParams({skip_status:s.toString()}).toString();return(0,a.Sk)("/api/organizations/".concat(t,"/code/repos?").concat(d),{queryKey:["SYNC_GH_REPOS_WITH_STATUS_QUERY_KEY",{orgUuid:t,skipStatus:s}],enabled:!!(n&&t&&i),meta:{noToast:!0}})},w=e=>{var n;let{owner:t,repo:o,branch:l}=e,s=(e=>{let{owner:n,repo:t,branch:o}=e,{activeOrganization:l}=(0,r.YL)(),s=null==l?void 0:l.uuid,d=m(),u=new URLSearchParams({owner:null!=n?n:"",repo:null!=t?t:""}).toString();return(0,a.Sk)("/api/organizations/".concat(s,"/sync/github/repo?").concat(u),{queryKey:[i.yB,{orgUuid:s,owner:n,repo:t}],enabled:!!(n&&t&&!o&&l&&d),meta:{noToast:!0}})})({owner:t,repo:o,branch:l}),d=(e=>{let{owner:n,repo:t,branch:o}=e,{activeOrganization:l}=(0,r.YL)(),s=null==l?void 0:l.uuid,d=m();return(0,a.Sk)("/api/organizations/".concat(s,"/sync/github/repo/").concat(n,"/").concat(t,"/tree/").concat(o),{queryKey:[i.o6,{orgUuid:s,owner:n,repo:t,branch:o}],staleTime:3e5,enabled:!!(n&&t&&o&&l&&d),meta:{noToast:!0}})})({owner:t,repo:o,branch:l||(null==(n=s.data)?void 0:n.default_branch)});return{data:{repo:s.data,tree:d.data},isFetching:s.isFetching||d.isFetching,error:s.error||d.error}},S=e=>{let{repoBranches:n,enabled:t=!0}=e,{activeOrganization:a}=(0,r.YL)(),o=null==a?void 0:a.uuid,l=m(),s=[...n].sort((e,n)=>"".concat(e.repo,":").concat(e.branch).localeCompare("".concat(n.repo,":").concat(n.branch)));return(0,u.useQuery)({queryKey:[i.uh,{orgUuid:o,repoBranches:s}],queryFn:async()=>{let e=await fetch("/api/github/organizations/".concat(o,"/github_batch_branch_status"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({repo_branches:s})});if(!e.ok)throw Error("Failed to fetch branch statuses: ".concat(e.status));return e.json()},enabled:!!(a&&l&&s.length>0&&t),staleTime:5e3,refetchOnWindowFocus:!0})},L=e=>{let n,{repo:t,branch:a,enabled:o=!0}=e,{activeOrganization:l}=(0,r.YL)(),s=null==l?void 0:l.uuid,c=(0,d.useQueryClient)(),f=[i.uh,{orgUuid:s}];for(let[,e]of c.getQueriesData({queryKey:f,exact:!1}))if((null==e?void 0:e.branch_statuses)&&(n=e.branch_statuses.find(e=>e.repo===t&&e.branch===a)))break;let{data:h}=(e=>{let{repo:n,branch:t,enabled:a=!0}=e,{activeOrganization:o}=(0,r.YL)(),l=null==o?void 0:o.uuid,s=m();return(0,u.useQuery)({queryKey:[i.i8,{orgUuid:l,repo:n,branch:t}],queryFn:async()=>{let e=await fetch("/api/github/organizations/".concat(l,"/github_batch_branch_status"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({repo_branches:[{repo:n,branch:t}]})});if(!e.ok)throw Error("Failed to fetch single branch status: ".concat(e.status));return(await e.json()).branch_statuses[0]},enabled:!!(o&&s&&n&&t&&a),staleTime:5e3,refetchOnWindowFocus:!0})})({repo:t,branch:a,enabled:o});return!h&&n?n:h&&!n||h?h:void 0}},0xecd80d84:(e,n,t)=>{t.d(n,{Qp:()=>c,eF:()=>u,w5:()=>d});var a=t(0x12c9046cd),r=t(0x14de19ae8),i=t(0xac309a83),o=t(0x10a2d47e3),l=t(0x17e725145),s=t(0x4d348f95);let d=()=>(0,i.fS)("fiddlehead"),u=()=>{let{activeOrganization:e}=(0,r.YL)(),n=null==e?void 0:e.uuid,t=d(),i=(0,o.wc)(),{data:l,isFetched:u}=(0,a.Sk)("/api/oauth/organizations/".concat(n,"/oauth_tokens"),{enabled:!!(n&&t),staleTime:3e5}),c=(0,s.useSearchParams)().get("debug_fiddlehead_auth_override"),f=i[o.me],h=f&&(null==l?void 0:l.some(e=>e.application_name===f));return{isAuthenticated:null!==c?"1"===c:h,isFetched:u,initAuth:()=>{window.open(i[o.vf],"_blank")}}},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,r.YL)(),t=null==n?void 0:n.uuid,i=d(),o=(0,l.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/fiddlehead/disconnect_and_delete_all"),"POST",{enabled:!!(n&&i),...e,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];o.invalidateQueries({queryKey:["/api/oauth/organizations/".concat(t,"/oauth_tokens")]}),null==(n=e.onSuccess)||n.call(e,...r)}})}},0xfb91a209:(e,n,t)=>{t.d(n,{Q:()=>s,t:()=>d});var a=t(0x22102fd88),r=t(0x286b4261),i=t.n(r),o=t(0xfc89b4a4);let l=(0,o.createContext)({isOpen:!1,dropdownToOpen:void 0,openModal:i(),closeModal:i(),clearCallerIdentifier:i()}),s=e=>{let{children:n}=e,[t,r]=(0,o.useState)(!1),i=(0,o.useRef)(void 0),[s,d]=(0,o.useState)(void 0);return(0,a.jsx)(l.Provider,{value:{isOpen:t,openModal:e=>{r(!0),i.current=e},closeModal:()=>{r(!1),d(i.current)},dropdownToOpen:s,clearCallerIdentifier:()=>{d(void 0)}},children:n})},d=()=>(0,o.useContext)(l)},0x1065e58a2:(e,n,t)=>{t.d(n,{AI:()=>d,I5:()=>u,n0:()=>s,qp:()=>c,so:()=>f});var a=t(0x12c9046cd),r=t(0x14de19ae8),i=t(0x49fac030);t(0x1b813d90);var o=t(0x17e725145);t(0xfc89b4a4);var l=t(0x18175ce17);let s=e=>{let{uri:n}=e,{data:t,isLoading:o}=(e=>{let{documentId:n}=e,{account:t,activeOrganization:o}=(0,r.YL)(),l=null==t?void 0:t.uuid,s=null==o?void 0:o.uuid,u=d();return(0,a.Sk)("/api/organizations/".concat(s,"/sync/mcp/outline/document/").concat(n),{queryKey:[i.hq,{accountUUID:l,orgUuid:s,documentId:n}],enabled:u})})({documentId:n});return{title:null==t?void 0:t.title,isLoading:o}},d=()=>{let{data:e}=(0,l.LN)();return!1},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,r.YL)(),o=null==t?void 0:t.uuid,l=d(),{data:s,refetch:u}=(0,a.Sk)("/api/organizations/".concat(o,"/sync/mcp/outline/auth"),{queryKey:[i.iP,{accountUUID:null==n?void 0:n.uuid,orgUuid:o}],enabled:!!(t&&l),staleTime:5e3}),{mutate:c,isPending:f}=(0,a.L2)("/api/organizations/".concat(o,"/sync/mcp/outline/auth/start"),"POST",{enabled:!!(t&&l),...e,onSuccess:function(){for(var n,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];null==(n=e.onSuccess)||n.call(e,...a)}});return{isOutlineAuthenticated:!!(null==s?void 0:s.is_authenticated),refetch:u,initOutlineAuth:c,isLoadingOutlineAuthInit:f}},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,r.YL)(),l=null==n?void 0:n.uuid,s=null==t?void 0:t.uuid,u=d(),c=(0,o.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(s,"/sync/mcp/outline/auth"),"DELETE",{enabled:!!(t&&u),...e,onSuccess:function(){for(var n,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];c.invalidateQueries({queryKey:[i.iP,{accountUUID:l,orgUuid:s}]}),null==(n=e.onSuccess)||n.call(e,...a)}})},f=()=>{let e=encodeURIComponent(window.location.href);window.location.href="/settings/connectors?redirect_url=".concat(e,"&open_outline_auth=true")}},0x11c7a82c2:(e,n,t)=>{t.d(n,{R:()=>a.R});var a=t(0x1c4b61688)},0x12bb05cb6:(e,n,t)=>{t.d(n,{ms:()=>d,RP:()=>b,Bi:()=>f,tJ:()=>y,o_:()=>x,cm:()=>p,DG:()=>L,MS:()=>v,FV:()=>S,Wn:()=>w,AM:()=>u,q:()=>_});var a=t(0x22102fd88),r=t(0x11cf7113d),i=t(0x10f221f41),o=t(0x1a1f6dda6),l=t(0x1fb5bdc42),s=t(0xfc89b4a4);function d(e){let{trigger:n,children:t,unstyledTrigger:r=!1,...i}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(c,{...i,trigger:r?(0,a.jsx)(l.l9,{asChild:!0,children:n}):(0,a.jsx)(g,{asChild:!0,children:n}),children:t})})}function u(e){let{children:n,open:t,mainButtonText:r,onClickMainButton:s,align:d="end",...u}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(c,{...u,align:d,trigger:(0,a.jsxs)("div",{className:"flex h-8 whitespace-nowrap",children:[(0,a.jsx)("button",{className:(0,o.A)("font-base-bold !text-xs rounded-l-lg bg-bg-000 h-full flex items-center justify-center px-2 border-y border-l border-border-200 hover:bg-bg-200",t&&"bg-bg-200"),onClick:s,children:r}),(0,a.jsx)(l.l9,{asChild:!0,children:(0,a.jsx)("button",{className:"bg-bg-000 flex items-center justify-center px-1 hover:bg-bg-200 rounded-r-lg border border-border-200",children:(0,a.jsx)(i.biH,{size:16})})})]}),children:n})})}function c(e){var n;let{matchTriggerWidth:t=!1,children:r,open:i,onOpenChange:o,trigger:s,modal:d,...u}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(l.bL,{open:i,onOpenChange:o,modal:d,children:[s,(0,a.jsx)(l.ZL,{children:(0,a.jsx)(h,{style:t?{width:"var(--radix-dropdown-menu-trigger-width)"}:void 0,sideOffset:null!=(n=u.sideOffset)?n:4,...u,children:r})})]})})}let f=(0,s.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)(l.lp,{ref:n,className:(0,o.A)("outline-none py-2 px-1.5 -mx-1 -mt-1 mb-1 border-b-0.5 border-border-200",t),...r})});f.displayName="DropdownInputHeader";let h=(0,s.forwardRef)((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)(l.UC,{ref:n,className:(0,o.A)("p-1.5",r.io,r.dk,t),...i})});h.displayName="Content";let g=(0,s.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)(l.l9,{ref:n,className:(0,o.A)("rounded py-1 px-2 max-w-full whitespace-nowrap text-ellipsis overflow-hidden",t),...r})});g.displayName="Trigger";let b=l.I,v=l.Pb,p=l.ZL,x=(0,s.forwardRef)((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)(l.lp,{ref:n,className:(0,o.A)(r.bS,t),...i})});x.displayName="DropdownLabel";let m=(0,s.forwardRef)((e,n)=>{let{className:t,disabled:i,danger:s,...d}=e;return(0,a.jsx)(l.q7,{ref:n,className:(0,o.A)(r.MQ,i&&r.BK,s&&r.uz,t),...d})});m.displayName="BaseDropdownItem";let y=(0,s.forwardRef)((e,n)=>{let{children:t,icon:r,trailing:i,...o}=e;return r||i?(0,a.jsx)(m,{ref:n,...o,children:(0,a.jsxs)("div",{className:"flex items-center gap-2 w-full font-base group",children:[r,(0,a.jsx)("span",{className:"flex-1 truncate",children:t}),i&&(0,a.jsx)("div",{className:"flex items-center flex-shrink-0 -mr-2",children:i})]})}):(0,a.jsx)(m,{ref:n,...o,children:t})});function _(e){let{className:n,...t}=e;return(0,a.jsx)("div",{className:(0,o.A)("font-base min-h-8 px-2 py-1.5 rounded-lg whitespace-nowrap overflow-hidden text-ellipsis flex justify-between gap-2 items-center",n),...t})}y.displayName="DropdownItem";let w=(0,s.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)(l.ZP,{ref:n,className:(0,o.A)('font-base min-h-8 px-2 py-1.5 rounded-lg cursor-pointer whitespace-nowrap overflow-hidden text-ellipsis grid grid-cols-[minmax(0,_1fr)_auto] gap-2 items-center outline-none select-none [&[data-highlighted]]:bg-bg-200 [&[data-highlighted]]:text-text-300 [&[data-state="open"]:not([data-highlighted])]:bg-bg-100 [&[data-state="open"]:not([data-highlighted])]:text-text-300',t),...r})});w.displayName="DropdownSubTrigger";let S=(0,s.forwardRef)((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)(l.G5,{ref:n,className:(0,o.A)("p-1.5",r.io,"max-h-[calc(100vh-16px)] overflow-y-auto overflow-x-hidden",t),...i})});S.displayName="DropdownSubContent";let L=(0,s.forwardRef)((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)(l.mB,{ref:n,className:(0,o.A)(r.uR,t),...i})});L.displayName="DropdownSeparator"},0x132295873:(e,n,t)=>{t.d(n,{m:()=>x});var a=t(0x22102fd88),r=t(0x19273021e),i=t(0x14de19ae8),o=t(0x139b5e710),l=t(0x11c7a82c2),s=t(0x1b813d90),d=t(0x10a2d47e3),u=t(0xfc89b4a4),c=t(0x1ab0d1ca1),f=t(0x1d302b010),h=t(0x1334f6ecc),g=t(0xecd80d84),b=t(0xe0c26d90),v=(t(0x1065e58a2),t(0x18175ce17)),p=t(0x6700eaaa);function x(e){let{type:n,server:t,onClose:r,onDisconnect:i}=e;if(t)return(0,a.jsx)(w,{server:t,onClose:r,onDisconnect:i});switch(n){case s.v8.GITHUB:return(0,a.jsx)(m,{onClose:r,onDisconnect:i});case s.v8.GDRIVE:return(0,a.jsx)(y,{onClose:r,onDisconnect:i});case s.v8.OUTLINE:return;case s.v8.FIDDLEHEAD:return(0,a.jsx)(S,{onClose:r,onDisconnect:i});case s.v8.CUTTLEFISH:return(0,a.jsx)(L,{onClose:r,onDisconnect:i});default:return(0,a.jsx)(_,{type:n,onClose:r,onDisconnect:i})}}function m(e){let{onClose:n,onDisconnect:t}=e,{mutate:r,isPending:i}=(0,b.rW)(),o=(0,u.useCallback)(()=>{r(),null==t||t()},[r,t]);return(0,a.jsx)(j,{name:"GitHub",onDisconnect:o,disconnecting:i,onClose:n})}function y(e){let{onClose:n,onDisconnect:t}=e,{mutate:r,isPending:i}=(0,h.U5)(),o=(0,c.A)(),l=(0,u.useCallback)(()=>{r(),null==t||t()},[r,t]);return(0,a.jsx)(j,{name:"Google Drive",onDisconnect:l,disconnecting:i,onClose:n,modalMessageOverride:o.formatMessage({defaultMessage:"You won’t be able to continue any previous chats that reference content from Google Docs.",id:"Zi7eVRnAwf"})})}function _(e){let{type:n,onClose:t,onDisconnect:r}=e,{disconnect:i}=(0,v.ob)(n),o=(0,u.useCallback)(()=>{i(),null==r||r()},[i,r]);return(0,a.jsx)(j,{name:(0,p.xI)(n),onDisconnect:o,disconnecting:!1,onClose:t})}function w(e){let{server:n,onClose:t,onDisconnect:r}=e,l=(0,c.A)(),{activeOrganization:s}=(0,i.YL)(),{addError:d}=(0,o.Y)(),{mutate:h,isPending:g}=(0,f.W3)((null==s?void 0:s.uuid)||"",n.uuid,{onError:e=>{d(l.formatMessage({defaultMessage:"Failed to disconnect from server",id:"L488a5jdgF"}),{error:e,messageForLogging:"Failed to disconnect from server"})}}),b=(0,u.useCallback)(()=>{h(),null==r||r()},[h,r]);return(0,a.jsx)(j,{name:n.name,onDisconnect:b,disconnecting:g,onClose:t})}function S(e){let{onClose:n,onDisconnect:t}=e,{mutate:r,isPending:i}=(0,g.Qp)(),o=(0,p.ak)(),l=(0,d.wc)(),c=l[d.BU],f=l[d.jT],h=l[d.fh],b=(0,u.useCallback)(()=>{r(),null==t||t()},[r,t]);return(0,a.jsx)(j,{name:o(s.v8.FIDDLEHEAD),onDisconnect:b,disconnecting:i,onClose:n,modalMessageOverride:c,modalTitleOverride:f,modalButtonOverride:h})}function L(e){let{onClose:n,onDisconnect:t}=e,{mutate:i,isPending:o}=(0,r.fH)(),l=(0,p.ak)(),d=(0,u.useCallback)(()=>{i(),null==t||t()},[i,t]);return(0,a.jsx)(j,{name:l(s.v8.CUTTLEFISH),onDisconnect:d,disconnecting:o,onClose:n})}function j(e){let{name:n,onDisconnect:t,disconnecting:r,onClose:i,modalMessageOverride:o,modalTitleOverride:s,modalButtonOverride:d}=e,u=(0,c.A)(),f=null!=s?s:u.formatMessage({defaultMessage:"Disconnect {integrationName}?",id:"MUrNVj88RO"},{integrationName:n}),h=null!=d?d:u.formatMessage({defaultMessage:"Disconnect",id:"qj1uhzynub"}),g=null!=o?o:u.formatMessage({defaultMessage:"You can still continue previous chats that reference {integrationName} content. However, Claude won’t be able to access new content or perform new tasks.",id:"tlmLidjA7e"},{integrationName:n});return(0,a.jsx)(l.R,{isOpen:!0,onClose:i,title:f,onConfirm:()=>{t(),i()},confirmText:h,variant:"danger",autoFocus:!1,message:g,size:"md",isLoading:r})}},0x1334f6ecc:(e,n,t)=>{t.d(n,{$f:()=>F,Gk:()=>I,K6:()=>q,L5:()=>Y,LP:()=>C,U5:()=>T,cI:()=>E,cj:()=>A,ef:()=>P,fb:()=>M,kJ:()=>D,qL:()=>R,vT:()=>z,y:()=>k,yy:()=>L,zF:()=>N,zH:()=>O});var a=t(0x17aa9d8d7),r=t(0x12c9046cd),i=t(0x14de19ae8),o=t(0x139b5e710),l=t(0x49fac030),s=t(0xac309a83),d=t(0x1b813d90),u=t(0x1bd175d8c),c=t(0x78b33fbd),f=t(0x17e725145),h=t(0x4d348f95),g=t(0xfc89b4a4),b=t(0x1ab0d1ca1),v=t(0x87b1176c),p=t(0xfb91a209),x=t(0x187ab14f6),m=t(0x21fe74567),y=t(0x31c535e9),_=t(0x18175ce17),w=t(0xc6857cab);let S="gdrive_success",L=()=>{let e=(0,i.mV)(),{data:n}=(0,_.LN)(),t=(0,_.kO)(),a=(0,_.qi)(d.v8.GDRIVE),r=!1;if(t){var o;let e=Array.isArray(n)?n.find(e=>e.type===d.v8.MCP_RESOURCES):null;(null==a?void 0:a.uuid)&&(null==e||null==(o=e.config)?void 0:o.servers)&&(r=!!e.config.servers[a.uuid])}else r=!!(Array.isArray(n)&&n.find(e=>e.type===d.v8.GDRIVE&&e.enabled));return!e||r},j=()=>{let e=(0,s.fS)("kingfisher_enabled"),n=(0,c.useLayer)("trials_freemium").get("free_integrations",!1);return e||n},C=()=>{let e=L(),n=j();return!!(!w.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION&&n&&e)},D=()=>{let{account:e,activeOrganization:n}=(0,i.YL)(),t=null==n?void 0:n.uuid,a=C(),{data:o,isFetched:s}=(0,r.Sk)("/api/organizations/".concat(t,"/sync/mcp/drive/auth"),{queryKey:[l.jR,{accountUUID:null==e?void 0:e.uuid,orgUuid:t}],enabled:a,staleTime:3e5});return{isAuthenticated:a&&!!(null==o?void 0:o.is_authenticated),isFetched:s}},I=()=>{let e=(0,_.kO)(),n=(0,_.dJ)(d.v8.GDRIVE),t=(0,_.hm)(d.v8.GDRIVE);return e?n:t},E=function(){let{callerIdentifier:e,handleAuthSuccess:n,pathname:t,queryString:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,_.kO)(),{isAuthenticated:c,startAuth:v,isFetched:x}=(0,_.ob)(d.v8.GDRIVE,{callerIdentifier:e,handleAuthSuccess:n,pathname:t,queryString:a}),{isAuthenticated:y,isFetched:w}=D(),{addSuccess:L}=(0,o.Y)(),j=(0,b.A)(),{dropdownToOpen:I,clearCallerIdentifier:E}=(0,p.t)(),A=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null==n||n(e),L(j.formatMessage({defaultMessage:"Connected to Google Drive",id:"ij6u4TNsGF"}))},T=(e=>{let{callerIdentifier:n,pathname:t,queryString:a}=e,o=(0,h.usePathname)(),{account:s,activeOrganization:d}=(0,i.YL)(),c=null==s?void 0:s.uuid,b=null==d?void 0:d.uuid,v=C(),p=(0,f.useQueryClient)(),x=(0,u.V)(),y=(0,h.useSearchParams)(),{mutate:_}=(0,r.L2)("/api/organizations/".concat(b,"/sync/mcp/drive/auth/start"),"POST",{enabled:v,onSuccess:e=>{window.location.href=e.redirect_url}}),w=(0,g.useRef)(!1);return()=>{if(!v)return;let e="".concat(S,"=").concat(n).concat(a?"&".concat(a):""),r=(0,m.d)({pathname:t||o,searchParams:y,queryString:e,shouldOpenInClaudeApp:x});if(p.invalidateQueries({queryKey:[l.jR,{accountUUID:c,orgUuid:b}]}),x)return void window.open("/settings/connectors?open_in_browser=1&auth_start=gdrive&origin=".concat(r));w.current||(w.current=!0,_({pre_auth_state:{origin:r},redirect_uri:new URL("/connect/mcp/drive/callback",window.location.origin).toString()}))}})({callerIdentifier:e,pathname:t,queryString:a});return((0,_.FZ)({callerIdentifier:e,successParam:S,handleOpen:A}),(0,g.useEffect)(()=>{e&&I===e&&(null==n||n(!0),E())},[I,n,e,E]),s)?{isDriveAuthenticated:c,initDriveAuth:v,handleDriveTrigger:A,isFetched:x}:{isDriveAuthenticated:y,initDriveAuth:T,handleDriveTrigger:A,isFetched:w}},A=()=>{let e=(0,_.kO)(),n=(0,_.qi)(d.v8.GDRIVE);return{serverId:null==n?void 0:n.uuid,isConnected:null==n?void 0:n.isConnected,isEnabled:e}},T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,i.YL)(),a=null==n?void 0:n.uuid,o=null==t?void 0:t.uuid,s=C(),d=(0,f.useQueryClient)(),{mutate:u}=(0,v.ih)();return(0,r.L2)("/api/organizations/".concat(o,"/sync/mcp/drive/auth"),"DELETE",{enabled:!!(t&&s),...e,onSuccess:function(){for(var n,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];d.invalidateQueries({queryKey:[l.jR,{accountUUID:a,orgUuid:o}]}),u({}),null==(n=e.onSuccess)||n.call(e,...r)}})},k=e=>{let{documentId:n}=e,{account:t,activeOrganization:a}=(0,i.YL)(),o=null==t?void 0:t.uuid,s=null==a?void 0:a.uuid,d=C(),u=(0,f.useQueryClient)(),c=(0,r.Sk)("/api/organizations/".concat(s,"/sync/mcp/drive/document/").concat(n,"?include_content=false"),{queryKey:[l.QB,{accountUUID:o,orgUuid:s,documentId:n}],enabled:d,meta:{noToast:!0}}),h=c.isError;return(0,g.useEffect)(()=>{h&&u.invalidateQueries({queryKey:[l.jR,{accountUUID:o,orgUuid:s}]})},[u,h,o,s]),c};function N(e){let{uri:n}=e,{data:t,isLoading:a}=k({documentId:n});return{title:null==t?void 0:t.title,isLoading:a}}let R=e=>{let{account:n,activeOrganization:t}=(0,i.YL)(),a=null==n?void 0:n.uuid,o=null==t?void 0:t.uuid,s=C(),d=(0,g.useMemo)(()=>e.map(e=>"/api/organizations/".concat(o,"/sync/mcp/drive/document/").concat(e)),[e,o]),u=(0,g.useMemo)(()=>({queryKey:e.map(e=>[l.qM,{accountUUID:a,orgUuid:o,documentId:e}]),enabled:s,meta:{noToast:!0}}),[e,a,o,s]);return(0,r._i)(d,u)},O=e=>{let{account:n,activeOrganization:t}=(0,i.YL)(),a=null==n?void 0:n.uuid,o=null==t?void 0:t.uuid,s=C(),d=(0,x.bI)(),{data:u,isSuccess:c,isLoading:f}=(0,r.Sk)("/api/organizations/".concat(o,"/sync/mcp/drive/recents"),{queryKey:[l.zu,{accountUUID:a,orgUuid:o}],enabled:e&&s,meta:{noToast:!0}});return(0,g.useEffect)(()=>{if(c&&u){let e=u.map(e=>{let{uri:n,title:t}=e;return{uri:n,title:t}});(0,x.Ac)(e)}},[c,u]),{recentDriveDocs:c?u:d,isLoading:f}},M=()=>{let e=j(),n=(0,s.fS)("apps_use_bananagrams"),t=(0,c.useLayer)("trials_freemium").get("free_integrations",!1);return e&&n||t},q=()=>{let e=C(),n=M();return e&&n&&!w.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION},F=e=>{var n;let t=q(),{account:a}=(0,i.YL)(),r=(0,s.fS)("claude_ai_sticky_project_settings"),o=(0,y.vP)("enabled_bananagrams");return!!t&&(r?!!o:e?!!(null==e||null==(n=e.conversationSettings)?void 0:n.enabled_bananagrams):!!(null==a?void 0:a.settings.enabled_bananagrams))},Y=()=>(0,s.fS)("rag_prototype"),z=()=>{let e=q(),n=(0,i.mV)(),{data:t}=(0,_.LN)(),{account:a}=(0,i.YL)(),r=Y(),o=(0,_.kO)(),l=(0,_.qi)(d.v8.GDRIVE);if(!e||!r)return!1;if(n)if(!o)return!!(Array.isArray(t)&&t.find(e=>{var n;return e.type===d.v8.GDRIVE&&e.enabled&&(null==(n=e.config)?void 0:n.allow_indexing)}));else{var s;let e=Array.isArray(t)?t.find(e=>e.type===d.v8.MCP_RESOURCES):null;if((null==l?void 0:l.uuid)&&(null==e||null==(s=e.config)?void 0:s.servers)){let n=e.config.servers[l.uuid];return!!(null==n?void 0:n.allow_indexing)}return!1}return!!(null==a?void 0:a.settings.enabled_gdrive_indexing)},P=()=>{let{account:e}=(0,i.YL)(),{mutate:n}=(0,a.yJ)(),{mutate:t}=(0,v.Bg)();return{toggleDriveSearchAndIndexingEnabled:a=>{var r;let{indexingEnabled:i,searchEnabled:o,dismissBanner:l}=a,s=l||!!i;i&&t({}),n({...void 0!==i?{enabled_gdrive_indexing:i}:null,...void 0!==o||!0===i?{enabled_bananagrams:null!=i?i:o}:null,...s?{dismissed_claudeai_banners:[...(null==e||null==(r=e.settings)?void 0:r.dismissed_claudeai_banners)||[],{banner_id:"drive_indexing_enablement_2/11_1",dismissed_at:new Date().toISOString()}]}:null})}}}},0x1c4b61688:(e,n,t)=>{t.d(n,{R:()=>l});var a=t(0x22102fd88),r=t(0xfc89b4a4),i=t(0x1cf5ab98a),o=t(0x155df12ed);let l=(0,r.memo)(e=>{let{isOpen:n,onClose:t,onConfirm:l,title:s,message:d,confirmText:u="Confirm",cancelText:c="Cancel",variant:f="primary",isLoading:h,disabled:g=!1,autoFocus:b=!0,testId:v,children:p,size:x="sm"}=e,[m,y]=(0,r.useState)(!1),_=null!=h?h:m,w=(0,r.useCallback)(async()=>{if(!g&&!_){y(!0);try{let e=l();e&&"function"==typeof e.then&&await e,t()}finally{y(!1)}}},[l,t,g,_]),S=(0,r.useCallback)(()=>{_||t()},[t,_]);return(0,a.jsxs)(o.aF,{isOpen:n,onClose:S,title:s,modalSize:x,closeOnEscapeKeydown:!_,children:[(0,a.jsxs)("div",{className:"mt-1 mb-2",children:[d&&(0,a.jsx)("div",{className:"text-text-300 whitespace-pre-line",children:d}),p]}),(0,a.jsxs)(o.vW,{children:[(0,a.jsx)(i.$,{variant:"secondary",onClick:S,disabled:_,children:c}),(0,a.jsx)(i.$,{variant:"danger"===f?"danger":"primary",onClick:w,disabled:g||_,loading:_,autoFocus:b,"data-testid":v||"confirmation-modal-confirm",children:u})]})]})});l.displayName="ConfirmationModal"}}]);