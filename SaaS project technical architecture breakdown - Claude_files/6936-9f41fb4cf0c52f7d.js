try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="36ba3f70-08a8-42cf-9308-6a518eca40c2",e._sentryDebugIdIdentifier="sentry-dbid-36ba3f70-08a8-42cf-9308-6a518eca40c2")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6936,15912],{0x1ddbde9f:(e,t,a)=>{a.d(t,{Xz:()=>r,eG:()=>i,l:()=>l});var s=a(0xb844abc8),n=a(0x16037d0ff);let l=()=>{if((0,s.fJ)())return;let e=document.getElementById(n.I);e&&e.focus()},i="a8f3c7e2-4b9d-4f1a-8c3e-9d2a5b7f8e1c";function r(e){let{uuid:t,model:a,bypassGate:s=!1,isChromeExtEnabled:n}=e;if(s||!a||!t)return!1;if(t===i){let e=["claude-haiku-4-5","claude-sonnet-4-5","claude-opus-4-5"].some(e=>a.startsWith(e));return!n||!e}return!1}},0x257a56b3:(e,t,a)=>{a.d(t,{ZT:()=>i,ie:()=>o,xs:()=>r});var s=a(0x24b0d7515),n=a(0xac309a83);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,n.Je)();return!!t&&t.getExperiment(e).get("enabled",!1)}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,n.Je)();(0,s.TA)(l,e)}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,n.Je)(),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l(e,t);(0,s.eI)(e,l,t,a)}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,n.Je)();return(0,s._x)(e,l,t)}},0x31075f4f:(e,t,a)=>{a.d(t,{A:()=>s});let s={snappyOut:[.19,1,.22,1],inOutQuart:[.77,0,.175,1],outCirc:[.075,.82,.165,1],inOutBase:[.25,.1,.25,1]}},0x33928c7f:(e,t,a)=>{a.d(t,{CD:()=>o});var s=a(0x12c9046cd),n=a(0x14de19ae8),l=a(0x49fac030),i=a(0x1b813d90),r=a(0x1334f6ecc);let o=()=>{let e=(0,r.$f)(),t=(0,r.vT)(),a=(0,r.K6)(),{data:s}=d(i.v8.GDRIVE),n=null==s?void 0:s.state;return!!(e&&t&&a&&n&&[i.I5.CREATED,i.I5.UPDATING,i.I5.PENDING].includes(n))},d=e=>{let{account:t,activeOrganization:a}=(0,n.YL)(),r=null==t?void 0:t.uuid,o=null==a?void 0:a.uuid;return(0,s.Sk)("/api/organizations/".concat(o,"/sync/ingestion/").concat(e,"/progress"),{queryKey:[l.hx,{orgUuid:o,accountUuid:r,syncSourceType:e}],enabled:!!a,refetchInterval:e=>{let t;return!!(e.state.data&&(t=e.state.data.state,[i.I5.CREATED,i.I5.PENDING,i.I5.UPDATING].includes(t)))&&6e4},meta:{noToast:!0}})}},0x459bbfb4:(e,t,a)=>{a.d(t,{x:()=>c});var s=a(0x22102fd88),n=a(0xbca8e388),l=a(0x252daebb2),i=a(0x183548b63),r=a(0x1a1f6dda6),o=a(0x1dc411c0f),d=a(0x160045b25);function c(e){let{modalOpen:t,setModalOpen:a,parsedMemory:n}=e;return(0,s.jsx)(i.aF,{className:"!p-8",hasCloseButton:!0,isOpen:t,onClose:()=>a(!1),title:(0,s.jsx)(l.YX,{id:"lay_section_fireplace"}),modalSize:"xl",children:(0,s.jsx)(u,{height:460,parsedMemory:n})})}function u(e){let{height:t,parsedMemory:a}=e;return(0,s.jsxs)("div",{className:(0,r.A)("border-border-300 border-0.5 rounded-xl flex flex-col relative bg-bg-000 overflow-hidden mt-2"),style:{height:t},children:[(0,s.jsx)(o.P.div,{animate:{opacity:0},className:(0,r.A)("absolute left-0 top-0 bottom-0 right-0 w-full h-full rounded-lg"),style:{backgroundImage:"radial-gradient(at 90% 90%,hsl(var(--accent-main-200)/0.1) 0%, transparent 90%)"}}),(0,s.jsx)(o.P.div,{animate:{opacity:1},transition:{delay:2,duration:1.5},className:"relative overflow-hidden rounded-t-lg h-full",children:(0,s.jsx)("div",{className:(0,r.A)("h-full px-5 py-4 pb-24 font-claude-response text-sm overflow-y-auto rounded-t-lg bg-bg-200/20"),children:(0,s.jsx)(d.N,{children:(0,s.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,s.jsx)(n.f,{text:a}),(0,s.jsx)("div",{className:"absolute bottom-0 h-[18px] bg-gradient-to-t from-text-100 to-bg-100 w-full left-0 opacity-[0.02]"})]},"synthesis")})})})]})}},0x459cd8f0:(e,t,a)=>{a(0x22102fd88),a(0xf32c56dd),a(0x10f221f41),a(0x4d348f95),a(0xfc89b4a4),a(0xbdad302d),a(0x1449f94a5),a(0x1611828d),a(0x15be5d623),a(0xb85e3e6b),a(0x1396b7e40),a(0x17774dcd8)},0x57fcb279:(e,t,a)=>{a.d(t,{sF:()=>ey,Qg:()=>ev,Id:()=>eb});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x14a6d5f1),i=a(0x1065e6d73),r=a(0x14de19ae8),o=a(0x139b5e710),d=a(0x252daebb2),c=a(0x225bae024),u=a(0x1a3383306),m=a(0xac309a83),x=a(0x1b813d90),f=a(0x17f3a2521),p=a(0x1bd175d8c),h=a(0x48be3344),g=a(0xfc89b4a4),b=a(0x38e6572),v=a(0x23e1b1f63),y=a(0x1bd42f6d2),j=a(0x1334f6ecc),w=a(0x25062734b),M=a(0x18175ce17),k=a(0x33928c7f),_=a(0x8ca4d894),A=a(0x16801a2b9),C=a(0x17b66474f),N=a(0x20567b754),S=a(0x9cb4c2a2),E=a(0x1c12b3087),I=a(0x114e73153),T=a(0x12c402068),R=a(0x10b8a0309),D=a(0x1d302b010),O=a(0xf8bd7957);let P=()=>{let e=(0,D.lu)();return(0,s.jsxs)(T.x,{children:[(0,s.jsx)("p",{className:"text-[13px] text-text-200",children:e?(0,s.jsx)(b.A,{defaultMessage:"Connect your tools to Claude",id:"exSmFaQCLC"}):(0,s.jsx)(b.A,{defaultMessage:"Upgrade to connect your tools to Claude",id:"kIvAPf8iSA"})}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[e&&[{url:"https://mcp.notion.com/mcp",name:"Notion"},{url:"https://mcp.canva.com/mcp",name:"Canva"},{url:"https://mcp.linear.app/sse",name:"Linear"},{url:"https://mcp.atlassian.com/v1/sse",name:"Atlassian"},{url:"https://mcp.asana.com/sse",name:"Asana"}].map(e=>{let{url:t,name:a}=e;return(0,s.jsx)("div",{className:"w-3",children:(0,s.jsx)(O.z,{size:18,imageSize:13,type:"favicon",src:t,name:a})},t)}),["/images/icons/messages-app.svg","/images/icons/notes-app.svg","/images/icons/chrome-app.svg"].map(e=>(0,s.jsx)("div",{className:"w-3",children:(0,s.jsx)(O.z,{size:18,imageSize:13,type:"external",src:e})},e))]}),(0,s.jsx)(R.J,{size:16,className:"text-text-500"})]})]})};var L=a(0x800328fa),F=a(0x1ab0d1ca1),z=a(0x1025e2485);function U(){let e=(0,r.Kq)(),t=(0,F.A)();return(0,s.jsx)(z.q,{actionButton:null,title:t.formatMessage({defaultMessage:"Team plan canceled",id:"KuqVOfg9/0"}),children:e?(0,s.jsx)(b.A,{defaultMessage:"You can no longer chat with Claude. To restore full access, <link>renew your subscription</link>.",id:"L2pC0kiNNO",values:{link:e=>(0,s.jsx)(L.Y,{className:"whitespace-nowrap",href:"/settings/billing",children:e})}}):(0,s.jsx)(b.A,{defaultMessage:"You can no longer chat with Claude.",id:"hxcpUUnV0b"})})}var G=a(0x242212ea2);let Y=()=>{let{limitActionButton:e}=(0,G.h)({allowSelfUpgrade:!1});return(0,s.jsx)(z.q,{actionButton:e,children:(0,s.jsx)(b.A,{defaultMessage:"Due to capacity constraints, chatting with Claude is currently not available. Please try again shortly.",id:"kfyWX0MxKQ"})})};var H=a(0x195e308ca),K=a(0xec9172c1),V=a(0xe824fb1c),W=a(0x1a1f6dda6);let B=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,W.A)("text-text-100 font-medium underline hover:no-underline",t),...a})},J=e=>{var t;let a,{inaccessibleSyncSources:n}=e,{chatResourceState:l}=(0,A.i)(),i=(0,H.v)(),{isDrawerExpanded:r,setIsDrawerExpanded:o}=(0,K.x)(),d=n[0],c=(null==d?void 0:d.type)===x.v8.MCP_RESOURCES?d.config.server_uuid:void 0,u=(0,V.Uz)({type:"remote",uuid:c}),m=n.every(e=>e.status.state===x.I5.UNAUTHENTICATED)&&1===new Set(n.map(e=>e.type)).size,f=null==(t=n[0])?void 0:t.type,p=(0,s.jsx)("button",{onClick:()=>{o(!0)},children:(0,s.jsx)(B,{children:(0,s.jsx)(b.A,{defaultMessage:"Show {count, plural, one {# Item} other {# Items}}",id:"1HlfJxfH7H",values:{count:n.length}})})}),h=c&&u[0]?{uuid:u[0].uuid,url:u[0].url}:void 0;if(m&&null!==f){if(f===x.v8.MCP_RESOURCES&&!h)return;a=(0,s.jsx)("button",{onClick:()=>i(f,h),children:(0,s.jsx)(B,{children:(0,s.jsx)(b.A,{defaultMessage:"Reconnect with {sourceName}",id:"dUareRZF9G",values:{sourceName:x.sb[f]}})})})}else l.conversationUuid&&!r&&(a=p);return(0,s.jsx)(T.x,{children:(0,s.jsx)(b.A,{defaultMessage:"Some of your content could not be loaded. {actionButton}",id:"Ibsz06ys2B",values:{actionButton:a}})})};var q=a(0x109513363),X=a(0x19aca0448),Z=a(0x597e433e),$=a(0xf32c56dd),Q=a(0xef41e510),ee=a.n(Q),et=a(0x1dbad8fd1);function ea(e){let{wiggleOrgEnabled:t}=e,{track:a}=(0,$.st)();return(0,s.jsx)(T.x,{children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)("div",{children:t?(0,s.jsx)(b.A,{defaultMessage:"Claude needs code execution to access some attached files.",id:"2NqXIz34vM"}):(0,s.jsx)(b.A,{defaultMessage:"Claude needs code execution to access some attached files. Contact an organization owner to enable this feature.",id:"HjhwC7vyjv"})}),t&&(0,s.jsx)("div",{children:(0,s.jsx)(ee(),{className:"text-accent-secondary-000 font-medium",href:"/settings/capabilities",onClick:()=>{a({event_key:"claudeai.settings.capabilities.opened",source:"ooc_files_warning"})},children:(0,s.jsx)(b.A,{defaultMessage:"Enable in settings",id:"01fHiYUEo1"})})})]})})}var es=a(0x280cbea8),en=a(0xbe814870),el=a(0xb6b8b1fb),ei=a(0x459bbfb4),er=a(0x2b8c35fe);let eo="rosemary_last_notified_at";function ed(e){try{localStorage.setItem(eo,String(e))}catch(e){}}var ec=a(0xbca8e388),eu=a(0x226530adf),em=a(0xb804d868),ex=a(0x1ab362a20),ef=a(0x8603234d),ep=a(0x156c4e43b);let eh=ep.Ik({id:ep.Yj(),bodyMd:ep.Yj(),isDismissable:ep.zM(),proUpsell:ep.zM(),alertForModels:ep.YO(ep.Yj())}).nullable(),eg=e=>{let{alert:t,setHideAlert:a}=e,n=(0,r.UC)(),{limitActionButton:l}=(0,G.h)();return(0,s.jsxs)(T.x,{children:[(0,s.jsx)(ec.L,{children:(0,s.jsx)(ef.o,{children:t.bodyMd})}),n&&t.proUpsell&&l,t.isDismissable&&(0,s.jsx)(c.$,{className:"ml-2 rounded",size:"icon_xs",variant:"ghost",onClick:()=>a(!0),children:(0,s.jsx)(ex.X,{size:12})})]})},eb=()=>{let e=(0,M.X0)(x.v8.GMAIL),t=(0,M.X0)(x.v8.GCAL),a=(0,j.$f)();return!(0,p.V)()&&(e||t||a)},ev=e=>{var t,a,l,o,c,f,p,j,M,_,R,D,O,L,F,z;let G,{placement:H,onRetry:K}=e,{isPromptUnsafe:V}=(0,E.QT)(),{attachments:W,files:B}=(0,E.Jy)(e=>({attachments:e.attachments,files:e.files})),{conversation:$}=(0,S.oM)(),Q=(0,E.QN)(),ee=(0,n.WZ)(null==$?void 0:$.id),{setMcpDirectoryModalIsOpen:ec}=(0,C.tl)(),ex=(0,X.h)(null==$?void 0:$.id,null==$?void 0:$.model),ef=(null==$?void 0:$.id)&&ex?(0,s.jsx)(X.g,{conversationUuid:$.id,model:$.model,lastMessage:ex.lastMessage,stopReason:ex.stopReason,onRetryWithFallback:async()=>{if(!ex.lastMessage.parent_message_uuid)return;let{model:e}=await ee.mutateAsync();K(ex.lastMessage.parent_message_uuid,e)}}):null,{exceededMessageLimitWarning:ep,approachingMessageLimitWarning:ev,overageExceededWarning:ey}=(0,q.IK)(null!=(t=null==$?void 0:$.id)?t:null),{isRavenCanceled:ej}=(0,v.bF)(),ew=ej?(0,s.jsx)(U,{}):void 0,eM=(0,r.r$)()?(0,s.jsx)(Y,{}):void 0,ek=(()=>{let{chatResourceState:e}=(0,A.i)();return[...e.syncSources||[],...(0,y.CO)(Q).data||[]].filter(e=>{var t;return x.xj.includes(null==e||null==(t=e.status)?void 0:t.state)})})(),e_=ek.length?(0,s.jsx)(J,{inaccessibleSyncSources:ek}):void 0,eA=(0,k.CD)(),eC=(0,r.mV)(),eN=eA&&!eC?(0,s.jsx)(T.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Less accurate Google Drive search results while Claude catalogs your Drive files",id:"ljvRWwDUyf"})})]})}):void 0,eS=(0,I.U)(Q)?(0,s.jsx)(T.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Project knowledge exceeds maximum. Remove files to continue.",id:"IqUMWBoy4d"})})]})}):void 0,{systemAlertFromConfig:eE}=(e=>{let t=(0,m.T9)("claude_ai_system_alerts","alert",null,eh),[a,n]=(0,em.Vc)("".concat(e,":").concat(null==t?void 0:t.id,":hideAlertOnConversation"),!1),l=null==t?void 0:t.alertForModels,i=(0,eu.Z3)(e);return e&&(!l||l.includes(i))&&t&&!a?{systemAlertFromConfig:{alert:t,component:(0,s.jsx)(eg,{alert:t,setHideAlert:n})}}:{}})(null!=(a=null==$?void 0:$.id)?a:null),eI=eE?eE.component:null,eT=(0,i.u9)(),eR=function(e,t,a){let{data:n=[]}=(0,et.uE)(a),l=(0,Z.cV)(),r=(0,i.t5)(),o=[...e,...t?t.files:[],...n].filter(e=>e.file_kind===u.M.Blob);return!l&&o.length?(0,s.jsx)(ea,{wiggleOrgEnabled:r}):null}(B,$,Q),eD=eT?null:eR,eO=eb(),eP=(0,m.fS)("claudeai_unsafe_prompt_inline"),eL=V&&eO&&eP?(0,s.jsx)(T.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Use caution before running this prompt. Malicious conversation content could trick Claude into attempting harmful actions or sharing your data.",id:"bWRp6wwzXA"})})]})}):null,eF=W.some(e=>e.origin===u.R.URLParameter)?(0,s.jsx)(T.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Artifacts are user-generated and may contain unverified or potentially unsafe content.",id:"/0GesG9R4n"})})]})}):null,ez=null!=(o=null!=(l=null!=ef?ef:eL)?l:eF)?o:null,eU=(0,w.ko)({shouldTrack:"onpage"===H})&&"onpage"===H?(0,s.jsx)(P,{}):null,{warning:eG,modal:eY}=function(e,t){let a=(0,er.F)("claudeai_rosemary_enabled"),{data:n}=(0,el.F1)({enabled:a}),[l,i]=(0,g.useState)(!1),[r,o]=(0,g.useState)(!1),c=!!((null==n?void 0:n.reflection)&&n.reflection.trim().length>0),u=(0,g.useCallback)(()=>{ed(Date.now()),o(!0),i(!0)},[i,o]),m=(0,g.useCallback)(()=>{ed(Date.now()),o(!0)},[o]);return a&&c?{warning:"onpage"===t&&!r&&function(e){if(!e)return!1;let t=function(){try{let e=localStorage.getItem(eo);return e?Number(e):null}catch(e){return null}}(),a=new Date(e).getTime(),s=Date.now();return null===t||s-t>432e6&&a>t}(null==n?void 0:n.updated_at)?(0,s.jsx)(T.x,{children:(0,s.jsxs)("div",{className:"text-accent-main-200 flex items-center gap-1 justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(es.R,{className:"h-4 w-4 shrink-0",weight:"fill"}),(0,s.jsx)("span",{children:(0,s.jsx)(d.YX,{id:"architect_embrace_transition",dangerouslyVisiblePublicValues:{here:(0,s.jsx)("button",{onClick:u,className:"underline cursor-pointer hover:text-accent-main-100",children:(0,s.jsx)(b.A,{defaultMessage:"here",id:"hniz8ZA1BU"})})}})})]}),(0,s.jsx)("button",{onClick:m,className:"text-accent-main-200 hover:text-accent-main-100 cursor-pointer ml-2","aria-label":"Dismiss",children:(0,s.jsx)(en.X,{className:"h-4 w-4",weight:"regular"})})]})}):null,modal:l&&(null==n?void 0:n.reflection)?(0,s.jsx)(ei.x,{modalOpen:l,setModalOpen:i,parsedMemory:n.reflection}):null}:{warning:null,modal:null}}(0,H),eH=null!=(z=null!=(F=null!=(L=null!=(O=null!=(D=null!=(R=null!=(_=null!=(M=null!=(j=null!=(p=null!=(f=null!=(c=null!=ez?ez:null!=eS?eS:null)?c:ep)?f:ey)?p:ew)?j:eM)?M:e_)?_:eD)?R:eI)?D:eN)?O:ev)?L:eG)?F:eU)?z:null;eH===eU&&(G=()=>ec(!0));let eK=eE&&eE.alert.proUpsell,eV=!!(ep||eD||eN||ev||eG);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.L,{warning:eH,placement:H,theme:eK?"pro":eV?"info":eU?"chin":"danger",onClick:G}),eY]})};function ey(e){var t,a;let{model:n,conversationUuid:i,lastMessage:r,fallback:o,onRetryWithFallback:u}=e,[x,f]=(0,g.useState)(!1),{allModelOptions:p}=(0,l.A9)(),h=p.find(e=>e.model===n),v=(null==h||null==(t=h.name)?void 0:t.replace("Claude",""))||n,y=null!=(a=(0,m.T9)("hiking_boots","value",null,m.Lu))?a:"";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ej,{isOpen:x,onClose:()=>f(!1),conversationUuid:i,lastMessage:r}),(0,s.jsx)("div",{className:"mx-2 md:mx-0",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row min-h-[99px] py-4 px-6 shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%)] rounded-2xl bg-bg-000 md:items-center gap-4 md:gap-6 border-0.5 border-border-300",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 text-sm flex-1",children:[(0,s.jsx)("h4",{className:"font-bold",children:(0,s.jsx)(b.A,{defaultMessage:"Chat paused",id:"bL7dVUkHa0"})}),(0,s.jsx)("p",{className:"text-text-300",children:(0,s.jsx)(d.YX,{id:"howdy",dangerouslyVisiblePublicValues:{currentModelName:v,fallbackModelName:o.displayName,feedback:e=>(0,s.jsx)("button",{className:"underline cursor-pointer",onClick:()=>{f(!0)},children:e}),learnMore:e=>(0,s.jsx)("a",{className:"underline cursor-pointer",href:y,target:"_blank",children:e})}})})]}),(0,s.jsx)("div",{className:"w-full md:w-auto",children:(0,s.jsx)(c.$,{onClick:u,className:"w-full md:w-auto",children:(0,s.jsx)(b.A,{defaultMessage:"Retry with {fallbackModelName}",id:"SH+4I4XTEI",values:{fallbackModelName:o.displayName}})})})]})}),(0,s.jsx)("div",{className:"bg-bg-100 w-full h-2"})]})}function ej(e){let{isOpen:t,onClose:a,conversationUuid:n,lastMessage:l}=e,i=(0,o.Y)();return(0,s.jsx)(_.B,{isOpen:t,showOptions:!1,conversationUuid:n,message:l,requestedFeedbackType:f.kj.SC_FALSE_POSITIVE,setRequestedFeedbackType:()=>{},onClose:a,onSuccess:()=>{a(),i.addSuccess((0,s.jsx)(b.A,{defaultMessage:"Thanks for your feedback!",id:"coh2h6fh1P"}))}})}},0x5e00aadc:(e,t,a)=>{a.d(t,{$z:()=>d,cY:()=>o});var s=a(0x12c9046cd),n=a(0x14de19ae8),l=a(0x9845e38c),i=a(0xac309a83),r=a(0x78b33fbd);function o(){let e=(0,r.useLayer)("frontend"),t=(0,i.fS)("chat_suggestion_chips_enabled"),a=e.get("chat_suggestion_chips",!1);return t||a}function d(e){let{mutateAsync:t,enabled:a}=function(){let{activeOrganization:e}=(0,n.YL)(),t=(0,i.fS)("chat_autocomplete"),a=(0,s.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/dust/chat_autocomplete"),"POST",{enabled:t,onError:()=>{l.v.warn(l.u.CHAT_COMPLETION,"Failed to fetch completion")},meta:{noToast:!0}});return{mutateAsync:a.mutateAsync,isPending:a.isPending,isIdle:a.isIdle,enabled:t}}();return{fetchInputAutocompletion:async s=>{if(!a||!e)return"";let[n,l]=(await t({conversationUuid:null!=e?e:"",prompt:s})).prompt.split("\n").map(e=>e.trim());return"Yes"===n?" "===s[s.length-1]?l||"":" "+(l||""):"No"===n&&l||""}}}},0x6b95b9a1:(e,t,a)=>{a.d(t,{X:()=>s});function s(e){return"default"===e.type?e.key:e.uuid}},0x6e0ffcda:(e,t,a)=>{a.d(t,{Kk:()=>j});var s=a(0x22102fd88),n=a(0x14de19ae8),l=a(0x246846ae8),i=a(0x225bae024),r=a(0x800328fa),o=a(0x1b813d90),d=a(0x16650d3e1),c=a(0x14380714c),u=a(0x1a1f6dda6),m=a(0xfc89b4a4),x=a(0x38e6572),f=a(0x1ab0d1ca1),p=a(0x22be9474c),h=a(0xbebfc702),g=a(0x7a7fbf4),b=a(2118184);let v=(0,s.jsx)(x.A,{defaultMessage:"Everyone in your organization can view and use this project",id:"o6dyBu92Ad"}),y=(0,s.jsx)(x.A,{defaultMessage:"Only invited members can view and use this project",id:"r65HKpZU8I"});function j(e){var t,a,j,w,M,k;let{syncSources:_=[],onProjectCreated:A,onError:C,onCancel:N,strings:S}=e,E=(0,f.A)(),I=(0,n.mV)(),T=(0,b.AI)(),{customInstructions:R,type:D,subtype:O}=null!=T?T:{},[P,L]=(0,m.useState)({name:"",description:null!=(t=S.createProjectDescriptionDefault)?t:"",type:D,subtype:O,is_private:!0}),[F,z]=(0,m.useState)({}),[U,G]=(0,m.useState)(!1),Y=_.length>0,H=_.some(e=>e.type===o.v8.GITHUB),K=_.some(e=>e.type===o.v8.GDRIVE),V=H&&K?(0,s.jsx)(x.A,{defaultMessage:"Github and GDrive attachments can only be added to private projects",id:"rqNebqAfPF"}):H?(0,s.jsx)(x.A,{defaultMessage:"Github attachments can only be added to private projects",id:"eyujXWQfg4"}):K?(0,s.jsx)(x.A,{defaultMessage:"GDrive attachments can only be added to private projects",id:"DMBgAV43lL"}):(0,s.jsx)(x.A,{defaultMessage:"Some of these attachments can only be added to private projects",id:"2ssKO1VReL"}),{mutateAsync:W}=(0,h.bL)(),{activeOrganization:B}=(0,n.YL)(),{data:J}=(0,h.BN)(),{data:q,isLoading:X}=(0,h.PL)(),{data:Z}=(0,p.q)(),$=Z&&!Y,Q=!X&&(null==q?void 0:q.count)===0,ee=e=>t=>{L(a=>({...a,[e]:t.target.value})),z(t=>({...t,[e]:null}))},et=e=>{L(t=>({...t,is_private:e.target.checked&&"private"===e.target.value}))},ea=async e=>{if(e.preventDefault(),!U&&(()=>{let e={};return""===P.name.trim()&&(e.name=E.formatMessage({defaultMessage:"Project name is required",id:"n5cqkMmIMW"})),z(e),0===Object.keys(e).length})()){G(!0);try{let e={...P};R&&(e.prompt_template=R.replaceAll("{{PROJECT_NAME}}",P.name));let t=await W(e);A(t)}catch(e){C(e)}finally{G(!1)}}};return(0,s.jsxs)("form",{className:"grid grid-cols-1 gap-4",onSubmit:e=>ea(e),children:[Q&&!T&&(0,s.jsxs)("div",{className:"bg-bg-300 border-border-400/10 text-text-300 flex w-full flex-col items-start justify-start gap-2 rounded-xl border px-5 pb-5 pt-4 text-sm",children:[(0,s.jsx)("div",{className:"flex items-center gap-1 font-medium",children:(0,s.jsx)(x.A,{defaultMessage:"How to use projects",id:"moKJkVk/qB"})}),I?(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{children:(0,s.jsx)(x.A,{defaultMessage:"Use Projects with your team to do things like:",id:"fcUpqajVgl"})}),(0,s.jsxs)("ul",{className:"list-disc pl-4",children:[(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Query and analyze information about customers, sales calls, and project plans",id:"1YyB53/KOc"})}),(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Upload files from your codebase to understand, improve, and contribute",id:"HXj87AQH0P"})}),(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Generate analysis and reports from one consistent set of materials",id:"3XvEQYrcUv"})}),(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Create content informed by company policies and documentation",id:"HrODk029zr"})})]}),(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"Start by creating a memorable title and description to organize your project. You can always edit it later.",id:"qEWJMy5mr7"})})]}):(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"Projects help organize your work and leverage knowledge across multiple conversations. Upload docs, code, and files to create themed collections that Claude can reference again and again.",id:"7HFalNigyO"})}),(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"Start by creating a memorable title and description to organize your project. You can always edit it later.",id:"qEWJMy5mr7"})})]}),J&&(0,s.jsx)("div",{children:(0,s.jsx)(x.A,{defaultMessage:"Curious to learn more? <link>Try an example project</link>",id:"+AcqvUzRry",values:{link:e=>(0,s.jsx)(r.Y,{href:"/project/".concat(J),children:e})}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ks,{autoFocus:!0,name:"name",className:"w-full",label:null!=(a=S.createProjectNameLabel)?a:E.formatMessage({defaultMessage:"What are you working on?",id:"R2IogQsIBI"}),placeholder:null!=(j=S.createProjectNamePlaceholder)?j:E.formatMessage({defaultMessage:"Name your project",id:"BtIbm/e/WX"}),size:"lg",onChange:ee("name"),error:!!F.name,"data-1p-ignore":!0}),F.name&&(0,s.jsx)("div",{className:"text-danger-000 mt-1 text-right text-xs font-medium",children:F.name})]}),!T&&(0,s.jsx)("div",{children:(0,s.jsx)(l.fs,{name:"description",className:"w-full",label:null!=(w=S.createProjectDescriptionLabel)?w:E.formatMessage({defaultMessage:"What are you trying to achieve?",id:"RPsTh+NBxY"}),placeholder:null!=(M=S.createProjectDescriptionPlaceholder)?M:E.formatMessage({defaultMessage:"Describe your project, goals, subject, etc...",id:"WStTnUWlP8"}),minRows:3,onChange:ee("description"),error:F.description})}),I?(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("div",{className:"mb-2 text-sm font-medium",children:(0,s.jsx)(x.A,{defaultMessage:"Visibility",id:"JAkIqbzRj5"})}),(0,s.jsxs)("label",{className:(0,u.A)("mb-2 flex w-full gap-2",!$&&"opacity-40"),children:[(0,s.jsx)("input",{name:"visibility",className:"mt-0.5",type:"radio",value:"open",checked:!P.is_private,onChange:et,disabled:!$}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)(d.m,{size:16,className:"-mt-1 mr-1 inline-block"}),null!=(k=null==B?void 0:B.name)?k:(0,s.jsx)(x.A,{defaultMessage:"Organization",id:"K56Dims7Up"})]}),(0,s.jsx)("div",{className:"text-text-300 text-xs",children:Z?Y?V:v:(0,s.jsx)(x.A,{defaultMessage:"Public projects are disabled by your organization",id:"c2HBgZtgDR"})})]})]}),(0,s.jsxs)("label",{className:"flex w-full gap-2",children:[(0,s.jsx)("input",{name:"visibility",className:"mt-0.5",type:"radio",value:"private",checked:P.is_private,onChange:et}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)(c.W,{size:16,className:"-mt-1 mr-1 inline-block"}),(0,s.jsx)(x.A,{defaultMessage:"Private",id:"viXE3205/2"})]}),(0,s.jsx)("div",{className:"text-text-300 text-xs",children:y})]})]})]}):null,(0,s.jsx)("div",{className:"mt-2 flex justify-end",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.$,{onClick:N,href:N?void 0:"/projects",variant:"secondary",disabled:U,children:(0,s.jsx)(x.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(g.i,{children:(0,s.jsx)(i.$,{type:"submit",loading:U,children:(0,s.jsx)(x.A,{defaultMessage:"Create project",id:"VUN1K7kSzC"})})})]})})]})}},0x8ca4d894:(e,t,a)=>{a.d(t,{B:()=>v});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x14de19ae8),i=a(0x246846ae8),r=a(0x225bae024),o=a(0x183548b63),d=a(0x800328fa),c=a(0x24fcf6beb),u=a(0xac309a83),m=a(0x17f3a2521),x=a(0xfc89b4a4),f=a(0x1ab0d1ca1),p=a(0x38e6572),h=a(0xb6b8b1fb),g=a(0x122519e51);function b(e){let{value:t,children:a,disabled:n}=e;return(0,s.jsx)(i.eb,{disabled:n,value:t,children:a})}function v(e){var t,a,v,y,j,w;let{conversationUuid:M,message:k,requestedFeedbackType:_,setRequestedFeedbackType:A,isOpen:C,onClose:N,onSuccess:S,showOptions:E=!0}=e,I=(0,f.A)(),[T,R]=(0,x.useState)(""),{data:D}=(0,n.Bq)(M),O=null==D?void 0:D.chat_messages.some(e=>(0,c.Xz)(e).length>0),P=(0,g.V)(null!=(v=null==D?void 0:D.chat_messages)?v:[]).length>0,{mutate:L}=(0,n.HA)(M,k,!!O,{onSuccess:S}),F=(0,x.useId)(),z=null!=(y=null==(t=k.content)?void 0:t.some(e=>"thinking"===e.type))&&y,U="raven"===(0,l.$b)(),G=(0,h.SK)(),Y=(0,u.fS)("claude_ai_report_content_option"),H=null;return(null==D||null==(a=D.settings)?void 0:a.enabled_web_search)&&(H=null!=(w=null==(j=k.content)?void 0:j.some(e=>"tool_use"===e.type&&"web_search"===e.name))&&w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{value:m.kj.FLAG_WEB_OVER,children:(0,s.jsx)(p.A,{defaultMessage:"Shouldn’t have searched the web",id:"T+mr27AakV"})}),(0,s.jsx)(b,{value:m.kj.FLAG_WEB_SOURCES,children:(0,s.jsx)(p.A,{defaultMessage:"Don’t like the cited sources",id:"MBNotx/VaO"})}),(0,s.jsx)(b,{value:m.kj.FLAG_WEB_URL,children:(0,s.jsx)(p.A,{defaultMessage:"Report a URL",id:"BMYqsjhycd"})})]}):(0,s.jsx)(b,{value:m.kj.FLAG_WEB_UNDER,children:(0,s.jsx)(p.A,{defaultMessage:"Should have searched the web",id:"CS8kdzupd9"})})),(0,s.jsxs)(o.aF,{isOpen:C,title:I.formatMessage({defaultMessage:"Feedback",id:"Ejhdi47Jk5"}),onClose:N,children:[(0,s.jsx)("div",{className:"mt-4 flex flex-col",children:(null==_?void 0:_.includes("flag"))&&E&&(0,s.jsxs)(i.l6,{className:"my-2 max-w-md",label:I.formatMessage({defaultMessage:"What type of issue do you wish to report? (optional)",id:"IFWIi9rs1t"}),value:_,onValueChange:e=>{A(e||m.kj.FLAG)},children:[(0,s.jsx)(b,{value:m.kj.FLAG,disabled:!0,children:(0,s.jsx)(p.A,{defaultMessage:"Select…",id:"q0+99kUbd6"})}),(0,s.jsx)(b,{value:m.kj.FLAG_BUG,children:(0,s.jsx)(p.A,{defaultMessage:"UI bug",id:"0uIYueAyDB"})}),(0,s.jsx)(b,{value:m.kj.FLAG_REFUSAL,children:(0,s.jsx)(p.A,{defaultMessage:"Overactive refusal",id:"Jl0Mn6yDBI"})}),P&&(0,s.jsx)(b,{value:m.kj.FLAG_FILE,children:(0,s.jsx)(p.A,{defaultMessage:"Poor image understanding",id:"227KYxHrx5"})}),(0,s.jsx)(b,{value:m.kj.FLAG_INSTRUCTIONS,children:(0,s.jsx)(p.A,{defaultMessage:"Did not fully follow my request",id:"2uOw8LgMwG"})}),(0,s.jsx)(b,{value:m.kj.FLAG_FACTS,children:(0,s.jsx)(p.A,{defaultMessage:"Not factually correct",id:"topE9Q6MGe"})}),(0,s.jsx)(b,{value:m.kj.FLAG_INCOMPLETE,children:(0,s.jsx)(p.A,{defaultMessage:"Incomplete response",id:"ZNEcy7OM5r"})}),z&&(0,s.jsx)(b,{value:m.kj.FLAG_THOUGHTS,children:(0,s.jsx)(p.A,{defaultMessage:"Issue with thought process",id:"zOab+24EWo"})}),H,G&&(0,s.jsx)(b,{value:m.kj.FLAG_MEMORY,children:(0,s.jsx)(p.A,{defaultMessage:"Memory not applied correctly",id:"lNOB6Omh4y"})}),Y&&(0,s.jsx)(b,{value:m.kj.FLAG_CONTENT,children:(0,s.jsx)(p.A,{defaultMessage:"Report content",id:"vfibES+z8T"})}),(0,s.jsx)(b,{value:m.kj.FLAG_OTHER,children:(0,s.jsx)(p.A,{defaultMessage:"Other",id:"/VnDMl81rh"})})]})}),_===m.kj.FLAG_WEB_URL||_===m.kj.FLAG_CONTENT?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-text-300 border-0.5 border-border-300 rounded-lg p-12 text-sm",children:(0,s.jsx)(p.A,{defaultMessage:"Please use this <link>form</link> to report violative content.",id:"QSjqvNNsUq",values:{link:e=>(0,s.jsx)(d.Y,{href:"https://docs.google.com/forms/d/e/1FAIpQLSeO9Hzkyf_hQ2fYkfP_cqAcJG5kdlkg1wF4drQEFK9Z6db7jg/viewform",target:"_blank",children:e})}})}),(0,s.jsx)(o.vW,{children:(0,s.jsx)(r.$,{variant:"secondary",onClick:N,children:(0,s.jsx)(p.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mt-4 flex flex-col",children:[(0,s.jsx)("label",{htmlFor:F,className:"text-text-400 mb-2 text-sm",children:(0,s.jsx)(p.A,{defaultMessage:"Please provide details: (optional)",id:"og1W/bIZdx"})}),(0,s.jsx)(i.fs,{id:F,className:"text-sm",placeholder:(null==_?void 0:_.includes("flag"))||(null==_?void 0:_.includes("sc"))?I.formatMessage({defaultMessage:"What was unsatisfying about this response?",id:"+DB/t6WTki"}):I.formatMessage({defaultMessage:"What was satisfying about this response?",id:"yJFWG3mK1I"}),value:T,onChange:e=>{R(e.target.value)}})]}),(0,s.jsx)("p",{className:"text-text-500 mt-3 italic leading-tight",children:(0,s.jsx)("small",{children:(0,s.jsx)(p.A,{defaultMessage:"Submitting this report will send the entire current conversation to Anthropic for future improvements to our models. <link>Learn More</link>",id:"laRJ009b4f",values:{link:e=>(0,s.jsx)(d.Y,{target:"_blank",rel:"noopener",href:U?"https://privacy.anthropic.com/en/articles/9957937-how-does-anthropic-use-submitted-feedback":"https://privacy.anthropic.com/en/articles/10023565-how-does-anthropic-use-submitted-feedback",children:e})}})})}),(0,s.jsxs)(o.vW,{children:[(0,s.jsx)(r.$,{onClick:()=>{_&&(L({type:_,reason:T||void 0}),N())},children:(0,s.jsx)(p.A,{defaultMessage:"Submit",id:"wSZR47Y5kj"})}),(0,s.jsx)(r.$,{variant:"secondary",onClick:N,children:(0,s.jsx)(p.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})]})}},0xafe3e930:(e,t,a)=>{a.d(t,{c:()=>n});var s=a(0xac309a83);let n=()=>(0,s.fS)("add_menu_simplification")},0xde6c3752:(e,t,a)=>{a.d(t,{B:()=>r});var s=a(0x22102fd88),n=a(0x108536636),l=a(0x16b1d0c0f),i=a(0x1f59f8010);let r=e=>{let{attachments:t,files:a,syncSourceResults:r,onRemoveAttachment:o,onRemoveFile:d,onRemoveSyncSource:c,isUploadingFile:u,isUploadingSync:m,deletingFileUuid:x}=e,f=(0,l.f)(e=>e.isLoadingMentionData);return(0,s.jsxs)("div",{className:"flex flex-row gap-3",children:[t.map((e,t)=>(0,s.jsx)(n.NM,{file:e,handleRemove:()=>o(t),isEditable:!0},t)),a.map((e,t)=>(0,s.jsx)(n.NM,{file:e,showWarnings:!0,handleRemove:()=>d(t),isEditable:!0,disabled:x===e.file_uuid},e.file_uuid)),(0,s.jsx)(n.NG,{isShown:u||f,size:"normal"},"file-upload-loading"),r.map(e=>{let{syncSource:t,uuid:a}=e;return(0,s.jsx)(i.V,{uuid:a,syncSource:t,onRemove:()=>c(a),isEditable:!0},a)}),(0,s.jsx)(n.NG,{isShown:m,size:"normal"},"sync-upload-loading")]})}},0xec9172c1:(e,t,a)=>{a.d(t,{_:()=>c,x:()=>d});var s=a(0x22102fd88),n=a(0xb804d868),l=a(0x4d348f95),i=a(0xfc89b4a4),r=a(0x151bca12b);let o=(0,i.createContext)({isDrawerExpanded:!1,setIsDrawerExpanded:()=>void 0});function d(){return(0,i.useContext)(o)}function c(e){let{children:t,conversationUuid:a}=e,d=function(e){let t=!!(0,l.useSearchParams)().get("controls")&&!(window.matchMedia&&window.matchMedia("(max-width: 767px)").matches),[a]=(0,n.Vc)("".concat(e,":chatControlsSidebarIsOpen"),t);return a}(a),{isExpanded:c,setIsExpanded:u}=(0,r.VF)(),[m,x]=(0,i.useState)(d),f=(0,i.useRef)({reopenMain:!1}),p=(0,i.useCallback)(e=>{e&&(c&&(f.current.reopenMain=!0),u(!1)),!e&&f.current.reopenMain&&(f.current.reopenMain=!1,u(!0)),x(e)},[c,u,x]),h=(0,i.useMemo)(()=>({isDrawerExpanded:m,setIsDrawerExpanded:p}),[m,p]);return(0,s.jsx)(o.Provider,{value:h,children:t})}},0x114e73153:(e,t,a)=>{a.d(t,{U:()=>n});var s=a(0x218bd2f97);let n=e=>{let t=(0,s.ED)(e),{maxKbTokens:a}=(0,s.AO)();return void 0!==t&&t>a}},0x11560efd4:(e,t,a)=>{a.d(t,{d:()=>u});var s=a(0x22102fd88),n=a(0x246846ae8),l=a(0x2471dc42f),i=a(0x225bae024),r=a(0x1a1f6dda6),o=a(0x4d348f95),d=a(0x1ab0d1ca1),c=a(0x38e6572);let u=e=>{let{category:t,setCategory:a,notes:r,setNotes:u,reporterEmail:f,setReporterEmail:p,reporterName:h,setReporterName:g,optOutOfTraining:b,setOptOutOfTraining:v,onSubmit:y,onClose:j,additionalFields:w}=e,M=(0,d.A)(),k=(0,o.useRouter)(),_=(()=>{let e=(0,d.A)();return{COPYRIGHT_INFRINGEMENT:e.formatMessage({defaultMessage:"Copyright infringement",id:"KBxpgB8JHb"}),TRADEMARK_INFRINGEMENT:e.formatMessage({defaultMessage:"Trademark infringement",id:"vYjeaNdXif"}),CHILD_SAFETY:e.formatMessage({defaultMessage:"Child safety/sexual abuse",id:"ddXREI8PNV"}),FRAUD:e.formatMessage({defaultMessage:"Fraud",id:"YoXOdinNC1"}),SEXUALLY_EXPLICIT_CONTENT:e.formatMessage({defaultMessage:"Sexually Explicit content",id:"D0NxeIKdoR"}),VIOLENCE_AND_HATE:e.formatMessage({defaultMessage:"Violence and/or hate speech",id:"vyV1zGTEEH"}),ILLEGAL_GOODS:e.formatMessage({defaultMessage:"Illegal goods",id:"13OdRQYanm"}),COURT_ORDER:e.formatMessage({defaultMessage:"Court order",id:"2mmEfFQIze"}),PRIVATE_OR_CONFIDENTIAL_INFORMATION:e.formatMessage({defaultMessage:"Private/confidential information",id:"qndjDTg0gE"}),DEFAMATION:e.formatMessage({defaultMessage:"Defamation",id:"h9Y5N1xs5X"}),OTHER_ILLEGAL:e.formatMessage({defaultMessage:"Other illegal or unlawful content",id:"Bjp5vOloME"}),VIOLATION_OF_TERMS:e.formatMessage({defaultMessage:"Violation of terms or usage policy",id:"8Aa/HbeJSY"})}})(),A=null;return"COPYRIGHT_INFRINGEMENT"===t||"TRADEMARK_INFRINGEMENT"===t||"PRIVATE_OR_CONFIDENTIAL_INFORMATION"===t||"COURT_ORDER"===t?A=(0,s.jsx)("div",{className:"text-text-300 border-0.5 border-border-300 rounded-lg p-12 text-sm",children:(0,s.jsx)(c.A,{defaultMessage:"Please use this <link>form</link> to report copyright infringement.",id:"6Ovg0gmxY3",values:{link:e=>(0,s.jsx)("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLSeO9Hzkyf_hQ2fYkfP_cqAcJG5kdlkg1wF4drQEFK9Z6db7jg/viewform",target:"_blank",className:"underline",children:e})}})}):t&&(A=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m,{htmlFor:"reporter-name",children:(0,s.jsx)(c.A,{defaultMessage:"Your name",id:"vlKhIlKczK"})}),(0,s.jsx)(n.ks,{id:"reporter-name",value:h,onChange:e=>g(e.target.value),placeholder:M.formatMessage({defaultMessage:"Optional",id:"InWqysQtIQ"})}),w,(0,s.jsxs)(m,{htmlFor:"reporter-email",children:[(0,s.jsx)(c.A,{defaultMessage:"Your email",id:"nONnTwYJzw"}),(0,s.jsx)(x,{children:(0,s.jsx)(c.A,{defaultMessage:"If provided, we may contact you for additional information or updates on this report",id:"76+sVeXWuh"})})]}),(0,s.jsx)(n.ks,{id:"reporter-email",value:f,onChange:e=>p(e.target.value),placeholder:M.formatMessage({defaultMessage:"Optional",id:"InWqysQtIQ"})}),(0,s.jsxs)(m,{htmlFor:"notes",children:[(0,s.jsx)(c.A,{defaultMessage:"Additional information",id:"gh/lBJ3ybG"}),(0,s.jsxs)(x,{className:"flex flex-col gap-1",children:[(0,s.jsx)("div",{children:(0,s.jsx)(c.A,{defaultMessage:"Please provide any additional information to help us understand your request.",id:"iqT0iuZphp"})}),(0,s.jsx)("div",{children:(0,s.jsx)(c.A,{defaultMessage:"If you are reporting the content as illegal/unlawful, please describe in detail why you believe the identified content is illegal/unlawful, citing specific provisions of law wherever possible.",id:"FtDimnJZ6A"})}),(0,s.jsx)("div",{children:(0,s.jsx)(c.A,{defaultMessage:"If you are reporting the content as violating our policies (including our terms or Usage Policy), please describe in detail why you believe the identified content is in violation of our policies, with specific citations to our policies wherever possible.",id:"4XdZthEtcv"})})]})]}),(0,s.jsx)(n.fs,{id:"notes",value:r,onChange:e=>u(e.target.value),placeholder:M.formatMessage({defaultMessage:"Optional",id:"InWqysQtIQ"})}),(0,s.jsxs)(m,{children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(c.A,{defaultMessage:"Opt out of training on this report",id:"mREcB0MAuE"}),(0,s.jsx)(l.j,{checked:b,onChange:()=>v(!b)})]}),(0,s.jsx)(x,{children:(0,s.jsx)(c.A,{defaultMessage:"We value user reports to uphold our platform’s integrity and improve our ability to enforce our Usage Policy. Unless you opt out, reports may be used to train models for use by our Trust & Safety team, consistent with Anthropic’s safety mission. Opt out of this use by changing the toggle above.",id:"2IiG1AGCna"})})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,s.jsx)(i.$,{variant:"secondary",onClick:j,children:(0,s.jsx)(c.A,{defaultMessage:"Close",id:"rbrahOGMC3"})}),(0,s.jsx)(i.$,{onClick:()=>{y(),k.push("/reported")},variant:"primary",children:(0,s.jsx)(c.A,{defaultMessage:"Report",id:"x5Tz6MZH82"})})]})]})),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2 pt-6",children:[(0,s.jsx)(m,{htmlFor:"report-reason-dropdown",children:(0,s.jsx)(c.A,{defaultMessage:"Why are you reporting this?",id:"0nCKXihfO0"})}),(0,s.jsxs)(n.l6,{id:"report-reason-dropdown",value:null!=t?t:"select-report-reason",onValueChange:e=>a(e),children:[(0,s.jsx)(n.eb,{value:"select-report-reason",disabled:!0,children:(0,s.jsx)(c.A,{defaultMessage:"Select report reason",id:"bk8tuJl/tJ"})}),Object.entries(_).map(e=>{let[t,a]=e;return(0,s.jsx)(n.eb,{value:t,children:a},t)})]}),A]})};function m(e){let{children:t,className:a,...n}=e;return(0,s.jsx)("label",{className:(0,r.A)("text-text-400 text-sm font-medium",a),...n,children:t})}function x(e){let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,r.A)("text-xs font-normal",a),children:t})}},0x115b4e1b8:(e,t,a)=>{a.d(t,{D$:()=>c});var s=a(0x139b5e710),n=a(0x1ab0d1ca1),l=a(0x24b92fff4),i=a(0x31c535e9),r=a(0x3769f4df);let o="advanced",d=["enabled_web_search","enabled_bananagrams","enabled_sourdough","enabled_foccacia"];function c(e){let{toggleConversationSetting:t,batchToggleConversationSettings:a}=(0,i.rX)({source:"settingsCoordinator"}),c=(0,i.vP)("compass_mode"),u=(0,r.YW)(),m=(0,l.Gm)(e),{addSuccess:x}=(0,s.Y)(),f=(0,n.A)(),p=(0,i.vP)("enabled_web_search"),h=(0,i.vP)("enabled_bananagrams"),g=(0,i.vP)("enabled_sourdough"),b=(0,i.vP)("enabled_foccacia"),v=(0,i.vP)("enabled_mcp_tools");return{toggleSearchTool:(e,s)=>{if(s)return void t(e,s);!function(e){let{remainingToolCount:t,compassMode:a}=e;return 0===t&&a===o}({remainingToolCount:function(e){let{toolToIgnore:t,currentStates:a}=e,s=0;for(let e of d)e!==t&&a[e]&&s++;return a.enabled_mcp_tools&&Object.values(a.enabled_mcp_tools).some(e=>!!e)&&s++,s}({toolToIgnore:e,currentStates:{enabled_web_search:null!=p&&p,enabled_bananagrams:null!=h&&h,enabled_sourdough:null!=g&&g,enabled_foccacia:null!=b&&b,enabled_mcp_tools:v}}),compassMode:c})?t(e,s):a({compass_mode:null,[e]:!1})},toggleResearchMode:e=>{var s,n,l;if(!e)return void t("compass_mode",null);(s=m,n=u,l=c,!s&&n&&l!==o)?(a({enabled_web_search:!0,compass_mode:o}),x(f.formatMessage({defaultMessage:"Web search enabled automatically for Research",id:"ss4xBdPHtN"}))):t("compass_mode",o)},canAutoEnableWebSearch:!m&&u,toggleConversationSetting:t,batchToggleConversationSettings:a}}},0x11914e639:(e,t,a)=>{a.d(t,{U:()=>T});var s=a(0x22102fd88),n=a(0xf32c56dd),l=a(0x14de19ae8),i=a(0x10f221f41),r=a(0x225bae024),o=a(0x12bb05cb6),d=a(0xac309a83),c=a(0xfc89b4a4),u=a(0x1ab0d1ca1),m=a(0x38e6572),x=a(0xbebfc702),f=a(0x218bd2f97),p=a(0x139b5e710),h=a(0x11c7a82c2);function g(e){let{isOpen:t,onClose:a,project:n}=e,{addError:l}=(0,p.Y)(),i=(0,u.A)(),{mutateAsync:r}=(0,x.sS)(n.uuid),o=(0,c.useCallback)(async()=>{try{await r({is_archived:!0})}catch(e){throw l(i.formatMessage({defaultMessage:"Could not archive",id:"3O1N877xLt"}),{error:e,messageForLogging:"Could not archive"}),e}},[r,l,i]);return(0,s.jsx)(h.R,{isOpen:t,onClose:a,onConfirm:o,title:i.formatMessage({defaultMessage:"Archive project",id:"sxTTUDY6HD"}),message:i.formatMessage({defaultMessage:"Are you sure you want to archive {projectName}?",id:"1BieCt3ylM"},{projectName:n.name}),confirmText:i.formatMessage({defaultMessage:"Archive",id:"hrgo+EleAn"}),variant:"danger",autoFocus:!0})}var b=a(0x4d348f95);function v(e){let{isOpen:t,onClose:a,project:n}=e,{addError:l,addSuccess:i}=(0,p.Y)(),r=(0,u.A)(),o=(0,b.usePathname)(),d=(0,b.useRouter)(),{mutateAsync:c,isPending:m}=(0,x.eW)(n.uuid),f=async()=>{try{await c(),i(r.formatMessage({defaultMessage:"Project deleted",id:"34J8Grxmd1"})),o==="/project/".concat(n.uuid)&&d.push("/projects")}catch(e){l(r.formatMessage({defaultMessage:"Could not delete",id:"njF5218LQD"}),{error:e,messageForLogging:"Could not delete"})}};return(0,s.jsx)(h.R,{isOpen:t,onClose:a,onConfirm:f,title:r.formatMessage({defaultMessage:"Delete project",id:"f2FD7U33A1"}),message:r.formatMessage({defaultMessage:"Are you sure you want to delete {projectName}?",id:"yc7hx3U5ir"},{projectName:n.name}),confirmText:r.formatMessage({defaultMessage:"Delete",id:"K3r6DQW7h+"}),variant:"danger",isLoading:m,testId:"delete-project-confirm-button"})}var y=a(0x246846ae8),j=a(0x183548b63);function w(e){let{isOpen:t,onClose:a,project:n}=e,[l,i]=(0,c.useState)(n.unformattedName||n.name),[o,d]=(0,c.useState)(n.description),f=(0,u.A)(),{addError:h}=(0,p.Y)(),{mutateAsync:g}=(0,x.sS)(n.uuid),b=async()=>{try{await g({name:l,description:o}),a()}catch(e){h(f.formatMessage({defaultMessage:"Error updating project, please try again later",id:"eLzspFmHkT"}),{error:e,messageForLogging:"Error updating project, please try again later"})}};return(0,s.jsxs)(j.aF,{isOpen:t,onClose:a,modalSize:"md",children:[(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)("h2",{className:"font-xl-bold",children:(0,s.jsx)(m.A,{defaultMessage:"Edit details",id:"BVWzJ5FL/Y"})})}),(0,s.jsxs)("div",{className:"mb-6 mt-3",children:[(0,s.jsx)(y.ks,{className:"mb-4 w-full",label:f.formatMessage({defaultMessage:"Name",id:"HAlOn1ZsuY"}),value:l,onChange:e=>i(e.target.value),required:!0}),(0,s.jsx)(y.fs,{label:f.formatMessage({defaultMessage:"Description",id:"Q8Qw5BZ1VA"}),value:o,onChange:e=>d(e.target.value),minRows:6,required:!0,className:"max-h-60 overflow-auto"})]}),(0,s.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,s.jsx)(r.$,{variant:"secondary",onClick:a,children:(0,s.jsx)(m.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(r.$,{onClick:()=>{b()},children:(0,s.jsx)(m.A,{defaultMessage:"Save",id:"jvo0vs3nF0"})})]})]})}var M=a(0x11560efd4),k=a(0x1b813d90),_=a(0x1a1f6dda6),A=a(0x1dbad8fd1),C=a(0x1bd42f6d2);let N=e=>{let{syncSource:t}=e;return t.type===k.v8.GDRIVE?(e=>(0,s.jsx)(y.eb,{value:"sync-".concat(e.uuid),children:e.status.extra||(0,s.jsx)(m.A,{defaultMessage:"Unknown Google Drive document",id:"DjaaH+4Tyz"})},"sync-".concat(e.uuid)))(t):t.type===k.v8.GITHUB?(e=>{let{owner:t,repo:a}=e.config,n="".concat(t,"/").concat(a);return(0,s.jsx)(y.eb,{value:"sync-".concat(e.uuid),children:n},"sync-".concat(e.uuid))})(t):void 0};function S(e){let{className:t,...a}=e;return(0,s.jsx)("label",{...a,className:(0,_.A)("text-text-400 text-sm font-medium",t)})}function E(e){let{className:t,...a}=e;return(0,s.jsx)("div",{...a,className:(0,_.A)("text-xs font-normal",t)})}function I(e){let{isOpen:t,onClose:a,projectUuid:n,organizationUuid:l}=e,[i,r]=(0,c.useState)(),[o,d]=(0,c.useState)(),[u,f]=(0,c.useState)(),[p,h]=(0,c.useState)(),[g,b]=(0,c.useState)(!1),[v,w]=(0,c.useState)(),[k,_]=(0,c.useState)(),[I,T]=(0,c.useState)(),{mutateAsync:R}=(0,x.GQ)(l,n),{data:D}=(0,A.MO)(n,!!n&&t),{data:O}=(0,A.uE)(n,!!n&&t),{data:P}=(0,C.CO)(n,!1,!!n&&t),L=async()=>{await R({category:i||"",notes:o,reporter_name:p,reporter_email:u,opt_out_of_training:g,doc_uuid:v,file_uuid:k,sync_source_uuid:I}),r(void 0),d(void 0),w(void 0),_(void 0),T(void 0),h(void 0),f(void 0),b(!1),a(!0)},F=(D&&D.length>0||O&&O.length>0||P&&P.length>0)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(S,{children:[(0,s.jsx)(m.A,{defaultMessage:"Specific document, file, or source (optional)",id:"axKp3B/R/i"}),(0,s.jsx)(E,{children:(0,s.jsx)(m.A,{defaultMessage:"Select a specific document, file, or sync source in this project to report",id:"UhG56XNcMi"})})]}),(0,s.jsxs)(y.l6,{value:v?"doc-".concat(v):k?"file-".concat(k):I?"sync-".concat(I):"select-item",onValueChange:e=>{"select-item"===e?(w(void 0),_(void 0),T(void 0)):e.startsWith("doc-")?(w(e.substring(4)),_(void 0),T(void 0)):e.startsWith("file-")?(_(e.substring(5)),w(void 0),T(void 0)):e.startsWith("sync-")&&(T(e.substring(5)),w(void 0),_(void 0))},children:[(0,s.jsx)(y.eb,{value:"select-item",children:(0,s.jsx)(m.A,{defaultMessage:"Select a document, file, or source (optional)",id:"uH9yKzuAxu"})}),D&&D.length>0&&(0,s.jsx)("optgroup",{label:"Documents",children:D.map(e=>(0,s.jsx)(y.eb,{value:"doc-".concat(e.uuid),children:e.file_name},"doc-".concat(e.uuid)))}),O&&O.length>0&&(0,s.jsx)("optgroup",{label:"Files",children:O.map(e=>(0,s.jsx)(y.eb,{value:"file-".concat(e.file_uuid),children:e.file_name},"file-".concat(e.file_uuid)))}),P&&P.length>0&&(0,s.jsx)("optgroup",{label:"Sync Sources",children:P.map(e=>(0,s.jsx)(N,{syncSource:e},"syncs-".concat(e.uuid)))})]})]});return(0,s.jsx)(j.aF,{modalSize:"md",isOpen:t,onClose:a,hasCloseButton:!0,title:(0,s.jsx)("span",{className:"font-claude-response font-medium",children:(0,s.jsx)(m.A,{defaultMessage:"Report project",id:"i+TY5eOB+b"})}),children:(0,s.jsx)(M.d,{category:i,setCategory:r,notes:o,setNotes:d,reporterEmail:u,setReporterEmail:f,reporterName:p,setReporterName:h,optOutOfTraining:g,setOptOutOfTraining:b,onSubmit:L,onClose:()=>a(!1),additionalFields:F})})}let T=e=>{let{star:t=!0,project:a,buttonSize:p="icon_sm",open:h,onOpenChange:b}=e,y=(0,u.A)(),{track:j}=(0,n.st)(),[M,k]=(0,c.useState)(!1),[_,A]=(0,c.useState)(!1),[C,N]=(0,c.useState)(!1),[S,E]=(0,c.useState)(!1),{mutate:T}=(0,x.sS)(a.uuid),R=null!==a.archived_at,D=(0,d.fS)("project_deletion_button"),O=(0,l.mV)(),{activeOrganization:P}=(0,l.YL)(),{hasSettingsEditPermission:L}=(0,f.ti)({projectUuid:a.uuid});return L||t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.ms,{align:"end",open:h,onOpenChange:b,trigger:(0,s.jsx)(r.$,{variant:"ghost",className:"active:!scale-100 pointer-events-auto",size:p,onClick:e=>{e.stopPropagation(),e.preventDefault()},onMouseDown:e=>{e.stopPropagation(),e.preventDefault()},"aria-label":a.name?y.formatMessage({defaultMessage:"More options for {label}",id:"rKQPgfPvWS"},{label:a.name}):y.formatMessage({defaultMessage:"More options",id:"IzCVhGdYVc"}),children:(0,s.jsx)(i.FOq,{})}),unstyledTrigger:!0,children:(0,s.jsxs)("div",{children:[t&&(0,s.jsx)(o.tJ,{"data-testid":"star-project-trigger",onSelect:()=>{let e=!a.is_starred;T({is_starred:e}),j({event_key:e?"claudeai.projects.starred":"claudeai.projects.unstarred",project_uuid:a.uuid,project_name:a.name})},icon:a.is_starred?(0,s.jsx)(i.BQ2,{}):(0,s.jsx)(i.FEq,{}),children:a.is_starred?(0,s.jsx)(m.A,{defaultMessage:"Unstar",id:"Y5zRLWgCMP"}):(0,s.jsx)(m.A,{defaultMessage:"Star",id:"VwapsmdMes"})}),L&&(0,s.jsxs)(s.Fragment,{children:[!R&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.tJ,{"data-testid":"rename-project-trigger",onSelect:()=>k(!0),icon:(0,s.jsx)(i.ffu,{}),children:(0,s.jsx)(m.A,{defaultMessage:"Edit details",id:"BVWzJ5FL/Y"})}),O&&a.type!==x.gM.Haystack&&(0,s.jsx)(o.tJ,{onSelect:()=>E(!0),icon:(0,s.jsx)(i.Gbe,{}),children:(0,s.jsx)(m.A,{defaultMessage:"Report",id:"x5Tz6MZH82"})}),a.type!==x.gM.Haystack&&(0,s.jsx)(o.DG,{}),a.type!==x.gM.Haystack&&(0,s.jsx)(o.tJ,{"data-testid":"archive-project-trigger",onSelect:()=>{null==b||b(!1),setTimeout(()=>A(!0),100)},icon:(0,s.jsx)(i.Tde,{}),children:(0,s.jsx)(m.A,{defaultMessage:"Archive",id:"hrgo+EleAn"})}),D&&a.type!==x.gM.Haystack&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(o.tJ,{danger:!0,"data-testid":"delete-project-trigger",onSelect:()=>{null==b||b(!1),setTimeout(()=>N(!0),100)},icon:(0,s.jsx)(i.lMJ,{}),children:(0,s.jsx)(m.A,{defaultMessage:"Delete",id:"K3r6DQW7h+"})})})]}),R&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(o.tJ,{onClick:()=>{T({is_archived:!1})},icon:(0,s.jsx)(i.Tde,{}),children:(0,s.jsx)(m.A,{defaultMessage:"Unarchive",id:"ftDYZo4V2C"})})})]})]})}),(0,s.jsx)(w,{isOpen:M,onClose:()=>k(!1),project:a}),(0,s.jsx)(g,{isOpen:_,onClose:()=>A(!1),project:a}),(0,s.jsx)(v,{isOpen:C,onClose:()=>N(!1),project:a}),(0,s.jsx)(I,{isOpen:S,onClose:()=>E(!1),projectUuid:a.uuid,organizationUuid:null==P?void 0:P.uuid})]}):null}},0x120e6a4a3:(e,t,a)=>{a.d(t,{bl:()=>r});var s=a(0x597e433e),n=a(0x56ac793a),l=a(0xfd34bc37);function i(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"quick_entry_image",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=atob(e),i=new Uint8Array(l.length);for(let e=0;e<l.length;e++)i[e]=l.charCodeAt(e);let r=n||s._F[t]||"png";return new File([i],"".concat(a,".").concat(r),{type:t})}async function r(e,t,a,r,o){let d=o?o.split(".")[0]:o,c=o?o.split(".")[1]:o;if(d&&c){let r=i(e,t,d,c),o={orgUuid:a,projectUuid:void 0,conversationUuid:l.T.current,modelConfig:{image_in:!0,pdf_in:!0},featureGates:{janus_claude_ai:!0,ooc_attachments:!0,use_canvas_resize:!0,wiggleEnabled:!0},limits:s.XA};return[await (0,n.gs)(r,o)]}let u=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"quick_entry_image",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=i(e,t,a,s),l=new FormData;return l.append("file",n),l}(e,t,d,c),m=await r("/api/".concat(a,"/upload"),{method:"POST",body:u});if(m.ok)return[await m.json()];throw Error("Failed to upload image: ".concat(m.status," ").concat(m.statusText))}},0x122519e51:(e,t,a)=>{a.d(t,{E:()=>n,V:()=>l});var s=a(0xfc89b4a4);function n(e){let t=[];for(let s of e){var a;for(let e of null!=(a=s.files_v2)?a:s.files)"file_kind"in e&&t.push(e)}return t}let l=e=>(0,s.useMemo)(()=>n(e),[e])},0x12d9a90e8:(e,t,a)=>{a.r(t),a.d(t,{NewFeatureNuxPopover:()=>p,useModelSelectorNuxPopover:()=>f});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x226530adf),i=a(0x14a6d5f1),r=a(0x14de19ae8),o=a(0x10f221f41),d=a(0x16a573a92),c=a(0xac309a83),u=a(0x31c535e9),m=a(0xfce0e9a4),x=a(0x1c12b3087);let f=()=>{var e;let{isNewConversation:t,conversation:a,model:s}=(0,x.Tc)(e=>({isNewConversation:e.isNewConversation,conversation:e.conversation,model:e.model}),"useModelSelectorNuxPopover"),o=(0,u.vP)("paprika_mode"),{allModelOptions:d}=(0,i.A9)(),m=(0,l.Z3)((null==a?void 0:a.id)||null),f=null!=s?s:m,p=d.find(e=>e.model===f),h=null==p||null==(e=p.paprika_modes)?void 0:e.includes("extended"),{data:g}=(0,n.Fn)(),b=!!(g&&g.count>=1&&t&&!o&&h),v=(0,c.fS)("model_selector_enabled"),y=(0,r.h0)();return{showNux:b,canActivateExtendedThinking:h&&!(!v&&!y)}},p=e=>{let{anchorRef:t,canShowNux:a,text:n,id:l,nuxItem:i,side:r,align:c="center"}=e,{shouldShow:u,dismiss:x}=(0,m.z)(l,i);return u&&a?(0,s.jsx)(d.U,{side:r,anchorRef:t,onClose:x,accentColor:"secondary",introDelay:.5,align:c,children:(0,s.jsxs)("div",{className:"flex flex-row gap-2 min-w-[13rem]",children:[(0,s.jsx)(o.g5W,{}),(0,s.jsx)("p",{className:"whitespace-normal",children:n})]})}):null}},0x1396b7e40:(e,t,a)=>{a.d(t,{O:()=>f});var s=a(0x22102fd88),n=a(0x10f221f41),l=a(0x1b370f49d),i=a(0x18f9bc151),r=a(0x1a1f6dda6),o=a(0x1dc411c0f),d=a(0xfc89b4a4),c=a(0xafe3e930),u=a(0x175a3352c),m=a(0x1d1a079e9);let x={legacy:{border:"border-0.5",active:"text-accent-secondary-100 bg-accent-secondary-100/[8%] border-accent-secondary-200/20",inactive:"text-text-300 border-border-300",activeHover:"hover:text-accent-secondary-000 hover:bg-accent-secondary-100/[12%]",inactiveHover:"hover:text-text-200/90 hover:bg-bg-100"},simplified:{border:"",active:"text-accent-secondary-100 bg-accent-secondary-100/[8%]",inactive:"text-text-300",activeHover:"hover:text-accent-secondary-000 hover:bg-accent-secondary-900",inactiveHover:"hover:text-text-200/90 hover:bg-bg-200"}},f=d.forwardRef((e,t)=>{let{indicatorActive:a,disabled:d,text:f,tag:p,className:h,buttonClassName:g,tooltip:b,tooltipShortcut:v,hideIndicatorText:y,icon:j,showRemoveIcon:w,showCaretIcon:M,limitInfo:k,layoutId:_,...A}=e,C=(0,c.c)(),N=C?x.simplified:x.legacy,S=k?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[j,(0,s.jsx)(u.J,{remaining:k.remaining,total:k.total})]}):j,E=(0,s.jsx)(o.P.div,{layoutId:_,className:(0,r.A)("flex",f?"shrink min-w-8":"shrink-0",h),initial:C?{opacity:0}:{opacity:0,scale:.6},animate:C?{opacity:1}:{opacity:1,scale:1},exit:C?{opacity:0}:void 0,transition:C?{duration:.075,delay:.05,ease:"easeOut"}:{type:"spring",stiffness:700,damping:32,mass:.7},children:(0,s.jsxs)("button",{className:(0,r.A)(N.border,"transition-all h-8 flex items-center group !pointer-events-auto !outline-offset-1 overflow-hidden px-1.5",y||!f?"min-w-8 rounded-lg justify-center":"min-w-8 rounded-lg",a?N.active:N.inactive,!d&&(a?N.activeHover:N.inactiveHover),!d&&"active:scale-[0.98]",d&&"opacity-50 cursor-not-allowed",g),disabled:d,"aria-pressed":a,"aria-label":b,...A,children:[S,!!f&&!y&&(0,s.jsxs)("div",{className:"min-w-0 flex items-center",children:[(0,s.jsx)("p",{className:"min-w-0 pl-1 text-xs text-ellipsis whitespace-nowrap break-words overflow-hidden shrink",children:f}),!!p&&(0,s.jsx)(m.u,{tag:p,className:"!top-0 !ml-1"})]}),M&&(0,s.jsx)(i.a,{size:12,className:"ml-1 opacity-70"}),!d&&w&&(0,s.jsx)("div",{className:"duration-100 w-0 group-hover:w-3 opacity-0 group-hover:opacity-100 transition-all ml-0 group-hover:ml-0.5 group-hover:mr-1",children:(0,s.jsx)(n.aRv,{})})]})},_);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(l.m,{tooltipContent:b,disableHoverableContent:!0,side:"bottom",align:"center",keyboardShortcut:v,children:E})})});f.displayName="InputMenuButton"},0x16037d0ff:(e,t,a)=>{a.d(t,{I:()=>s});let s="chat-input-menu-search-input"},0x16801a2b9:(e,t,a)=>{a.d(t,{u:()=>u,i:()=>m});var s=a(0x22102fd88),n=a(0x286b4261),l=a.n(n),i=a(0xfc89b4a4);function r(e,t){switch(t.type){case"OPEN_COMPASS_STATUS":return{...e,selectedItem:{type:"compass",data:t.data}};case"SELECT_ATTACHMENT":return{...e,selectedItem:{type:"attachment",attachment:t.attachment}};case"SELECT_ARTIFACT":return{...e,selectedItem:{type:"artifact",id:t.id,versionUuid:t.versionUuid}};case"SELECT_DOC":return{...e,selectedItem:{type:"doc",id:t.id}};case"SELECT_FILE":return{...e,selectedItem:{type:"file",path:t.path,toolType:t.toolType,messageId:t.messageId}};case"CLEAR_SELECTED":return{...e,selectedItem:null,activeMessageUuid:void 0};case"SET_ACTIVE_MESSAGE_UUID":return{...e,activeMessageUuid:t.uuid};case"UPDATE_ATTACHMENTS":return{...e,attachments:t.attachments};case"UPDATE_FILES":return{...e,files:t.files};case"UPDATE_SYNC_SOURCES":return{...e,syncSources:t.syncSources};case"UPDATE_STREAMING_FILE":{var a,s;let n=new Map(e.streamingFiles),l=n.get(t.path);return n.set(t.path,{content:t.content,renderAs:t.renderAs,showingInRightPane:null!=(s=null!=(a=t.showingInRightPane)?a:null==l?void 0:l.showingInRightPane)&&s}),{...e,streamingFiles:n}}case"CLEAR_STREAMING_FILE":{let a=new Map(e.streamingFiles);return a.delete(t.path),{...e,streamingFiles:a}}default:return e}}let o={selectedItem:null,attachments:[],files:[],syncSources:[],activeMessageUuid:void 0,conversationUuid:void 0,streamingFiles:new Map},d={chatResourceState:o,dispatchChatResource:l()},c=(0,i.createContext)(d);function u(e){let{children:t,conversationUuid:a}=e,[n,l]=(0,i.useReducer)(r,{...o,conversationUuid:a}),d=(0,i.useMemo)(()=>({chatResourceState:n,dispatchChatResource:l}),[n,l]);return(0,s.jsx)(c.Provider,{value:d,children:t})}function m(){return(0,i.useContext)(c)}},0x175a3352c:(e,t,a)=>{a.d(t,{J:()=>n});var s=a(0x22102fd88);a(0xfc89b4a4);let n=e=>{let{remaining:t,total:a}=e;return(0,s.jsxs)("span",{className:"inline-flex items-center gap-0.5 text-accent-secondary-100 bg-bg-000 border-0.5 border-border-300 rounded-full px-2 py-0.5 text-xs ml-1",children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("span",{children:"/"}),(0,s.jsx)("span",{children:a})]})}},0x17774dcd8:(e,t,a)=>{a.d(t,{Hd:()=>m,Ob:()=>x,gB:()=>u,lS:()=>p,nb:()=>f});var s=a(0x14de19ae8),n=a(0x78b33fbd),l=a(0xbdad302d),i=a(0x3769f4df),r=a(0x9cb4c2a2),o=a(0x1611828d),d=a(0xe824fb1c),c=a(0x1f22b8dda);let u=()=>{let e=(0,s.h0)(),t=(0,i.be)(),a=(0,d.Uz)().length>0,n=p();return!e&&!t&&a&&!n},m=()=>{let e=(0,s.h0)(),t=(0,d.Uz)().length>0;return e||t},x=()=>{let e=(0,s.h0)(),t=(0,n.useLayer)("trials_freemium");return!e&&t.get("show_upgrade_buttons",!1)};function f(){let{conversation:e}=(0,r.oM)();return(0,c.Zx)(null==e?void 0:e.id)}function p(){(0,l.QJ)();let{conversation:e}=(0,r.oM)();return(0,o.mL)(),(0,c.Zx)(null==e?void 0:e.id),!1}},0x17b66474f:(e,t,a)=>{a.d(t,{Xx:()=>U,_9:()=>z,CH:()=>G,tl:()=>Y});var s=a(0x22102fd88),n=a(0xf32c56dd),l=a(0x286b4261),i=a.n(l),r=a(0xfc89b4a4),o=a(0x2174968e5),d=a(0x10f221f41),c=a(0x116e76ca8),u=a(0xb844abc8),m=a(0x1b813d90),x=a(0x17f3a2521),f=a(0x1bd175d8c),p=a(0x4d348f95),h=a(0x1ab0d1ca1),g=a(0x1d302b010),b=a(0xbebfc702),v=a(0x1334f6ecc),y=a(0xe0c26d90),j=a(0x18175ce17),w=a(0x945c7f20),M=a(0x1c12b3087),k=a(0xf8bd7957),_=a(0xe824fb1c),A=a(0x17774dcd8),C=a(0x19f7d0900),N=a(0x1ddbde9f),S=a(0xa7346e51),E=a(0x2230d6f61),I=a(0x733b8fe2),T=a.n(I);let R={includeScore:!0,isCaseSensitive:!1,ignoreLocation:!0,threshold:.4},D={path:null,inputMenuSearchQuery:"",setInputMenuSearchQuery:i(),inputMenuIsOpen:!1,setInputMenuIsOpen:i(),menuView:{rootItems:[],currentItems:[]},handleClickItem:i(),handleBack:i(),highlightedItemKey:null,setHighlightedItemKey:i(),animationDirection:"none"},O={...D,styleModalOpenWithScreen:null,setStyleModalOpenWithScreen:i(),createProjectModalIsOpen:null,setCreateProjectModalIsOpen:i(),githubModalIsOpen:!1,setGithubModalIsOpen:i(),gmailAuthModalIsOpen:!1,setGmailAuthModalIsOpen:i(),createPromptArgumentModalIsOpen:null,setCreatePromptArgumentModalIsOpen:i()},P={...D,mcpDirectoryModalIsOpen:!1,setMcpDirectoryModalIsOpen:i()},L=(0,r.createContext)(O),F=(0,r.createContext)(P),z=e=>{let{actions:t,rootItems:a,menuType:l,inputMenuIsOpen:i,setInputMenuIsOpen:o}=e,u=(0,n.st)(),x=(0,r.useRef)(null),[f,p]=(0,r.useState)(null),[g,y]=(0,r.useState)(null),[j,M]=(0,r.useState)(""),k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i&&e){o(!0),"plus"===l&&u.track({event_key:"claudeai.plus_menu.opened"});return}if(i&&!e){M("");let e=()=>{var e;_(null,!0),y(null),o(!1),null==(e=document.getElementById("input-".concat(l,"-menu-trigger")))||e.focus()};t.withDelay?setTimeout(e,200):e()}},_=(e,t)=>{t?x.current=e:x.current=f,p(e)},A=(()=>{if(f){let e=a.find(e=>e.key===f);if(e&&"children"in e)return e.children}return a})(),C=(e=>{let{actions:t,inputMenuSearchQuery:a,inputMenuIsOpen:n,pathItems:l,path:i,menuType:o}=e,u=(0,h.A)(),x=(0,r.useRef)(a),{handleSearchDrive:f,searchedDriveItems:p}=(e=>{let{path:t,actions:a,inputMenuSearchQuery:n,inputMenuIsOpen:l,menuType:i}=e,o="drive",d=(t===o||!t)&&l&&"plus"===i,u=(0,v.LP)(),[x,f]=(0,r.useState)([]),{recentDriveDocs:p}=(0,v.zH)(d),h=(0,r.useMemo)(()=>new E.A(p,{...R,keys:["title"]}),[p]);return u&&d?{handleSearchDrive:()=>{let e=n.toLowerCase();if(!e||!p)return[];f(h.search(e,{limit:t===o?10:5}).map(e=>({key:e.item.uri,type:"button",label:e.item.title||"",icon:(0,s.jsx)(c.A9,{type:m.v8.GDRIVE,variant:c.UF.DOCS,size:16}),onClick:()=>{a.createDriveSyncSource(e.item.uri)}})))},searchedDriveItems:x}:{handleSearchDrive:()=>[],searchedDriveItems:[]}})({path:i,actions:t,inputMenuSearchQuery:a,inputMenuIsOpen:n,menuType:o}),{handleSearchProjects:g,searchedProjectItems:y}=(e=>{let{path:t,actions:a,inputMenuSearchQuery:n,inputMenuIsOpen:l,menuType:i,pathItems:o}=e,c="projects",u=(0,w.K)(),m=o.map(e=>{let{key:t}=e;return t}).indexOf("projects")>-1||"projects"===t,x=!!(n&&m&&(t===c||!t)&&l&&u&&"plus"===i),[f,p]=(0,r.useState)([]),{data:h}=(0,b.CB)({enabled:x,limit:b.dx}),g=(0,r.useMemo)(()=>new E.A(h||[],{...R,keys:["name","description"]}),[h]);return x?{handleSearchProjects:()=>{let e=n.toLowerCase();if(!e||!h)return[];p(g.search(e,{limit:t===c?10:5}).map(e=>({type:"button",key:e.item.uuid,label:e.item.name,icon:(0,s.jsx)(d.JtL,{size:16}),subtitle:e.item.creator.full_name,onClick:()=>a.onSelectProject(e.item.uuid)})))},searchedProjectItems:f}:{handleSearchProjects:()=>[],searchedProjectItems:[]}})({path:i,actions:t,inputMenuSearchQuery:a,inputMenuIsOpen:n,menuType:o,pathItems:l}),{handleFilterMenuItems:j,filteredMenuItems:M}=(e=>{let{path:t,inputMenuSearchQuery:a,pathItems:s}=e,n=s.filter(e=>{let{menuItemHidden:t}=e;return!t}),[l,i]=(0,r.useState)([]);return"projects"===t||"drive"===t?{handleFilterMenuItems:()=>[],filteredMenuItems:[]}:{handleFilterMenuItems:()=>{let e=a.toLowerCase();if(!e)return n;let t=[];for(let e of n)t.push(e),!e.isDisabled&&"projects"!==e.key&&"drive"!==e.key&&"children"in e&&e.children&&t.push(...e.children);i(t.filter(t=>!t.nonSearchable&&"toggleAll"!==t.type&&"back"!==t.type&&"divider"!==t.type&&"string"==typeof t.label&&t.label.toLowerCase().includes(e)).slice(0,7))},filteredMenuItems:l}})({path:i,inputMenuSearchQuery:a,pathItems:l}),k=(0,r.useCallback)(()=>{j(),g(),f()},[j,g,f]),_=(0,r.useMemo)(()=>T()(()=>{k()},100),[k]);return((0,r.useEffect)(()=>{if(a&&n&&a!==x.current)return x.current=a,_(),()=>{_.cancel()}},[n,a,_]),M.length||y.length||p.length)?[M,y,p].reduce((e,t,a)=>[...e,...e.length&&t.length?[{key:"divider".concat(a+1),type:"divider",label:""}]:[],...t],[]):[{key:"loading",type:"button",label:u.formatMessage({defaultMessage:"No results found",id:"hX5PAbCTOR"}),icon:(0,s.jsx)(S.e,{size:16}),onClick:()=>void 0,isDisabled:!0}]})({actions:t,inputMenuSearchQuery:j,inputMenuIsOpen:i,pathItems:A,path:f,menuType:l}),I=j.trim().length?C:A,{handleClickItem:D,handleBack:O}=(e=>{let{currentItems:t,inputMenuIsOpen:a,setInputMenuIsOpen:s,inputMenuSearchQuery:n,setInputMenuSearchQuery:l,path:i,handleUpdatePath:o,highlightedItemKey:d,setHighlightedItemKey:c}=e,u=(0,r.useCallback)(e=>{if("toggleGroup"===e.type||"optionGroup"===e.type||"buttonGroup"===e.type)s(!0),o(e.key,!0);else if("button"===e.type||"switch"===e.type||"toggle"===e.type||"option"===e.type){var t;null==(t=e.onClick)||t.call(e)}},[s,o]),m=(0,r.useCallback)(e=>{i&&(null==e||e.preventDefault(),o(null),c(i),(0,N.l)())},[i,c,o]),x=(0,r.useCallback)(e=>{let a,s=t.filter(e=>!["subheader","divider"].includes(e.type)&&!e.isDisabled&&!e.menuItemHidden),n=s.findIndex(e=>{let{key:t}=e;return t===d});a="ArrowUp"===e?n>0?n-1:s.length-1:n<s.length-1?n+1:0,c(s[a].key)},[t,d,c]),f=(0,r.useCallback)(e=>{var t,n,i;if(!a)return void u(e);if(!e.isDisabled){if(l(""),"back"===e.type)return void m();if("button"===e.type){null==(t=e.onClick)||t.call(e),e.skipCloseOnClick||s(!1);return}if("toggleGroup"===e.type||"optionGroup"===e.type||"buttonGroup"===e.type){o(e.key),c(null),(0,N.l)();return}"option"===e.type&&(null==(n=e.onClick)||n.call(e),e.skipCloseOnClick||s(!1,{withDelay:!0})),("toggleAll"===e.type||"toggle"===e.type||"switch"===e.type)&&(null==(i=e.onClick)||i.call(e),(0,N.l)())}},[m,u,o,a,l,s,c]),p=(0,r.useCallback)((e,a)=>{if(!d)return;let s=t.find(e=>{let{key:t}=e;return t===d});s&&("Enter"===e||["optionGroup","toggleGroup","buttonGroup"].includes(s.type))&&(a.preventDefault(),f(s))},[d,t,f]);return(0,r.useEffect)(()=>{if(!a)return;let e=e=>{"Tab"===e.key?e.preventDefault():"Escape"===e.key?(e.preventDefault(),s(!1)):"ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),x(e.key)):"ArrowRight"===e.key||"Enter"===e.key?p(e.key,e):"ArrowLeft"!==e.key||n||m(e)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a,s,n,x,p,m]),{handleClickItem:f,handleBack:m}})({currentItems:I,inputMenuIsOpen:i,setInputMenuIsOpen:k,inputMenuSearchQuery:j,setInputMenuSearchQuery:M,path:f,handleUpdatePath:_,highlightedItemKey:g,setHighlightedItemKey:y}),P=x.current&&!f?"back":!x.current&&f?"forward":"none";return{path:f,inputMenuSearchQuery:j,setInputMenuSearchQuery:M,inputMenuIsOpen:i,setInputMenuIsOpen:k,menuView:{rootItems:a,currentItems:I},handleClickItem:D,handleBack:O,highlightedItemKey:g,setHighlightedItemKey:y,animationDirection:P}};function U(e){let{placement:t,sessionMcpServers:a,children:n}=e,[l,i]=(0,r.useState)(!1),[N,S]=(0,r.useState)(!1),[E,I]=(0,r.useState)(null),[T,R]=(0,r.useState)(!1),[D,O]=(0,r.useState)(!1),[P,U]=(0,r.useState)(!1),[G,Y]=(0,r.useState)(null),[H,K]=(0,r.useState)(null),V=(0,C.Cn)({setMcpDirectoryModalIsOpen:U,setStyleModalOpenWithScreen:Y,setCreateProjectModalIsOpen:I,setGithubModalIsOpen:R,setGmailAuthModalIsOpen:O,setCreatePromptArgumentModalIsOpen:K}),W=(e=>{let{placement:t,actions:a,inputMenuIsOpen:n}=e,l=(0,h.A)(),i=(e=>{let{actions:t}=e,a=(0,h.A)();return(0,f.V)()||(0,u.fJ)()?null:{key:x.xd.ADD_SCREENSHOT,type:"button",icon:(0,s.jsx)(d.i7d,{size:16}),label:a.formatMessage({defaultMessage:"Take a screenshot",id:"aTaOpCB71M"}),onClick:t.onAddScreenshot}})({actions:a}),r=(0,j.kO)(),o=(e=>{let{actions:t}=e,a=(0,h.A)();return(0,y.Cq)()?{key:x.xd.GITHUB,type:"button",icon:(0,s.jsx)(c.A9,{type:m.v8.GITHUB,size:16}),label:a.formatMessage({defaultMessage:"Add from {github}",id:"h3J3E4bRfj"},{github:"GitHub"}),onClick:t.openGithubModal}:null})({actions:a}),N=(e=>{let{actions:t,inputMenuIsOpen:a}=e,n=(0,h.A)(),l=(0,A.Hd)(),i=(0,v.LP)(),{isDriveAuthenticated:r,initDriveAuth:o}=(0,v.cI)(),{recentDriveDocs:d,isLoading:u}=(0,v.zH)(a);if(!i)return null;let f=n.formatMessage({defaultMessage:"Add from {drive}",id:"hwJ50OkM/9"},{drive:"Google Drive"}),p={key:x.xd.DRIVE,icon:(0,s.jsx)(c.A9,{type:m.v8.GDRIVE,size:16}),label:f};if(!r)return{...p,type:"button",isExternal:!0,secondaryText:n.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),onClick:o};let g=u?[{key:"drive-loading",type:"button",label:n.formatMessage({defaultMessage:"{drive} documents loading...",id:"PjuSZ/7RIb"},{drive:"Drive"}),isDisabled:!0}]:d.length?d.slice(0,8).map(e=>{var a;return{key:e.uri,type:"button",label:null!=(a=e.title)?a:"Untitled",icon:(0,s.jsx)(c.A9,{type:m.v8.GDRIVE,variant:c.UF.DOCS,size:16}),onClick:()=>{t.createDriveSyncSource(e.uri)}}}):[{key:"empty",type:"button",label:n.formatMessage({defaultMessage:"No recent {drive} documents",id:"XepM9W1Mo/"},{drive:"Drive"}),isDisabled:!0}];return{...p,type:"buttonGroup",children:[...l?[]:[{type:"back",key:"drive-back",label:f}],...g]}})({actions:a,inputMenuIsOpen:n}),S=(e=>{let{inputMenuIsOpen:t,actions:a}=e,n=(0,h.A)(),l=(0,A.Hd)(),i=(0,M.QN)(),{isProjectLocked:r}=(0,M.Jy)(e=>({isProjectLocked:e.isProjectLocked})),o=(0,w.K)(),c=(0,p.usePathname)(),u="string"==typeof c&&c.startsWith("/project/"),{data:m}=(0,b.CB)({enabled:t&&o,creatorFilter:"is_creator",limit:8}),{data:f}=(0,b.CB)({enabled:t&&o,creatorFilter:"is_not_creator",limit:8}),g=[...m||[],...f||[]],{data:v}=(0,b.fo)(i),y=(null==g?void 0:g.slice(0,8).map(e=>({key:e.uuid,type:"option",label:e.name,subtitle:e.creator.full_name,onClick:()=>a.onSelectProject(e.uuid,e.name),icon:(0,s.jsx)(d.JtL,{size:16}),isChecked:e.uuid===i})))||[];if(r||!o||u)return null;let j=n.formatMessage({defaultMessage:"Use a project",id:"H/dsl+Px2v"});return{key:x.xd.PROJECTS,type:"optionGroup",icon:(0,s.jsx)(d.JtL,{size:16}),label:j,secondaryText:null==v?void 0:v.name,children:[...l?[]:[{type:"back",key:"projects-back",label:j}],...y,{key:"divider1",type:"divider",label:""},{key:"add",type:"button",variant:"primary",icon:(0,s.jsx)(d.OMN,{size:16}),label:n.formatMessage({defaultMessage:"Start a new project",id:"0y7bg6nA29"}),onClick:()=>a.onCreateProject(!1),nonSearchable:!0}],indicatorActive:!!v}})({actions:a,inputMenuIsOpen:n}),E=(e=>{let{actions:t}=e,a=(0,h.A)(),n=(0,_.Uz)({isConnected:!0,hasPromptsOrResources:!0}),l=(0,g.R4)(),i=(0,g.vW)();return n.map(e=>{let n=e.prompts.map(a=>({key:"prompt-".concat(e.name,"-").concat(a.name),type:"button",icon:(0,s.jsx)(d.ryu,{size:16}),label:a.displayName,onClick:()=>{var s;return(null==(s=a.arguments)?void 0:s.length)?t.onEnterPromptArguments(e.uuid,a):void i({serverUuid:e.uuid,prompt:a,args:{}})}})),r=e.resources.map(t=>({key:"resource-".concat(e.name,"-").concat(t.uri),type:"button",icon:(0,s.jsx)(d.ZHH,{size:16}),label:t.displayName,onClick:()=>void l({serverUuid:e.uuid,resource:t})}));return{key:"mcp-server-".concat(e.name),type:"buttonGroup",label:a.formatMessage({defaultMessage:"Add from {server}",id:"qEj6u51OfR"},{server:e.name}),icon:(0,s.jsx)(k.z,{size:16,type:e.iconType,src:e.iconSrc,name:e.name}),children:[...n,...r]}})})({actions:a});return[{key:x.xd.UPLOAD,type:"button",icon:(0,s.jsx)(d.o3O,{size:16}),label:l.formatMessage({defaultMessage:"Upload a file",id:"Zc9xq9TzDD"}),onClick:()=>(0,C.U_)(t)},...i?[i]:[],...o?[o]:[],...N&&!r?[N]:[],...E,...S?[{key:"divider1",type:"divider",label:""},S]:[]]})({placement:t,actions:V,inputMenuIsOpen:l}),B=z({actions:V,rootItems:W,menuType:"plus",inputMenuIsOpen:l,setInputMenuIsOpen:i}),J=(0,o.ey)({actions:V,sessionMcpServers:a}),q=z({actions:V,rootItems:J,menuType:"tools",inputMenuIsOpen:N,setInputMenuIsOpen:S}),X=(0,r.useMemo)(()=>({...B,styleModalOpenWithScreen:G,setStyleModalOpenWithScreen:Y,createProjectModalIsOpen:E,setCreateProjectModalIsOpen:I,githubModalIsOpen:T,setGithubModalIsOpen:R,gmailAuthModalIsOpen:D,setGmailAuthModalIsOpen:O,createPromptArgumentModalIsOpen:H,setCreatePromptArgumentModalIsOpen:K}),[B,G,Y,E,I,T,R,D,O,H,K]),Z=(0,r.useMemo)(()=>({...q,mcpDirectoryModalIsOpen:P,setMcpDirectoryModalIsOpen:U}),[q,P,U]);return(0,s.jsx)(L.Provider,{value:X,children:(0,s.jsx)(F.Provider,{value:Z,children:n})})}function G(){return(0,r.useContext)(L)}function Y(){return(0,r.useContext)(F)}},0x17ced59d0:(e,t,a)=>{a.d(t,{s:()=>c});var s=a(0x22102fd88),n=a(0x10f221f41),l=a(0xb844abc8),i=a(0x17f3a2521),r=a(0x1a1f6dda6),o=a(0x1ab0d1ca1),d=a(0x16037d0ff);let c=e=>{let{path:t,inputMenuSearchQuery:a,setInputMenuSearchQuery:c,handleBack:u,className:m}=e,x=(0,o.A)(),f=(0,l.fJ)(),p={[i.xd.DRIVE]:x.formatMessage({defaultMessage:"Search Google Drive",id:"1bbXc6Z3S1"}),[i.xd.PROJECTS]:x.formatMessage({defaultMessage:"Search projects",id:"doPT7U8q21"}),[i.xd.STYLES]:x.formatMessage({defaultMessage:"Search styles",id:"9oQ0JkPwFY"})},h=t&&t in p?p[t]:x.formatMessage({defaultMessage:"Search menu",id:"lL4HM3zEqr"}),g=null===t||!!a.trim().length;return(0,s.jsxs)("div",{className:(0,r.A)("flex flex-row items-center gap-2.5 px-1.5 w-full rounded-md h-[2rem]",m),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,s.jsx)(n.vji,{className:(0,r.A)("text-text-500/50 transition-opacity",g?"opacity-100":"opacity-0")})}),(0,s.jsx)("button",{onClick:u,className:(0,r.A)("transition-opacity text-text-500 hover:text-text-100 absolute left-0 top-0",g?"opacity-0":"opacity-100"),disabled:g,children:(0,s.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,s.jsx)(n.nkM,{})})})]}),(0,s.jsx)("input",{autoFocus:!f,id:d.I,className:"block bg-transparent hide-focus-ring leading-6 placeholder:text-text-500/70 font-base text-text-300 w-full",placeholder:h,value:a,onChange:e=>c(e.target.value)})]})}},0x1809b01ca:(e,t,a)=>{a.d(t,{E:()=>g,I:()=>h});var s=a(0x628a9a0b),n=a(0xf32c56dd),l=a(0x14de19ae8),i=a(0xefe6388f),r=a(0x17e725145),o=a(0x37cf97f9),d=a.n(o),c=a(0x4d348f95),u=a(0xfc89b4a4),m=a(0x1f150de5e),x=a(0xfd34bc37);let f=["cached_stream"];function p(e){let t=new URLSearchParams(window.location.search),a=new URLSearchParams;for(let e of f){let s=t.get(e);null!==s&&a.set(e,s)}let s=a.toString();return""!==s?"".concat(e,"?").concat(s):e}let h=()=>{let e="new-conversation-params-for-navigation",t=(0,i.d)("pipit"),a=(0,r.useQueryClient)(),s=(0,u.useCallback)(()=>{let a=t.getItem(e);if(!a)return{};try{let e=JSON.parse(a);return d()(e,e=>Date.now()-e.created_at<6e4)}catch(a){t.removeItem(e)}return{}},[t]);return{prepareNewConversation:(0,u.useCallback)((n,l)=>{let i={created_at:Date.now(),...l};a.setQueryData([e,n],i);let r=s();r[n]=i,t.setItem(e,JSON.stringify(r))},[a,s,t]),getCreateParamsForConvo:(0,u.useCallback)(n=>{let l=s(),i=a.getQueryData([e,n])||l[n];a.removeQueries({queryKey:[e,n]});let r=d()(l,(e,t)=>t!==n);return t.setItem(e,JSON.stringify(r)),i},[a,s,t])}};function g(){var e;let{setTemporaryConversationUuid:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,n.st)(),{data:i}=(0,s.Fn)(),{mutateAsync:r}=(0,s.CW)(),[o,d]=(0,x.d)(),{prepareNewConversation:f}=h(),{account:g}=(0,l.YL)(),{setCompletionStatus:b}=(0,m.U)(o,!0),v=(0,c.useRouter)();return(0,u.useCallback)(async e=>{var s;let{model:n,project_uuid:l,include_conversation_preferences:c,paprika_mode:u,compass_mode:m,create_mode:x,name:h,is_temporary:y}=e,j=r({uuid:o,name:null!=h?h:"",model:n,project_uuid:l,include_conversation_preferences:c,paprika_mode:u,compass_mode:m,create_mode:x,is_temporary:y});if(f(o,e),await j,(e.prompt||e.attachments.length>0||e.files.length>0||e.syncSources.length>0)&&b(!0),y)null==t||t(o);else if((null==g||null==(s=g.settings)?void 0:s.has_finished_claudeai_onboarding)===!1){let e=p("/chat/".concat(o)),t=new URLSearchParams;t.append("returnTo",e);let a="/onboarding?".concat(t.toString());v.push(a)}else{let e=p("/chat/".concat(o));v.push(e)}return d(),(null==i?void 0:i.is_first_conversation)&&await a.track({event_key:"chat.conversation.first_conversation_created",surface:"claude.ai"}),{uuid:o}},[r,o,d,i,a,v,f,null==g||null==(e=g.settings)?void 0:e.has_finished_claudeai_onboarding,t,b])}},0x19aca0448:(e,t,a)=>{a.d(t,{g:()=>c,h:()=>d});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x800328fa),i=a(0x78b33fbd),r=a(0x38e6572),o=a(0x1025e2485);function d(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,s=(0,n.mz)(t||""),l=null==s||null==(e=s.chat_messages)?void 0:e.at(-1),r=function(e){let{stopReason:t,model:a}=e,s=(0,i.useDynamicConfig)("holdup");if(!a||!t)return;let n=s.get("modelFallbacks",{})[a];if(n&&"refusal"===t)return n}({stopReason:null==l?void 0:l.stop_reason,model:a});return l&&"assistant"===l.sender&&("prompt_injection_risk"===l.stop_reason||"refusal"===l.stop_reason)?{stopReason:l.stop_reason,lastMessage:l,fallback:r}:null}function c(e){let t=(0,n.bT)("push"),a=()=>{t()},i=e=>(0,s.jsx)(l.Y,{onClick:a,children:e});return(0,s.jsx)(o.q,{actionButton:null,children:(0,s.jsx)("div",{className:"text-text-200 flex w-full items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)("span",{children:"refusal"===e.stopReason?(0,s.jsx)(r.A,{defaultMessage:"Claude is unable to respond to this request, which appears to violate our <policyLink>Usage Policy</policyLink>. Please <newChat>start a new chat</newChat>.",id:"JQtAKVGSTL",values:{policyLink:e=>(0,s.jsx)("a",{href:"https://www.anthropic.com/legal/aup",target:"_blank",className:"underline cursor-pointer",children:e}),newChat:i}}):(0,s.jsx)(r.A,{defaultMessage:"Claude is unable to respond to this request. Please <newChat>start a new chat</newChat>.",id:"VZKromeiwV",values:{newChat:i}})})})})})}},0x19f7d0900:(e,t,a)=>{async function s(e){let t,a="CaptureController"in window?new CaptureController:null;null==a||a.setFocusBehavior("no-focus-change");try{t=await navigator.mediaDevices.getDisplayMedia({video:!0,controller:a})}catch(e){if(e instanceof DOMException&&"NotAllowedError"===e.name)return null;throw e}let s=document.createElement("video");s.srcObject=t,await new Promise((e,t)=>{s.onloadedmetadata=()=>{s.play().then(e,t)}});let n=document.createElement("canvas");if(e){let t=Math.min(e.width/Math.min(s.videoWidth,e.width),e.height/Math.min(s.videoHeight,e.height));n.width=s.videoWidth*t,n.height=s.videoHeight*t}else n.width=s.videoWidth,n.height=s.videoHeight;let l=n.getContext("2d");if(!l)throw Error("Could not create 2D context");l.drawImage(s,0,0,n.width,n.height);let i=n.toDataURL("image/png");return t.getTracks().forEach(e=>e.stop()),{imageDataUrl:i}}a.d(t,{U_:()=>M,pi:()=>A,$V:()=>k,Cn:()=>j});var n=a(0xf32c56dd),l=a(0x139b5e710),i=a(0x1e61aab5a),r=a(0x1b813d90),o=a(0x253a5c787),d=a(0x1ab0d1ca1),c=a(0x1e841cc7d),u=a(0xbebfc702),m=a(0x1334f6ecc),x=a(0xe0c26d90),f=a(0x9cb4c2a2),p=a(0x1c12b3087),h=a(0x1fb2770f2),g=a(0x204a5f1d2),b=a(0x6b95b9a1),v=a(0x1e48e639d),y=a(0x1214e4a54);let j=e=>{let{setMcpDirectoryModalIsOpen:t,setStyleModalOpenWithScreen:a,setCreateProjectModalIsOpen:s,setGithubModalIsOpen:n,setGmailAuthModalIsOpen:l,setCreatePromptArgumentModalIsOpen:r}=e,o=_(),d=A(),c=k(),{openFeaturePreviewModal:u}=(0,g.go)(),{checkIsGithubAuthenticated:f,initGithubAuth:p}=(0,x.nB)(),{initDriveAuth:h}=(0,m.cI)();return{onAddScreenshot:()=>{o()},openGithubModal:()=>{f().then(e=>{if(!e)return void p();n(!0)})},openGmailAuthModal:()=>{l(!0)},openMcpDirectoryModal:()=>{t(!0)},initDriveAuth:h,createDriveSyncSource:w(),onStyleChange:e=>{d(e)},openStyleModal:()=>{a(i.I.LIST)},onSelectProject:(e,t)=>{c(e,t)},onCreateProject:e=>{s({isOpen:!0,moveAttachments:e})},openFeaturePreviewModal:u,onEnterPromptArguments:(e,t)=>{r({isOpen:!0,serverUuid:e,prompt:t})}}},w=()=>{let{addError:e}=(0,l.Y)(),{setSyncSourceUuids:t}=(0,p.Jy)(e=>({setSyncSourceUuids:e.setSyncSourceUuids})),{setIsUploadingDriveSync:a}=(0,f.oM)(),{mutate:s}=(0,c.EF)({onMutate:()=>{a(!0)},onSuccess:e=>{a(!1),t(t=>[...t,e.uuid])},onError:t=>{a(!1),e((0,v.J)(t),{error:t,errorContext:{tags:{source:"chat_input_drive_sync_create"}}})},meta:{noToast:!0}});return e=>s({sync_source_type:r.v8.GDRIVE,sync_source_config:{uri:e}})},M=e=>{var t;null==(t=document.getElementById("chat-input-file-upload-".concat(e)))||t.click()},k=()=>{let e=(0,p.QN)(),{setProjectUuid:t,conversation:a}=(0,f.oM)(),{moveToProject:s}=(0,y.j)(),{removeFromProject:n}=(0,u.nl)();return async(l,i)=>{e===l?(null==a?void 0:a.id)?await n([a.id],{showSuccess:!1}):t(void 0):(null==a?void 0:a.id)&&l?await s([a.id],l,i,{enableNavigation:!0}):t(l)}},_=()=>{let{addError:e}=(0,l.Y)(),t=(0,d.A)(),{handleUpload:a}=(0,f.oM)(),i=(0,n.st)();return async()=>{i.track({event_key:"claudeai.plus_menu.screenshot_clicked"});let n=null;try{n=await s({width:1568,height:1568})}catch(a){(0,o.Cp)(a),e(t.formatMessage({defaultMessage:"Could not capture screen",id:"GT8HkzCHoM"}),{error:a,messageForLogging:"Could not capture screen"})}if(!n)return;let l=new File([await fetch(n.imageDataUrl).then(e=>e.blob())],"screenshot.png",{type:"image/png"});await a([l])}},A=()=>{let{setPersonalizedStyle:e}=(0,f.oM)(),t=(0,n.st)(),{personalizedStyleOptions:a,setStoredStyle:s}=(0,h.p)();return n=>{let l=a.find(e=>e.key===n);if(!l)return;e(l);let i=(0,b.X)(l);s({styleKey:i,timestamp:new Date}),t.track({event_key:"styles.selected",style_key:i})}}},0x1a0d98d13:(e,t,a)=>{a.d(t,{V:()=>n9});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x56ac793a),i=a(0x14de19ae8),r=a(0x139b5e710),o=a(0x9845e38c),d=a(0xfc89b4a4),c=a(0xfd34bc37),u=a(0x1065e6d73),m=a(0xac309a83),x=a(0x1888e36ef),f=a(0x1a1f6dda6),p=a(0x160045b25),h=a(0x1dc411c0f),g=a(0x1e841cc7d),b=a(0x5e00aadc),v=a(0x31c535e9),y=a(0x57fcb279),j=a(0xde6c3752),w=a(0x9cb4c2a2),M=a(0xafe3e930);function k(e){let{className:t,...a}=e;return(0,s.jsx)("div",{...a,className:(0,f.A)("bg-bg-100 w-full h-2",t)})}function _(e){let{className:t,...a}=e;return(0,s.jsx)("div",{...a,className:(0,f.A)("!box-content flex flex-col bg-bg-000 mx-2 md:mx-0 items-stretch transition-all duration-200 relative cursor-text z-10 rounded-2xl",t)})}function A(e){let{className:t,...a}=e;return(0,s.jsx)("fieldset",{...a,className:(0,f.A)("flex w-full min-w-0 flex-col",t)})}let C=(0,d.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("textarea",{ref:t,...n,className:(0,f.A)("block [outline:none!important] resize-none w-full bg-transparent text-text-100 placeholder:text-text-400",a)})});function N(){return(0,M.c)()?"pl-[6px] pt-[6px]":void 0}function S(e){let{className:t,...a}=e,n=(0,M.c)();return(0,s.jsx)("div",{...a,className:(0,f.A)("flex flex-col m-3.5",n?"gap-3":"gap-3.5",t)})}C.displayName="InputTextarea";var E=a(0x18bfd014),I=a(0x257a56b3),T=a(0x78b33fbd);let R="progressively_enhanced_chat_input",D={isTipTapReady:!1,promptInputSsrEnabled:!1,promptInputSsrTextareaRef:{current:null},handleTipTapReady:()=>{},handleKeyDownCapture:()=>{}};function O(){let e=(0,T.useExperiment)(R).get("prog_chat_input_enabled",!1);(0,d.useEffect)(()=>{(0,I.xs)(R,void 0,e)},[e]);let t=(0,d.useRef)(null),[a,s]=(0,d.useState)(!1),n=(0,d.useRef)(""),l=(0,d.useRef)(!1),i=(0,d.useRef)(null),r=(0,d.useCallback)(e=>{l.current&&(1!==e.key.length||e.ctrlKey||e.metaKey||e.altKey||(n.current+=e.key,e.preventDefault(),e.stopPropagation()))},[]),o=(0,d.useCallback)(a=>{e&&(i.current=a,l.current=!0,n.current="",requestAnimationFrame(()=>{requestAnimationFrame(()=>{let e=t.current,i=(null==e?void 0:e.value)||"";i&&a.commands.setContent(i),a.commands.focus("end"),requestAnimationFrame(()=>{l.current=!1;let e=n.current;n.current="",e&&a.commands.insertContent(e),s(!0)})})}))},[e]);return e?{isTipTapReady:a,promptInputSsrEnabled:e,promptInputSsrTextareaRef:t,handleTipTapReady:o,handleKeyDownCapture:r}:D}function P(e){let{promptInputSsrEnabled:t}=O(),a=t?L:d.Fragment;return(0,s.jsx)(a,{children:e.children})}function L(e){return(0,s.jsx)("div",{className:"[grid-area:1/1] min-w-0","data-testid":"chat-input-grid-area",children:e.children})}function F(e){let{promptInputSsrEnabled:t}=O();return t?(0,s.jsx)(z,{onKeyDownCapture:e.onKeyDownCapture,children:e.children}):(0,s.jsx)(d.Fragment,{children:e.children})}function z(e){return(0,s.jsx)("div",{className:"grid","data-testid":"chat-input-grid-container",onKeyDownCapture:e.onKeyDownCapture,children:e.children})}var U=a(0xb844abc8),G=a(0x1ab0d1ca1);function Y(e){let{isNewConversation:t,placeholder:a}=e,s=(0,G.A)();return null!=a?a:t?s.formatMessage({defaultMessage:"How can I help you today?",id:"XLcM6WHfQR"}):s.formatMessage({defaultMessage:"Reply...",id:"/dm2sj3W5p"})}function H(e){let{hidden:t,placeholder:a,placement:n,textareaRef:l,className:i}=e;return(0,T.useExperiment)("progressively_enhanced_chat_input").get("prog_chat_input_enabled",!1)?(0,s.jsx)(V,{hidden:t,placeholder:a,placement:n,textareaRef:l,className:i}):(0,s.jsx)(K,{placement:n})}function K(e){let{placement:t}=e,a=(0,m.fS)("chat-ui-core");return(0,s.jsxs)(A,{"data-testid":"prompt-input-ssr-inert",children:[(0,s.jsx)(_,{className:"bottom"===t?"h-[99px]":"h-[123px]"}),"bottom"===t&&!a&&(0,s.jsx)(k,{})]})}function V(e){let t=(0,G.A)(),a=(0,m.fS)("chat-ui-core"),n=N(),l=(0,f.A)("border border-transparent","shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-300)/0.15)] hover:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] hover:focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)]"),i=(0,f.A)("max-h-96 w-full overflow-y-auto font-large break-words transition-opacity duration-200","bottom"===e.placement?"min-h-[1.5rem]":"min-h-[3rem]",n),r=t.formatMessage({defaultMessage:"Write your prompt to Claude",id:"Lxn7p6AQvE"}),o=!(0,U.Fr)(),d=Y({placeholder:e.placeholder,isNewConversation:!0});return(0,s.jsxs)(A,{"data-testid":"prompt-input-ssr-interactive","aria-hidden":e.hidden,className:(0,f.A)("relative",e.hidden&&"opacity-0 pointer-events-none",e.className),children:[(0,s.jsx)(_,{className:l,children:(0,s.jsxs)(S,{children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:i,children:(0,s.jsx)(C,{suppressHydrationWarning:!0,autoFocus:o,"data-testid":"chat-input-ssr","aria-invalid":!1,"aria-label":r,"aria-multiline":!0,"aria-required":!1,defaultValue:"",disabled:!1,placeholder:d,ref:e.textareaRef,className:"[field-sizing:content]"})})}),(0,s.jsx)("div",{className:"h-8 w-full","aria-hidden":"true"})]})}),"bottom"===e.placement&&!a&&(0,s.jsx)(k,{})]})}var W=a(0x1c12b3087),B=a(0x114e73153),J=a(0x597e433e),q=a(0x1b813d90),X=a(0x38e6572),Z=a(0x14c0dfde7),$=a(0x1334f6ecc),Q=a(0x25062734b),ee=a(0x18175ce17),et=a(0x1c03134a9),ea=a(0x1e48e639d),es=a(0xe824fb1c),en=a(0x226530adf),el=a(0x19aca0448),ei=a(0x142811145),er=a(0x1f22b8dda),eo=a(0x225bae024);a(0x20567b754);var ed=a(0xf32c56dd);a(0x286b4261);var ec=a(0xbdad302d);a(0x21687185c);var eu=a(0x14a6d5f1),em=a(0x10f221f41),ex=a(0x1a3383306),ef=a(0x1afb3afe7),ep=a(0x156c4e43b),eh=a(0x1f4bc48d7),eg=a(0xdf883ab6),eb=a(0x218bd2f97);let ev=e=>{var t,a;let{model:n,projectUuid:l}=e,{allModelOptions:i}=(0,eu.A9)(),r=(0,eb.ED)(l),o=(0,eb.Pb)(l),d=null!=(a=null==(t=i.find(e=>e.model===n))?void 0:t.slow_kb_warning_threshold)?a:155e3,c=!o&&(null!=r?r:0)>d?(0,s.jsx)("div",{className:"max-md:hidden",children:(0,s.jsx)(X.A,{defaultMessage:"Large knowledge may slow responses",id:"d6mr4c6d+8"})}):void 0;return(0,s.jsx)("div",{className:"text-text-400 text-xs ml-2",children:null!=c?c:void 0})};var ey=a(0x1ddc8fd3d),ej=a(0x23f1c451b),ew=a(0x1b370f49d),eM=a(0xebbc279e),ek=a(0x2213e6d38),e_=a(0xacfa4f6c),eA=a(0x24b92fff4),eC=a(0x183548b63);let eN=e=>{let{isOpen:t,onClose:a,onConfirm:n,isLoading:l=!1}=e,i=(0,d.useCallback)(e=>{"Enter"!==e.key||l||n()},[n,l]);return(0,d.useEffect)(()=>(t&&window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}),[t,i]),(0,s.jsxs)(eC.aF,{isOpen:t,onClose:a,title:(0,s.jsx)(X.A,{defaultMessage:"Want to stop researching?",id:"H+/TRHeeuc"}),children:[(0,s.jsx)("div",{className:"mt-4 mb-6",children:(0,s.jsx)(X.A,{defaultMessage:"This can’t be undone. If you want to research this topic again, you can ask in this chat or start a new session.",id:"RuV1dagwp6"})}),(0,s.jsxs)(eC.vW,{children:[(0,s.jsx)(eo.$,{variant:"danger",onClick:n,disabled:l,autoFocus:!0,children:(0,s.jsx)(X.A,{defaultMessage:"Stop research",id:"l3tljn/kXe"})}),(0,s.jsx)(eo.$,{variant:"secondary",onClick:a,children:(0,s.jsx)(X.A,{defaultMessage:"Keep researching",id:"ODR/0L48DC"})})]})]})},eS=e=>{let{isPromptEmpty:t,files:a,attachments:n,syncSourceUuids:l,conversation:i,onSend:r,onStop:o,isSending:d,isDisabled:c,disabledReason:u,currentCompassTask:m,skipInitialAnimation:x=!1,canQueueMessages:f=!1}=e,h=!t||a.length>0||n.length>0||l.length>0,g=(()=>{if(m)return"researching";if(i){let{isSampling:e,isStoppingSampling:t}=i;if(e)return t?"stopping":"sampling"}return h?"drafting":"empty"})();return(0,s.jsx)(p.N,{children:f&&("sampling"===g||"stopping"===g)&&h?(0,s.jsx)(eT,{isSending:d,isDisabled:c,disabledReason:u,onSend:r,skipInitialAnimation:x},"send"):"sampling"===g||"stopping"===g?(0,s.jsx)(eI,{onStop:o,isLoading:"stopping"===g},"stop"):"researching"===g?(0,s.jsx)(eE,{conversationId:null==i?void 0:i.id,taskId:m},"stop_research"):(0,s.jsx)(eT,{isSending:d,isDisabled:c,disabledReason:u,onSend:r,skipInitialAnimation:x},"send")})},eE=e=>{let{conversationId:t,taskId:a}=e,n=(0,G.A)(),[l,i]=(0,d.useState)(!1),{mutate:r,isPending:o}=(0,eA.hs)(t,null!=a?a:""),c=(0,d.useCallback)(()=>{t&&a&&(r(),i(!1))},[t,a,r]),u=(0,d.useCallback)(()=>{i(!0)},[]);return(0,d.useEffect)(()=>{let e=e=>{"Escape"!==e.key||o||i(!0)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[o]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ew.m,{tooltipContent:(0,s.jsx)(X.A,{defaultMessage:"Stop Claude response",id:"BonFmr6O3r"}),keyboardShortcut:"Esc",children:(0,s.jsx)(eo.$,{variant:"secondary",size:"icon_sm",className:"!rounded-lg",onClick:u,"aria-label":n.formatMessage({defaultMessage:"Stop response",id:"RANC4/S/j1"}),children:o?(0,s.jsx)(eM.N,{className:"animate-spin",size:18}):(0,s.jsx)(ek.X,{weight:"bold",size:16})})}),(0,s.jsx)(eN,{isOpen:l,onClose:()=>i(!1),onConfirm:c,isLoading:o})]})},eI=e=>{let{onStop:t,isLoading:a}=e,n=(0,G.A)();return(0,d.useEffect)(()=>{let e=e=>{"Escape"!==e.key||a||t()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t,a]),(0,s.jsx)(ew.m,{tooltipContent:(0,s.jsx)(X.A,{defaultMessage:"Stop Claude response",id:"BonFmr6O3r"}),keyboardShortcut:"Esc",children:(0,s.jsx)(eo.$,{variant:"secondary",size:"icon_sm",className:"!rounded-lg",onClick:()=>t(),"aria-label":n.formatMessage({defaultMessage:"Stop response",id:"RANC4/S/j1"}),children:a?(0,s.jsx)(eM.N,{className:"animate-spin",size:18}):(0,s.jsx)(ek.X,{weight:"bold",size:16})})})},eT=e=>{let{isSending:t,isDisabled:a,disabledReason:n,onSend:l,skipInitialAnimation:i=!1}=e,r=(0,G.A)(),o=(0,d.useCallback)(()=>{(0,ej.R)("event","msg_sent",{location:"chat_input"}),l()},[l]);return(0,s.jsx)(h.P.div,{initial:i?{scale:1,opacity:1}:{scale:.3,opacity:0},animate:{scale:1,opacity:1,transition:{delay:.15,scale:{type:"spring",stiffness:600,damping:30},opacity:{duration:.1}}},children:(0,s.jsx)(ew.m,{tooltipContent:n,children:(0,s.jsx)("div",{children:(0,s.jsx)(eo.$,{variant:"claude",size:"icon_sm",className:"!rounded-lg !h-8 !w-8",disabled:a,onClick:()=>o(),"aria-label":r.formatMessage({defaultMessage:"Send message",id:"Xx0WZVz8QS"}),children:t?(0,s.jsx)(eM.N,{className:"animate-spin",weight:"bold",size:16}):(0,s.jsx)(e_.D,{weight:"bold",size:16})})})})})};var eR=a(0x12524db6),eD=a(0x42e19093),eO=a(0xad990a54),eP=a(0xe4807d5),eL=a(0x21cbbfff),eF=a(0x1eb005d6b),ez=a(0x17ba58d56);let eU=e=>{let{children:t,className:a,collisionPadding:n=10,collisionBoundary:l="clipping-ancestors",...i}=e,r="string"==typeof a&&a.includes("max-h-");return(0,s.jsx)(eF.g,{children:(0,s.jsx)(ez.y,{className:(0,f.A)("z-dropdown rounded-xl border-0.5 border-border-200 p-1.5 min-w-[12rem] max-w-[320px]","bg-bg-000 backdrop-blur-xl shadow-[0px_2px_8px_0px_hsl(var(--always-black)/8%)] dark:shadow-[0px_2px_8px_0px_hsl(var(--always-black)/24%)]","overflow-y-auto",!r&&"max-h-[600px]",a),collisionPadding:n,collisionBoundary:l,...i,children:t})})};var eG=a(0xbb84ce70),eY=a(0xa6f0de84),eH=a(0x18804ff89),eK=a(0xce472e9e),eV=a(0x23663c967),eW=a(0x1d1e7ca94),eB=a(0x1c0c7e352),eJ=a(0x2471dc42f);let eq=e=>{let{onClick:t,checked:a,disabled:n}=e;return(0,s.jsx)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),n||t(e)},onPointerDown:e=>{e.stopPropagation()},className:"inline-flex items-center p-0.5 ".concat(n?"cursor-not-allowed":""),children:(0,s.jsx)(eJ.j,{readOnly:!0,size:"small",checked:a,disabled:n,tabIndex:-1})})},eX=["cursor-pointer relative flex items-center justify-between","text-sm min-h-8 px-2 py-1.5 gap-4","group","select-none","rounded-lg","outline-none","data-[disabled]:cursor-not-allowed data-[disabled]:opacity-50","data-[highlighted]:before:content-[' '] data-[highlighted]:before:-z-[1] data-[highlighted]:before:absolute data-[highlighted]:before:inset-0 data-[highlighted]:before:rounded-lg data-[highlighted]:before:bg-bg-200","data-[highlighted]:active:before:!bg-bg-300","[&[data-popup-open]:not([data-highlighted])]:before:content-[' '] [&[data-popup-open]:not([data-highlighted])]:before:-z-[1] [&[data-popup-open]:not([data-highlighted])]:before:absolute [&[data-popup-open]:not([data-highlighted])]:before:inset-0 [&[data-popup-open]:not([data-highlighted])]:before:rounded-lg [&[data-popup-open]:not([data-highlighted])]:before:bg-bg-100"],eZ=e=>{if("separator"===e.type){let{className:t,...a}=e;return(0,s.jsx)(eY.w,{className:(0,f.A)("h-[0.5px] bg-border-300 my-1.5 mx-2",t),...a})}if("loading"===e.type)return(0,s.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1.5 min-h-8",children:[(0,s.jsx)(eG.j,{width:20,height:20,rounded:"md"}),(0,s.jsx)(eG.j,{width:96,height:16,rounded:"md"})]});if("search-input"===e.type)return(0,s.jsx)(e$,{...e});let{tooltip:t,...a}=e;return t?(0,s.jsx)(ew.m,{tooltipContent:t,children:(0,s.jsx)(e$,{...a})}):(0,s.jsx)(e$,{...a})},e$=e=>{switch(e.type){case"button":{let{className:t,icon:a,label:n,subtitle:l,suffix:i,onAction:r,...o}=e;return(0,s.jsxs)(eH.D,{...o,onClick:r,className:(0,f.A)(eX,t),children:[(0,s.jsx)(eQ,{icon:a,label:n,subtitle:l}),(0,s.jsx)(e0,{suffix:i})]})}case"checkbox":{let{className:t,icon:a,label:n,subtitle:l,suffix:i,onAction:r,...o}=e;return(0,s.jsxs)(eK.s,{...o,onClick:r,className:(0,f.A)(eX,"data-[checked]:text-accent-secondary-100 transition-colors","data-[checked]:data-[highlighted]:before:!bg-accent-secondary-100/10","data-[checked]:data-[highlighted]:active:before:!bg-accent-secondary-100/20",t),children:[(0,s.jsx)(eQ,{icon:a,label:n,subtitle:l}),i?(0,s.jsx)(e0,{suffix:i}):(0,s.jsx)(eV.F,{className:"ml-auto size-4 flex items-center justify-center",children:(0,s.jsx)(em.Jlk,{})})]})}case"toggle":{let{icon:t,label:a,subtitle:n,suffix:l,onAction:i,checked:r,disabled:o,...d}=e;return(0,s.jsxs)(eH.D,{...d,onClick:i,className:(0,f.A)(eX),disabled:o,children:[(0,s.jsx)(eQ,{icon:t,label:a,subtitle:n}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[l&&(0,s.jsx)("div",{children:l}),(0,s.jsx)(eq,{onClick:()=>null==i?void 0:i(),checked:r,disabled:o})]})]})}case"submenu":{let{align:t="end",alignOffset:a=-8,sideOffset:n=-2,open:l,onOpenChange:i,openOnHover:r,className:o,icon:d,label:c,subtitle:u,suffix:m,items:x,...p}=e;return(0,s.jsxs)(eW.h,{open:l,onOpenChange:i,openOnHover:r,children:[(0,s.jsxs)(eB.f,{...p,className:(0,f.A)(eX,o),children:[(0,s.jsx)(eQ,{icon:d,label:c,subtitle:u}),(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,s.jsx)(e0,{suffix:m}),(0,s.jsx)("div",{className:"size-3",children:(0,s.jsx)(em.K3R,{className:"text-text-500",size:12})})]})]}),(0,s.jsx)(eU,{align:t,alignOffset:a,sideOffset:n,className:"max-h-[324px]",children:(0,s.jsx)(eP._,{className:"outline-none",children:x.map((e,t)=>{let a="search-input"===e.type?"search-input-".concat(t):"label"in e?"".concat(e.label,"-").concat(t):t;return(0,s.jsx)(eZ,{...e},a)})})})]})}case"search-input":{let{placeholder:t,value:a,onChange:n,onPaste:l,onKeyDown:i,errorMessage:r,inputRef:o,autoFocus:d}=e;return(0,s.jsxs)("div",{className:"mb-1.5 sticky -top-1.5 z-10 bg-bg-000 -mx-1.5 px-1.5 -mt-1.5 pt-1.5",onKeyDown:e=>{["ArrowDown","ArrowUp","Enter","Escape"].includes(e.key)||e.stopPropagation()},children:[(0,s.jsx)("div",{className:(0,f.A)(eX,"cursor-text"),children:(0,s.jsxs)("div",{className:"flex gap-2 truncate items-center flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"size-5 flex items-center justify-center",children:(0,s.jsx)(em.vji,{size:16,className:"text-text-500"})}),(0,s.jsx)("input",{ref:o,value:a,placeholder:t,className:"w-full bg-transparent border-none text-sm !py-0 !px-0 !h-auto !min-h-0 hide-focus-ring outline-none focus:outline-none focus-visible:outline-none placeholder:text-text-500 ml-0.5",onChange:e=>n(e.target.value),onPasteCapture:l,onKeyDown:i,"data-1p-ignore":!0,autoComplete:"off",autoFocus:d})]})}),r&&(0,s.jsx)("p",{className:"text-xs text-danger-000 mt-1 px-2 pb-2",children:r}),(0,s.jsx)("div",{className:"h-[0.5px] bg-border-300 mt-1.5",style:{marginLeft:8,marginRight:8}})]})}}},eQ=e=>{let{icon:t,label:a,subtitle:n}=e;return(0,s.jsxs)("div",{className:(0,f.A)("flex gap-2 truncate",n?"items-start":"items-center"),children:[void 0!==t&&(0,s.jsx)("div",{className:"size-5 flex items-center justify-center",children:t}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0 flex-1",children:[(0,s.jsx)("div",{className:"truncate",children:a}),n&&(0,s.jsx)("div",{className:"font-small text-text-500 truncate",children:n})]})]})},e0=e=>{let{suffix:t}=e;return t?(0,s.jsx)("div",{className:"min-w-0 truncate flex items-center",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:t}):null};var e1=a(0x17774dcd8),e2=a(0x4d348f95),e5=a(0x17b66474f),e8=a(0xf8bd7957),e3=a(0x1611828d),e4=a(0x8475f78a);let e6=ep.YO(ep.Yj()),e9=(e,t)=>{if(0===t.length)return!1;try{let a=new URL(e).hostname;return t.some(e=>a.includes(e))}catch(e){return!1}};var e7=a(0x116e76ca8);let te=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,G.A)();return(0,d.useMemo)(()=>({disabled:!0,tooltip:t.formatMessage({defaultMessage:"Select a different model to use this feature",id:"/9vSDy2Wm0"}),...e}),[t,e])},tt=e=>{let{text:t,className:a,showOnHover:n=!1}=e;return t?(0,s.jsx)("span",{className:(0,f.A)("flex-initial text-right shrink text-ellipsis break-words whitespace-nowrap min-w-0 overflow-hidden font-small text-text-500 !leading-4",n&&"opacity-0 group-hover:opacity-100 transition-opacity",a),children:t}):null};var ta=a(0x21fb79560),ts=a(0x115b4e1b8);let tn=(0,s.jsx)(e7.ft,{size:16}),tl=(0,s.jsx)(e7.HI,{size:16}),ti=(0,s.jsx)(e7.kw,{size:16}),tr="inputMenu",to=e=>{let{overrideCopy:t}=e,a=(0,G.A)();return(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-accent-secondary-100 font-small",children:t||a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"})})},td=(0,s.jsx)(em.Nw1,{}),tc=(0,s.jsx)(em.wB_,{}),tu=function(){let{includeConnectedOnly:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,G.A)(),a=(0,e2.useRouter)(),{connectedSearchOptions:n,disconnectedSearchOptions:l}=(()=>{let{model:e}=(0,W.TQ)(),{conversation:t}=(0,W.lE)(),a=(0,en.Z3)((null==t?void 0:t.id)||null),n=null!=e?e:a,l=(0,e1.lS)(),i=(e=>{let{currentModel:t}=e,a=(0,G.A)(),n=(0,e2.useRouter)(),{conversation:l}=(0,W.lE)(),i=(0,e1.Ob)(),{toggleSearchTool:r,toggleConversationSetting:o}=(0,ts.D$)(l),d=(0,$.K6)(),c=(0,eu.Wq)()(t,"gsuite_tools"),u=(0,$.$f)(l),{isDriveAuthenticated:m,initDriveAuth:x}=(0,$.cI)({callerIdentifier:tr,handleAuthSuccess:()=>{o("enabled_bananagrams",!0)}}),f=(0,ee.kO)(),p=(0,ee.dJ)(q.v8.GDRIVE),{startAuth:h,authBreakdown:g}=(0,ee.ob)(q.v8.GDRIVE,{callerIdentifier:tr,handleAuthSuccess:()=>{o("enabled_foccacia",!0)}}),b=te();if(f&&p&&m||f&&!p||p&&!g.firstParty||!d&&!i)return null;let v={icon:tn,label:a.formatMessage({defaultMessage:"{drive} search",id:"nUykp097rV"},{drive:"Drive"})};if(!d&&i)return{item:{...v,type:"button",suffix:(0,s.jsx)(ta.M,{}),onAction:()=>{n.push("/upgrade")}},isConnected:!1};if(!m){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{isConnected:!1,item:{...v,type:"button",suffix:(0,s.jsx)(to,{overrideCopy:f?t:e}),onAction:()=>x(),...f?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...c?null:b}}}let y=m&&u;return{isConnected:!0,item:{...v,type:"toggle",checked:y,onAction:()=>{r("enabled_bananagrams",!y)},closeOnClick:!1,...c?null:b}}})({currentModel:n}),r=(e=>{let{currentModel:t}=e,a=(0,G.A)(),n=(0,e2.useRouter)(),{setGmailAuthModalIsOpen:l}=(0,e5.CH)(),{conversation:i}=(0,W.lE)(),r=(0,e1.Ob)(),{toggleSearchTool:o,toggleConversationSetting:c}=(0,ts.D$)(i),u=(0,ee.Ys)(q.v8.GMAIL),m=(0,eu.Wq)()(t,"gsuite_tools"),x=(0,ee.X0)(q.v8.GMAIL,i),f=te(),p=(0,ee.vm)(),h=(0,ee.dJ)(q.v8.GMAIL),{isAuthenticated:g,startAuth:b,authBreakdown:v}=(0,ee.ob)(q.v8.GMAIL,{callerIdentifier:tr,handleAuthSuccess:()=>{c("enabled_sourdough",!0)}}),y=(0,d.useCallback)(()=>{l(!0)},[l]);if(p&&h&&g||p&&!h||p&&!v.firstParty||!u&&!r)return null;let j=a.formatMessage({defaultMessage:"Gmail search",id:"v0qteoUCm+"}),w=a.formatMessage({defaultMessage:"Gmail",id:"2hslSeuDXe"}),M={label:p?w:j,icon:ti};if(!u&&r)return{item:{...M,type:"button",suffix:(0,s.jsx)(ta.M,{}),onAction:()=>{n.push("/upgrade")}},isConnected:!1};if(!g){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{isConnected:!1,item:{...M,type:"button",suffix:(0,s.jsx)(to,{overrideCopy:p?t:e}),onAction:()=>{p?b():y()},...p?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...m?null:f}}}let k=g&&x;return{isConnected:!0,item:{...M,type:"toggle",checked:k,onAction:()=>{o("enabled_sourdough",!k)},closeOnClick:!1,...m?null:f}}})({currentModel:n}),o=(e=>{let{currentModel:t}=e,a=(0,G.A)(),n=(0,e2.useRouter)(),{conversation:l}=(0,W.lE)(),i=(0,e1.Ob)(),{toggleSearchTool:r,toggleConversationSetting:o}=(0,ts.D$)(l),d=(0,ee.Ys)(q.v8.GCAL),c=(0,eu.Wq)()(t,"gsuite_tools"),u=(0,ee.X0)(q.v8.GCAL,l),m=(0,ee.vm)(),x=(0,ee.dJ)(q.v8.GCAL),{isAuthenticated:f,startAuth:p,authBreakdown:h}=(0,ee.ob)(q.v8.GCAL,{callerIdentifier:tr,handleAuthSuccess:()=>{o("enabled_foccacia",!0)}}),g=te();if(m&&x&&f||m&&!x||m&&!h.firstParty||!d&&!i)return null;let b=a.formatMessage({defaultMessage:"Calendar search",id:"b7aUhdL5nd"}),v=a.formatMessage({defaultMessage:"Google Calendar",id:"kjenxGoM59"}),y={label:m?v:b,icon:tl};if(!d&&i)return{item:{...y,type:"button",suffix:(0,s.jsx)(ta.M,{}),onAction:()=>{n.push("/upgrade")}},isConnected:!1};if(!f){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{isConnected:!1,item:{...y,type:"button",suffix:(0,s.jsx)(to,{overrideCopy:m?t:e}),onAction:()=>p(),...m?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...c?null:g}}}let j=f&&u;return{isConnected:!0,item:{...y,type:"toggle",checked:j,onAction:()=>{r("enabled_foccacia",!j)},closeOnClick:!1,...c?null:g}}})({currentModel:n});return(0,d.useMemo)(()=>{if(l)return{connectedSearchOptions:[],disconnectedSearchOptions:[]};let e=[],t=[];return i&&(i.isConnected?e.push(i.item):t.push(i.item)),o&&(o.isConnected?e.push(o.item):t.push(o.item)),r&&(r.isConnected?e.push(r.item):t.push(r.item)),{connectedSearchOptions:e,disconnectedSearchOptions:t}},[i,o,r,l])})(),{connectedServers:r,connectingCount:o}=(()=>{var e;let t=(0,G.A)(),{conversation:a}=(0,w.oM)(),n=!!((null==a?void 0:a.sessionId)&&(null==a?void 0:a.isSessionActivelyWorking)),l=(0,e3.mL)(),r=(0,m.T9)("yukon_gold_bad","hostnames",[],e6),{account:o}=(0,i.YL)(),c=(0,v.vP)("enabled_mcp_tools"),u=null==o||null==(e=o.settings)?void 0:e.enabled_mcp_tools,x=(0,d.useMemo)(()=>(null==a?void 0:a.sessionId)?null!=u?u:{}:null!=c?c:{},[null==a?void 0:a.sessionId,u,c]),f=(0,es.Uz)(),{toggleMcpToolEnabled:p}=(0,Q.es)(),h=(0,d.useRef)(null);null===h.current&&(h.current=(0,e4.U6)());let g=h.current;return(0,d.useMemo)(()=>{let e=[],a=0;for(let o of f){var i;if(o.isConnecting){let e=g[o.uuid];(!e||e.isConnected)&&a++;continue}if(!o.isConnected)continue;let d=o.tools.map(e=>e.enabledKey),c=d.some(e=>!1!==x[e]),u=l&&e9(null!=(i=o.url)?i:"",r);e.push({type:"button",label:o.name,icon:(0,s.jsx)(e8.z,{size:16,type:o.iconType,src:o.iconSrc,name:o.name}),disabled:n,tooltip:n?t.formatMessage({defaultMessage:"Cannot modify connectors while message is processing",id:"dU4vArW8eq"}):u?t.formatMessage({defaultMessage:"This connector has known issues",id:"tI3ocabFQo"}):void 0,suffix:u?(0,s.jsx)(em.N5l,{size:14,className:"text-warning-100"}):(0,s.jsx)(eq,{onClick:e=>{e.stopPropagation(),n||p(d,!c,o.url)},checked:c,disabled:n}),onAction:()=>{n||p(d,!c,o.url)},closeOnClick:!1})}return{connectedServers:e,connectingCount:a}},[f,x,n,t,p,l,r,g])})(),c=(0,d.useCallback)(()=>{a.push("/settings/connectors")},[a]);return{items:(0,d.useMemo)(()=>{let a={type:"button",icon:tc,label:t.formatMessage({defaultMessage:"Manage connectors",id:"cqx+RdJnHp"}),onAction:c},s=n.length>0||r.length>0,i=o>0&&!s?[{type:"loading"}]:[],d=l.length>0,u=o>0;return e?[...n,...r]:[...n,...r,...i,...s&&d?[{type:"separator",label:"separator-connectors-0"}]:[],...l,...s||d||u?[{type:"separator",label:"separator-connectors-1"}]:[],a]},[e,t,c,n,r,o,l]),connectedServerCount:r.length,connectingCount:o,connectedSearchCount:n.length}};var tm=a(0xe0c26d90);let tx=(0,s.jsx)(e7.A9,{type:q.v8.GITHUB,size:20}),tf=(0,s.jsx)(e7.A9,{type:q.v8.GDRIVE,size:16}),tp=(0,s.jsx)(e7.A9,{type:q.v8.GDRIVE,variant:e7.UF.DOCS,size:16});var th=a(0x19f7d0900),tg=a(0x21d170f9);let tb=(0,s.jsx)(tg.LE,{});var tv=a(0x1d302b010);let ty=(0,s.jsx)(em.ryu,{size:16}),tj=(0,s.jsx)(em.ZHH,{size:16});var tw=a(0xbebfc702),tM=a(0x945c7f20),tk=a(0x1214e4a54);let t_=(0,s.jsx)(em.JtL,{}),tA=(0,s.jsx)(em.OMN,{}),tC=()=>{let e=(0,G.A)(),t=(0,W.QN)(),a=(0,tM.K)(),{data:s=[]}=(0,tw.CB)({enabled:a,creatorFilter:"is_creator",limit:8}),{data:n=[]}=(0,tw.CB)({enabled:a,creatorFilter:"is_not_creator",limit:8}),l=(0,d.useMemo)(()=>[...s,...n],[s,n]),i=tN(),{setCreateProjectModalIsOpen:r}=(0,e5.CH)();return(0,d.useMemo)(()=>{if(!a)return[];let s=(null==l?void 0:l.slice(0,8).map(e=>({type:"checkbox",label:e.name,subtitle:e.creator.full_name,onAction:()=>void i(e.uuid,e.name),icon:t_,checked:e.uuid===t,closeOnClick:!0})))||[],n={type:"button",icon:tA,label:e.formatMessage({defaultMessage:"Start a new project",id:"0y7bg6nA29"}),onAction:()=>r({isOpen:!0,moveAttachments:!1})};return[...s,...s.length>0?[{type:"separator",label:"projects-separator"}]:[],n]},[a,l,e,t,i,r])},tN=()=>{let{projectUuid:e,conversation:t}=(0,W.lE)(),a=(0,W.EL)(),{moveToProject:s}=(0,tk.j)(),{removeFromProject:n}=(0,tw.nl)();return(0,d.useCallback)(async(l,i)=>{e===l?(null==t?void 0:t.id)?await n([t.id],{showSuccess:!1}):a(void 0):(null==t?void 0:t.id)&&l?await s([t.id],l,i,{enableNavigation:!0}):a(l)},[null==t?void 0:t.id,s,e,n,a])},tS=(0,s.jsx)(em.isz,{size:20}),tE=()=>{let{conversation:e}=(0,W.lE)(),{model:t}=(0,W.TQ)(),a=(0,v.vP)("compass_mode"),s=(0,eA.g7)(),n=(0,eA.BU)(),l=null!=e?e:void 0,i=(0,eA.Gm)(l),r=(0,en.Z3)((null==e?void 0:e.id)||null),o=(0,eA.G8)()(null!=t?t:r),d=(0,eA.G8)()(r),{canAutoEnableWebSearch:c}=(0,ts.D$)(l),u=(0,e1.lS)(),m=!e&&!o&&d,x=!1,f=!1;return u?x=!0:n&&(i||c)?o||m||(f=!0):x=!0,{checked:"advanced"===a,disabled:x,isModelIncompatible:f,shouldHide:!s,switchToDefaultModelUponEnabling:m,isSessionsChatActive:u,searchToolsAllowed:n,searchToolsEnabled:i,canAutoEnableWebSearch:c}},tI=e=>{let{initialValue:t,switchToDefaultModelUponEnabling:a,isModelIncompatible:s}=e,{conversation:n}=(0,W.lE)(),{setModel:l}=(0,W.TQ)(),i=(0,en.Z3)((null==n?void 0:n.id)||null),r=null!=n?n:void 0,{toggleResearchMode:o}=(0,ts.D$)(r);return(0,d.useCallback)(()=>{s||(a&&l(i),o(!t))},[t,i,l,a,o,s])},tT=()=>{let e=(0,G.A)(),t=te({checked:!1}),{checked:a,disabled:s,isModelIncompatible:n,shouldHide:l,switchToDefaultModelUponEnabling:i,isSessionsChatActive:r,searchToolsAllowed:o,searchToolsEnabled:c,canAutoEnableWebSearch:u}=tE(),m=tI({initialValue:a,switchToDefaultModelUponEnabling:i,isModelIncompatible:n}),x=(0,d.useMemo)(()=>r?e.formatMessage({defaultMessage:"Coming soon",id:"e61Jf3TcmS"}):o?c||u?void 0:e.formatMessage({defaultMessage:"Enable a search integration to use research",id:"WyiVeak7w5"}):e.formatMessage({defaultMessage:"Your administrator must enable a search tool to use research",id:"CzjOV5rgPZ"}),[u,e,r,o,c]);return(0,d.useMemo)(()=>l?null:{type:"checkbox",label:e.formatMessage({defaultMessage:"Research",id:"JEe7dVso7F"}),icon:tS,checked:a,disabled:s,tooltip:x,onAction:m,closeOnClick:!0,...n?{...t,checked:!1}:{}},[l,e,a,s,x,m,n,t])};var tR=a(0x252daebb2),tD=a(0x1e61aab5a),tO=a(0x1fb2770f2),tP=a(0x6b95b9a1);let tL=(0,s.jsx)(em.P_O,{}),tF=(0,s.jsx)(em.OMN,{}),tz=()=>{let e=(0,G.A)(),t=(()=>{let e=(0,G.A)(),t=(0,ed.st)(),{personalizedStyle:a,setPersonalizedStyle:s}=(0,W.RK)(),{personalizedStyleOptions:n,setStoredStyle:l}=(0,tO.p)(),{setStyleModalOpenWithScreen:i}=(0,e5.CH)(),r=(0,d.useCallback)(e=>{let a=n.find(t=>t.key===e);if(!a)return;s(a);let i=(0,tP.X)(a);l({styleKey:i,timestamp:new Date}),t.track({event_key:"styles.selected",style_key:i})},[t,n,s,l]),o=(0,d.useCallback)(()=>{i(tD.I.LIST)},[i]),c=(0,d.useMemo)(()=>n.map(t=>{let s=(null==a?void 0:a.key)===t.key;return{type:"checkbox",label:"default"===t.type&&t.nameKey?(0,tR.fl)({id:t.nameKey,intl:e}):t.name,icon:tL,onAction:()=>{s?r("Default"):r(t.key)},checked:s,closeOnClick:!0}}),[r,e,a,n]);return(0,d.useMemo)(()=>[...c,{type:"separator",label:"styles-separator"},{type:"button",icon:tF,label:e.formatMessage({defaultMessage:"Create & edit styles",id:"cY+Fgc8HvE"}),onAction:o}],[e,o,c])})(),a=e.formatMessage({defaultMessage:"Use style",id:"f7VY0ldE+0"});return(0,d.useMemo)(()=>({type:"submenu",icon:tL,label:a,items:t}),[a,t])};var tU=a(0x1e9786782),tG=a(0x654fb8f7);let tY=(0,s.jsx)(em.o3O,{}),tH=e=>{let t=(0,G.A)(),a=(0,d.useCallback)(()=>(0,tG.U)(e),[e]),{shortcutString:n}=(0,ei.wk)("file_upload"),l=(0,tU.w)(n);return(0,d.useMemo)(()=>({type:"button",label:t.formatMessage({defaultMessage:"Add files or photos",id:"0S+iNJivmx"}),icon:tY,onAction:a,suffix:(0,s.jsx)(tt,{text:l,showOnHover:!0})}),[t,a,l])};var tK=a(0x3769f4df);let tV=(0,s.jsx)(em.qzq,{}),tW=()=>{let e,t,a=(0,G.A)(),n=te(),{checked:l,disabled:i,isModelIncompatible:r,shouldShowUpsell:o,isEnabledForOrg:c,shouldHide:u}=(()=>{let{conversation:e}=(0,W.lE)(),t=(0,tK.fy)(e),{model:a}=(0,W.TQ)(),s=(0,en.Z3)((null==e?void 0:e.id)||null),n=(0,tK.Eu)(null!=a?a:s),l=(0,e1.Ob)(),i=(0,tK.be)(),r=(0,tK.WJ)(),o=!i&&l,d=t&&n,c=!1,u=!1;return o?d=!1:r?n||(u=!0):c=!0,{checked:d,disabled:c,isModelIncompatible:u,shouldShowUpsell:o,isEnabledForOrg:r,shouldHide:!i&&!l}})(),m=(e=>{let{checked:t,shouldShowUpsell:a}=e,s=(0,e2.useRouter)(),{conversation:n}=(0,W.lE)(),{toggleSearchTool:l}=(0,ts.D$)(n);return(0,d.useCallback)(()=>{if(a)return s.push("/upgrade");l("enabled_web_search",!t)},[t,s,a,l])})({checked:l,shouldShowUpsell:o});return o?t=(0,s.jsx)(ta.M,{}):c||(e=a.formatMessage({defaultMessage:"This feature has been disabled by your administrator.",id:"Jpvq2WYysx"})),(0,d.useMemo)(()=>u?null:{type:"checkbox",label:a.formatMessage({defaultMessage:"Web search",id:"x0W7xxxEcv"}),icon:tV,checked:l,disabled:i,onAction:m,tooltip:e,suffix:t,closeOnClick:!0,...r?n:{}},[u,a,l,i,m,e,t,r,n])},tB=e=>{let{trigger:t,chatInputPlacement:a}=e,n=(0,d.useCallback)((e,a)=>t||(0,s.jsx)(tq,{...e}),[t]);return(0,s.jsxs)(eD.i,{children:[(0,s.jsx)(eO.c,{render:n}),(0,s.jsx)(eU,{align:"start",alignOffset:-10,side:"bottom",sideOffset:4,children:(0,s.jsxs)(eP._,{className:"outline-none",children:[(0,s.jsx)(eL.J,{}),(0,s.jsx)(tJ,{chatInputPlacement:a})]})})]})},tJ=e=>{let{chatInputPlacement:t}=e,a=(e=>{let{placement:t}=e,a=(0,e1.lS)(),n=tH(t),l=(()=>{let e=(0,G.A)(),t=(()=>{let{addError:e}=(0,r.Y)(),{setIsUploadingDriveSync:t}=(0,W.fT)(),{setSyncSourceUuids:a}=(0,W.lE)(),{mutate:s}=(0,g.EF)({onMutate:()=>{t(!0)},onSuccess:e=>{t(!1),a(t=>[...t,e.uuid])},onError:a=>{t(!1),e((0,ea.J)(a),{error:a,errorContext:{tags:{source:"chat_input_drive_sync_create"}}})},meta:{noToast:!0}});return e=>s({sync_source_type:q.v8.GDRIVE,sync_source_config:{uri:e}})})(),a=(0,$.LP)(),{isDriveAuthenticated:s}=(0,$.cI)(),{recentDriveDocs:n,isLoading:l}=(0,$.zH)(!0),i=(0,d.useMemo)(()=>({icon:tf,label:e.formatMessage({defaultMessage:"Add from {drive}",id:"hwJ50OkM/9"},{drive:"Google Drive"})}),[e]),o=(0,d.useMemo)(()=>l?[{type:"button",label:e.formatMessage({defaultMessage:"{drive} documents loading...",id:"PjuSZ/7RIb"},{drive:"Drive"}),disabled:!0}]:n.length?n.slice(0,8).map(e=>{var a;return{type:"button",label:null!=(a=e.title)?a:"Untitled",icon:tp,onAction:()=>t(e.uri)}}):[{type:"button",label:e.formatMessage({defaultMessage:"No recent {drive} documents",id:"XepM9W1Mo/"},{drive:"Drive"}),disabled:!0}],[t,e,l,n]);return(0,d.useMemo)(()=>a&&s?{...i,type:"submenu",items:o,align:"start"}:null,[i,s,a,o])})(),i=(0,ee.kO)(),o=(()=>{let e=(0,G.A)(),t=(0,tm.Cq)(),{isGithubAuthenticated:a}=(0,tm.nB)({fetchImmediately:!0}),{setGithubModalIsOpen:s}=(0,e5.CH)(),n=(0,d.useCallback)(()=>{s(!0)},[s]);return(0,d.useMemo)(()=>t&&a?{type:"button",icon:tx,label:e.formatMessage({defaultMessage:"Add from {github}",id:"h3J3E4bRfj"},{github:"GitHub"}),onAction:n}:null,[e,a,n,t])})(),c=(()=>{let e=(0,G.A)(),t=(0,es.Uz)(),a=(0,d.useRef)(null);null===a.current&&(a.current=(0,e4.U6)());let{connectedServers:n,placeholderConnectors:l}=(0,d.useMemo)(()=>{var e;let s=null!=(e=a.current)?e:{};return{connectedServers:t.filter(e=>e.isConnected&&(e=>{var t,a;return((null==(t=e.prompts)?void 0:t.length)||0)>0||((null==(a=e.resources)?void 0:a.length)||0)>0})(e)),placeholderConnectors:t.filter(e=>{var t,a;return e.isConnecting&&(null==(t=s[e.uuid])?void 0:t.isConnected)&&(null==(a=s[e.uuid])?void 0:a.hasPromptsOrResources)})}},[t]),i=(0,tv.R4)(),r=(0,tv.vW)(),{setCreatePromptArgumentModalIsOpen:o}=(0,e5.CH)(),[c,u]=(0,d.useState)({}),m=(0,d.useRef)({}),x=(0,d.useRef)({}),f=(0,d.useCallback)((e,t)=>{o({isOpen:!0,serverUuid:e,prompt:t})},[o]),p=(0,d.useCallback)((e,t)=>{u(a=>({...a,[e]:t}))},[]),h=(0,d.useCallback)((e,t,a)=>{let s=c[e]||"";if("ArrowLeft"===t.key&&s)t.stopPropagation();else if("ArrowDown"===t.key&&a){var n;t.preventDefault(),t.stopPropagation(),null==(n=x.current[e])||n.focus()}},[c]);return(0,d.useMemo)(()=>[...n.map(t=>{let a=c[t.uuid]||"",n=t.resources.length>0,l=t.prompts.filter(e=>{var t,s;if(!a)return!0;let n=a.toLowerCase(),l=(null==(t=e.name)?void 0:t.toLowerCase())||"",i=(null==(s=e.description)?void 0:s.toLowerCase())||"";return l.includes(n)||i.includes(n)}),o=l.map(e=>({type:"button",icon:ty,label:e.displayName,onAction:()=>{var a;return(null==(a=e.arguments)?void 0:a.length)?f(t.uuid,e):void r({serverUuid:t.uuid,prompt:e,args:{}})}})),d=n?t.resources.filter(e=>{var t,s,n;if(!a)return!0;let l=a.toLowerCase(),i=(null==(t=e.name)?void 0:t.toLowerCase())||"",r=(null==(s=e.description)?void 0:s.toLowerCase())||"",o=(null==(n=e.uri)?void 0:n.toLowerCase())||"";return i.includes(l)||r.includes(l)||o.includes(l)}):[],u=d.map((e,a)=>({type:"button",icon:tj,label:e.displayName,onAction:()=>void i({serverUuid:t.uuid,resource:e}),ref:0===a?e=>{x.current[t.uuid]=e}:void 0,onKeyDown:e=>{if("ArrowUp"===e.key&&0===a){var s;e.preventDefault(),null==(s=m.current[t.uuid])||s.focus()}}})),g=[];if(n){var b;g.push({type:"search-input",placeholder:e.formatMessage({defaultMessage:"Search...",id:"0BUTMvePvK"}),label:e.formatMessage({defaultMessage:"Search",id:"xmcVZ0BU63"}),value:a,onChange:e=>p(t.uuid,e),onKeyDown:e=>h(t.uuid,e,d.length>0||l.length>0),inputRef:{current:null!=(b=m.current[t.uuid])?b:null},autoFocus:!0})}return g.push(...o),n&&(d.length>0?g.push(...u):a&&0===l.length&&g.push({type:"button",label:e.formatMessage({defaultMessage:"No results",id:"jHJmjfxD4s"}),disabled:!0})),{type:"submenu",label:e.formatMessage({defaultMessage:"Add from {server}",id:"qEj6u51OfR"},{server:t.name}),icon:(0,s.jsx)("div",{className:"flex justify-center items-center size-5",children:(0,s.jsx)(e8.z,{size:16,type:t.iconType,src:t.iconSrc,name:t.name})}),items:g,align:"start"}}),...l.map(t=>({type:"submenu",label:e.formatMessage({defaultMessage:"Add from {server}",id:"qEj6u51OfR"},{server:t.name}),icon:(0,s.jsx)("div",{className:"flex justify-center items-center size-5",children:(0,s.jsx)(e8.z,{size:16,type:t.iconType,src:t.iconSrc,name:t.name})}),items:[{type:"loading"}],align:"start"}))].sort((e,t)=>{var a,s;return(null!=(a=e.label)?a:"").localeCompare(null!=(s=t.label)?s:"")}),[r,i,n,h,p,e,f,l,c])})(),u=(()=>{let{haystackProject:e,checked:t,shouldHide:a,disabled:s}=(()=>{let{haystackProject:e}=(0,eR.Sc)(),t=(0,W.QN)(),a=(0,eR.C0)(),s=(0,eR.sZ)(),n=(0,eR._Y)(),l=t===(null==e?void 0:e.uuid);return{haystackProject:e,checked:l,shouldHide:!s||!e||!a,disabled:n}})(),n=(0,th.$V)(),l=(0,eR.Af)(),i=(0,d.useCallback)(()=>{e&&n(e.uuid)},[e,n]);return(0,d.useMemo)(()=>a?null:{type:"checkbox",label:l,icon:tb,checked:t,onAction:i,disabled:s,closeOnClick:!0},[a,t,s,l,i])})(),m=tT(),x=tW(),f=(()=>{let e=(0,es.Q1)(),{items:t,connectedServerCount:a,connectingCount:s,connectedSearchCount:n}=tu(),l=e&&!(a>0||s>0||n>0),i=n>0||a>0||s>0,{setMcpDirectoryModalIsOpen:r}=(0,e5.tl)(),o=(0,G.A)(),c=(0,d.useCallback)(()=>{r(!0)},[r]);return(0,d.useMemo)(()=>l?{type:"loading"}:i?{type:"submenu",label:o.formatMessage({defaultMessage:"Connectors",id:"2mMJRvsAg1"}),icon:td,items:t}:{type:"button",label:o.formatMessage({defaultMessage:"Add connectors",id:"2dXigF1Pil"}),icon:td,onAction:c},[l,i,o,c,t])})(),p=(()=>{let e=(0,G.A)(),{isProjectLocked:t}=(0,W.Jy)(e=>({isProjectLocked:e.isProjectLocked})),a=(0,tM.K)(),s=(()=>{let e=(0,e2.usePathname)();return"string"==typeof e&&e.startsWith("/project/")})(),n=tC(),l=e.formatMessage({defaultMessage:"Add to project",id:"+mqxxzVczn"});return(0,d.useMemo)(()=>t||!a||s?null:{type:"submenu",icon:t_,label:l,items:n},[t,a,s,l,n])})(),h=tz();return(0,d.useMemo)(()=>{let e=f?[f]:[],t=[...p?[p]:[],...l&&!i?[l]:[],...o?[o]:[],...c.length>0?c:[],{type:"separator",label:"separator-1"},...u?[u]:[],...m?[m]:[],...x?[x]:[],...h?[h]:[]];return a?[n,...e]:[n,...t,...e]},[n,p,l,o,c,u,m,x,f,h,i,a])})({placement:t});return(0,s.jsx)(s.Fragment,{children:a.map((e,t)=>{let a="search-input"===e.type?"search-input-".concat(t):"label"in e?"".concat(e.label,"-").concat(t):t;return(0,s.jsx)(eZ,{...e},a)})})},tq=e=>{let t=(0,G.A)();return(0,s.jsx)(eo.$,{...e,"aria-label":t.formatMessage({defaultMessage:"Toggle menu",id:"NuF5YcKWhi"}),className:"!rounded-lg hover:!bg-bg-200 aria-expanded:!bg-bg-300 active:!scale-100 ml-[2px]",size:"icon_sm",variant:"ghost",children:(0,s.jsx)(em.OMN,{})})};var tX=a(0x14023fbb8),tZ=a(0x8774d407),t$=a(0x1396b7e40);let tQ=e=>{let{onClick:t,indicatorActive:a,disabled:n,...l}=e;return!a||n?null:(0,s.jsx)(t$.O,{onClick:t,indicatorActive:a,disabled:n,showRemoveIcon:!0,...l})},t0=(0,s.jsx)(em.dcV,{}),t1=(0,s.jsx)(em.isz,{size:20}),t2=(0,s.jsx)(em.JtL,{}),t5=(0,s.jsx)(tg.LE,{}),t8=(0,s.jsx)(em.P_O,{}),t3=e=>{let{hideIndicators:t}=e,a=(0,M.c)();return t?null:(0,s.jsx)(tZ.o,{children:(0,s.jsx)("div",{className:(0,f.A)("flex flex-row items-center min-w-0",a?"gap-1":"gap-2"),children:(0,s.jsxs)(p.N,{children:[(0,s.jsx)(t4,{},"research"),(0,s.jsx)(t6,{},"project"),(0,s.jsx)(t9,{},"style")]})})})},t4=()=>{let e=(0,G.A)(),t=(0,M.c)(),{checked:a,disabled:n,shouldHide:l,switchToDefaultModelUponEnabling:i,isModelIncompatible:r}=tE(),o=tI({initialValue:a,switchToDefaultModelUponEnabling:i,isModelIncompatible:r});return l?null:(0,s.jsx)(tQ,{indicatorActive:a,disabled:n,onClick:o,icon:t?t1:t0,tooltip:e.formatMessage({defaultMessage:"Research mode",id:"lYf0AUt2RH"}),hideIndicatorText:!0,layoutId:"research-indicator"})},t6=()=>{let e=(0,W.QN)(),{conversation:t}=(0,W.lE)(),a=(0,W.EL)(),{removeFromProject:n,isRemovingConversation:l}=(0,tw.nl)(),{data:i}=(0,tw.fo)(e),r=(0,eR.Lq)(),o=(0,eR.sZ)(),d=(0,e2.usePathname)().includes("/project/"),c=(0,eR._Y)();if(d)return null;let u=!o||!r||!c,m=null!=t&&!!t.id&&l(t.id),x=async()=>{e&&!m&&u&&((null==t?void 0:t.id)?await n([t.id]).catch(()=>{}):a(void 0))};return o&&c?(0,s.jsx)(t$.O,{indicatorActive:!0,showRemoveIcon:u,disabled:!0,hideIndicatorText:!0,icon:t5,tooltip:null==i?void 0:i.name,layoutId:"project-indicator"}):(0,s.jsx)(tQ,{indicatorActive:!!e,hideIndicatorText:!0,icon:m?(0,s.jsx)(tX.R,{size:"sm",inheritColor:!0}):o&&r?t5:t2,showRemoveIcon:u,onClick:x,disabled:m,tooltip:null==i?void 0:i.name,layoutId:"project-indicator"})},t9=()=>{let{personalizedStyle:e,setPersonalizedStyle:t}=(0,W.RK)(),{defaultStyle:a,personalizedStyleOptions:n,clearStoredStyle:l}=(0,tO.p)(),i=!!(e&&e.key!==(null==a?void 0:a.key));return(0,s.jsx)(tQ,{indicatorActive:i,hideIndicatorText:!0,icon:t8,onClick:()=>{let e=n.find(e=>"Default"===e.key)||a;e&&t(e),l()},tooltip:null==e?void 0:e.name,layoutId:"style-indicator"})};var t7=a(0x17f3a2521),ae=a(0x175a3352c);let at=e=>{let{menuItem:t,handleClick:a,limitInfo:n,disabled:l,...i}=e,{handleClickItem:r}=(0,e5.CH)();if(!t||t.isDisabled||"pro"===t.tag||"new chat"===t.tag||!t.indicatorActive)return null;let{indicatorActive:o}=t,d=l||!!t.menuItemHidden,c=n?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[i.icon,(0,s.jsx)(ae.J,{remaining:n.remaining,total:n.total})]}):i.icon;return(0,s.jsx)(t$.O,{onClick:null!=a?a:()=>r(t),indicatorActive:o,disabled:d,showRemoveIcon:!0,...i,icon:c})},aa=e=>{let{hideIndicatorText:t,hideIndicators:a}=e,n=(0,G.A)();return a?null:(0,s.jsx)(tZ.o,{children:(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0",children:[(0,s.jsx)(as,{itemKey:t7.xd.COMPASS,tooltip:n.formatMessage({defaultMessage:"Research mode",id:"lYf0AUt2RH"})}),(0,s.jsx)(an,{hideIndicatorText:t}),(0,s.jsx)(al,{hideIndicatorText:t})]})})},as=e=>{let{itemKey:t,tooltip:a}=e,{menuView:{rootItems:n}}=(0,e5.CH)(),{menuView:{rootItems:l}}=(0,e5.tl)(),i=[...n,...l].find(e=>e.key===t);return i?(0,s.jsx)(at,{hideIndicatorText:!0,menuItem:i,icon:i.icon,tooltip:a}):null},an=e=>{let{hideIndicatorText:t}=e,{menuView:{rootItems:a}}=(0,e5.tl)(),n=(0,th.pi)(),l=a.find(e=>"styles"===e.key);return l&&"optionGroup"===l.type?(0,s.jsx)(at,{hideIndicatorText:t,menuItem:l,icon:(0,s.jsx)(em.P_O,{size:16}),text:l.secondaryText,buttonClassName:"!shrink",handleClick:()=>n("Default")}):null},al=e=>{let{hideIndicatorText:t}=e,{menuView:{rootItems:a}}=(0,e5.CH)(),n=(0,W.QN)(),{conversation:l,setProjectUuid:i,isProjectLocked:r,isNewConversation:o}=(0,w.oM)(),{removeFromProject:d,isRemovingConversation:c}=(0,tw.nl)(),u=a.find(e=>e.key===t7.xd.PROJECTS);if(!u||"optionGroup"!==u.type||r&&o)return null;let m=null!=l&&!!l.id&&c(l.id),x=async()=>{n&&!m&&((null==l?void 0:l.id)?await d([l.id]):i(void 0))};return(0,s.jsx)(at,{"data-testid":"projects-indicator",hideIndicatorText:t,menuItem:u,icon:m?(0,s.jsx)(tX.R,{size:"sm",inheritColor:!0}):(0,s.jsx)(em.JtL,{size:16}),text:u.secondaryText,buttonClassName:"!shrink-[2]",handleClick:()=>x(),disabled:m})},ai=e=>{let{style:t,children:a,duration:n=200,delay:l=0,easing:i="ease-in-out",className:r="",onTransitionEnd:o=()=>void 0}=e,c=(0,d.useRef)(null),[u,m]=(0,d.useState)("auto"),x=(0,d.useRef)(null);return(0,d.useEffect)(()=>{if(c.current)return x.current=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect.height;m("".concat(e,"px"))}}),x.current.observe(c.current),()=>{x.current&&x.current.disconnect()}},[]),(0,s.jsx)("div",{style:{height:u,transitionDelay:"".concat(l,"ms"),transitionTimingFunction:i,transitionDuration:"".concat(n,"ms"),transitionProperty:"height",...t},className:r,onTransitionEnd:()=>{o()},children:(0,s.jsx)("div",{className:"w-full",ref:c,children:a})})};var ar=a(0x31075f4f),ao=a(0x5a5d1f8b),ad=a(0x12d9a90e8),ac=a(0xd236a749),au=a(0x1f4f9b2db),am=a(0xfce0e9a4),ax=a(0x1e6127894);let af=e=>{let{path:t}=e,a={drive:(0,G.A)().formatMessage({defaultMessage:"Paste a Drive link in the chat to upload it",id:"ZJxjEilF0C"})},n=t&&t in a?a[t]:null;return n?(0,s.jsxs)("div",{className:"w-full bg-bg-100 border-t-0.5 border-border-300 opacity-80 text-text-500 flex flex-row items-center gap-2.5 px-3 py-1 font-small",children:[(0,s.jsx)(ax.R,{size:14}),n]}):null};var ap=a(0x1d1a079e9),ah=a(0x17ced59d0),ag=a(0x88148a10),ab=a(0xbd872f26);let av=e=>{let{tooltip:t,text:a,tag:n,showCaretIcon:l,indicatorActive:i=!1,hideIndicatorText:r,canShowDot:o,onDoubleClick:c,menuType:u,menuView:m,inputMenuIsOpen:x,setInputMenuIsOpen:f,disabled:p,disabledTooltip:g}=e,b=(0,G.A)(),v=(0,d.useRef)(null),{rootItems:y}=m,j={indicatorActive:i,text:a||"",tooltip:t},w=(0,e1.gB)(),M="tools"===u&&w;if(p&&g)j.tooltip=g;else if(M){j.tooltip=b.formatMessage({defaultMessage:"Style",id:"7mL9QEUFav"});let e=y.find(e=>"option"===e.type&&e.isChecked);e&&"Default"!==e.key&&(j.indicatorActive=!0,j.text=e.label)}let k=y.filter(e=>{let{indicatorActive:t}=e;return t}).length,_=(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center gap-1",children:["plus"===u?(0,s.jsx)(h.P.div,{animate:{rotate:45*!!x},transition:{type:"spring",stiffness:650,damping:32,duration:.1},children:(0,s.jsx)(ag.F,{size:16})}):"research"===u?(0,s.jsx)(em.isz,{size:16}):M?(0,s.jsx)(em.P_O,{size:16}):(0,s.jsx)(ab.l,{size:16}),(0,s.jsx)(ay,{isShown:o&&k>0})]}),A="plus"===u?b.formatMessage({defaultMessage:"attachments",id:"whkEDsy4V6",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"}):"research"===u?b.formatMessage({defaultMessage:"research",id:"PUcnDUZD0/",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"}):M?b.formatMessage({defaultMessage:"styles",id:"G91kUvt+GD",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"}):b.formatMessage({defaultMessage:"tools",id:"yd3KUET1r+",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"});return(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(t$.O,{disabled:p,tag:n,showCaretIcon:l,hideIndicatorText:!!r,icon:_,id:"input-".concat(u,"-menu-trigger"),ref:v,onClick:()=>{f(!x)},onKeyDown:e=>{x||"Space"!==e.code&&"ArrowDown"!==e.code||f(!0)},onDoubleClick:c?e=>{e.preventDefault(),null==c||c()}:void 0,"aria-expanded":x,"aria-haspopup":"listbox","aria-controls":"input-menu","data-testid":"input-menu-".concat(u),"aria-label":b.formatMessage({defaultMessage:"Open {menuType} menu",id:"Larie1pvYJ"},{menuType:A}),...j})})},ay=e=>{let{isShown:t}=e;return!!t&&(0,s.jsx)(h.P.div,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},children:(0,s.jsx)("div",{className:"h-1.5 w-1.5 bg-accent-secondary-200 rounded-full mr-0.5"})})};var aj=a(0x1ddbde9f);let aw={forward:{initial:{x:"20%",opacity:0},animate:{x:0,opacity:1}},back:{initial:{x:"-20%",opacity:0},animate:{x:0,opacity:1}},none:{initial:{x:0},animate:{x:0}}},aM=e=>{let{placement:t,canShowDot:a}=e,n=(0,d.useRef)(null),l=(0,G.A)(),i=(0,e5.tl)(),r=(0,Q.AY)(),o=(0,Q.M8)(),c=(0,eA.g7)(),u=(0,m.fS)("claudeai_research_button_moved_nux_enabled");return(0,s.jsxs)("div",{ref:n,children:[(0,s.jsx)(aA,{canShowDot:a,placement:t,menuType:"tools",...i,tooltip:l.formatMessage({defaultMessage:"Search and tools",id:"lhFEU+uT6i"})}),(0,s.jsx)(ad.NewFeatureNuxPopover,{canShowNux:o,anchorRef:n,side:"bottom",text:l.formatMessage({defaultMessage:"Add your everyday tools and apps to get the best out of Claude",id:"olaMSdwPL6"}),id:"research-rmcp-tools-nux-1",nuxItem:{dateAdded:"2025-05-14",priority:au.c.HIGH,showAfterOthersDismiss:!0}}),(0,s.jsx)(ad.NewFeatureNuxPopover,{canShowNux:r,anchorRef:n,side:"bottom",text:l.formatMessage({defaultMessage:"MCP is here now! Access integrations in this menu.",id:"NkJar0wFk+"}),id:"mcp-tools-nux-1",nuxItem:{dateAdded:"2025-04-29",priority:au.c.HIGH,showAfterOthersDismiss:!0}}),(0,s.jsx)(ad.NewFeatureNuxPopover,{canShowNux:u&&c,anchorRef:n,side:"bottom",align:"start",text:l.formatMessage({defaultMessage:"Research moved to a new spot",id:"8jLw1VEgKA"}),id:"research-moved-nux",nuxItem:{dateAdded:"2025-10-02",priority:au.c.MEDIUM,showAfterOthersDismiss:!1}})]})},ak=e=>{let{placement:t,canShowDot:a}=e,n=(0,e5.CH)(),l=(0,e1.lS)();return(0,s.jsx)(aA,{placement:t,menuType:"plus",canShowDot:a,disabled:l,disabledTooltip:l?"Coming soon":void 0,...n})},a_={id:"mcp-add-connectors-nux",nuxItem:{dateAdded:"2025-07-11",priority:au.c.HIGH,showAfterOthersDismiss:!0}},aA=e=>{let{text:t,tag:a,showCaretIcon:n,indicatorActive:l,canShowDot:i,hideIndicatorText:r,tooltip:o,placement:c,menuType:u,path:m,menuView:x,highlightedItemKey:g,setHighlightedItemKey:b,handleClickItem:v,inputMenuIsOpen:y,setInputMenuIsOpen:j,inputMenuSearchQuery:w,setInputMenuSearchQuery:M,handleBack:k,animationDirection:_,disabled:A,disabledTooltip:C}=e,{currentItems:N}=x,S=(0,ao.L)(()=>{j(!1)},["mouseup","touchend"]),E=(0,d.useRef)(null),I=(0,d.useRef)(null),T=(0,d.useRef)(null),R=(0,d.useRef)(null),[D,O]=(0,d.useState)(void 0),[P,L]=(0,d.useState)("bottom"===c?"top":"bottom"),[F,z]=(0,d.useState)(0),U=(0,e2.useSearchParams)(),{shouldShow:G}=(0,am.z)(a_.id,a_.nuxItem),Y="true"===U.get(ac.HU)&&G&&"tools"===u;(0,d.useEffect)(()=>{Y&&(j(!0),T.current&&(T.current.scrollTop=T.current.scrollHeight))},[Y,j]),(0,d.useEffect)(()=>{if(!E.current||!I.current)return;let e=E.current.getBoundingClientRect(),{updatedHeightAvailable:t,updatedDropdownSide:a}=aC({placement:c,triggerRectTop:e.top,triggerRectBottom:e.bottom});O(Math.min(422,t)),L(a);let s=I.current.getBoundingClientRect();z(Math.min(0,window.innerWidth-s.right-8))},[c,y]);let H=(0,e1.Hd)(),K=("plus"===u||"tools"===u)&&H?(0,s.jsx)(ah.s,{path:m,inputMenuSearchQuery:w,setInputMenuSearchQuery:M,handleBack:k}):null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative shrink-0",onClick:e=>{e.preventDefault()},ref:S,children:[(0,s.jsx)("div",{ref:E,children:(0,s.jsx)(av,{disabled:A,disabledTooltip:C,tag:a,tooltip:o,text:t,showCaretIcon:n,indicatorActive:l,hideIndicatorText:r,canShowDot:i,menuType:u,menuView:x,inputMenuIsOpen:y,setInputMenuIsOpen:j,onDoubleClick:"plus"===u?()=>(0,th.U_)(c):void 0})}),(0,s.jsx)("div",{ref:I,className:(0,f.A)("w-[20rem] absolute max-w-[calc(100vw-16px)]","top"===P?"bottom-10":"top-10",y?"block":"hidden"),children:(0,s.jsx)(p.N,{children:y&&(0,s.jsx)(h.P.div,{ref:T,initial:{opacity:0,scale:.95,y:"top"===P?8:-8,x:-8},animate:{opacity:1,scale:1,y:0,x:0},exit:{opacity:0,scale:.95,y:"top"===P?8:-8,x:-8},transition:{type:"spring",stiffness:650,damping:23,mass:.6,height:{ease:"easeInOut"}},className:(0,f.A)("relative w-full will-change-transform h-auto overflow-y-auto overscroll-auto flex z-dropdown bg-bg-000 rounded-2xl overflow-hidden border-border-300 border-0.5 shadow-diffused shadow-[hsl(var(--always-black)/6%)]","top"===P?"flex-col-reverse":"flex-col"),onMouseEnter:()=>b(null),style:{maxHeight:D?"".concat(D,"px"):void 0,left:F},onClick:e=>{e.stopPropagation(),(0,aj.l)()},children:(0,s.jsxs)(ai,{duration:100,className:(0,f.A)("flex flex-col min-h-0 w-full !ease-out","top"===P?"justify-end":"justify-start"),children:[(0,s.jsxs)("div",{className:"p-1.5 flex flex-col",children:["bottom"===P&&K,(0,s.jsx)(h.P.div,{variants:aw[_],initial:"initial",animate:"animate",className:"flex flex-col",transition:{x:{duration:.15,ease:ar.A.outCirc},opacity:{duration:.25,ease:"easeInOut"}},children:("top"===P?[...N].reverse():N).filter(e=>{let{menuItemHidden:t}=e;return!t}).map(e=>"addIntegrations"===e.key?(0,s.jsx)("div",{ref:R,children:(0,s.jsx)(ap.$,{item:e,onClick:()=>v(e),isHighlighted:g===e.key})},e.key):(0,s.jsx)(ap.$,{item:e,onClick:()=>v(e),isHighlighted:g===e.key},e.key))},null!=m?m:"root"),"top"===P&&K]}),(0,s.jsx)(af,{path:m})]})})})})]}),(0,s.jsx)(ad.NewFeatureNuxPopover,{canShowNux:Y&&!!R.current&&y,anchorRef:R,side:"right",text:(0,s.jsx)(X.A,{defaultMessage:"Find and add more of your favorite tools in <span>Add connectors</span>.",id:"2icgWBPsqj",values:{span:e=>(0,s.jsx)("span",{className:"font-bold",children:e})}}),...a_})]})},aC=e=>{let{placement:t,triggerRectTop:a,triggerRectBottom:s}=e,n=window.innerHeight-s-8-8;if("bottom"===t){let e=a-76-8;return e<160&&n>e?{updatedDropdownSide:"bottom",updatedHeightAvailable:n}:{updatedDropdownSide:"top",updatedHeightAvailable:e}}{let e=a-8-8;return n<160&&e>n?{updatedDropdownSide:"top",updatedHeightAvailable:e}:{updatedDropdownSide:"bottom",updatedHeightAvailable:n}}};a(0x459cd8f0);let aN=ep.Ik({enabled:ep.zM(),system_prompt:ep.Yj().optional()}),aS=e=>{let t,{model:a,hideIndicatorText:n}=e,l=(0,G.A)(),{toggleConversationSetting:r}=(0,v.rX)({source:"extendedThinkingButton"}),o=(0,v.vP)("paprika_mode"),c=(0,eg.j)()(a),u=(0,i.h0)(),m=(0,T.useLayer)("trials_freemium"),{data:x}=(0,eh.EY)(),f=(0,e1.lS)(),p=(0,W.QN)(),h=(0,eR.sZ)(),{haystackProject:g}=(0,eR.Sc)(),b=(0,eR.Af)(),y=h&&!!g&&p===(null==g?void 0:g.uuid);(0,d.useEffect)(()=>{!o&&c&&y&&r("paprika_mode","extended")},[o,c,y,r]);let j=!u,w=m.get("free_thinking",!1);if(j&&w&&(null==x?void 0:x.remaining)===0||f)return null;let M=j&&w&&x&&void 0!==x.remaining&&void 0!==x.limit&&!!o;c?y&&(t=l.formatMessage({defaultMessage:"{haystackProjectDisplayName} requires extended thinking to coordinate your connected tools",id:"yx2ockglUA"},{haystackProjectDisplayName:b})):t=l.formatMessage({defaultMessage:"Select a different model to use this feature",id:"/9vSDy2Wm0"});let k=f||!!t;return(0,s.jsx)(t$.O,{disabled:k,tooltip:t||l.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),tooltipShortcut:k?void 0:"Cmd+Shift+E",hideIndicatorText:n,icon:(0,s.jsx)(em.Sw4,{size:16}),onClick:()=>{k||r("paprika_mode",o?null:"extended")},indicatorActive:!k&&!!o||f||y,text:l.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),limitInfo:M?{remaining:x.remaining,total:x.limit}:null,className:"!shrink-0"})},aE=e=>{let{placement:t,isDisabled:a,skipInitialAnimation:n=!1}=e,l=(0,G.A)();(0,m.iW)("prompt_improver_config",{enabled:!1},aN);let i=(0,M.c)(),r=(0,eu.A9)(),o=(0,W.N3)(),c=(0,W.QN)(),{attachments:u,files:x,syncSourceUuids:p}=(0,W.Jy)(e=>({attachments:e.attachments,files:e.files,syncSourceUuids:e.syncSourceUuids})),{model:h,setModel:g,sendMessage:b,stopSampling:v,conversation:y,isSending:j,isChatSyncing:k,isProjectSyncing:_,isModelSelectorOpen:A,setIsModelSelectorOpen:C,isNewConversation:N,currentCompassTask:S,improvePrompt:E,isImprovingPrompt:I}=(0,w.oM)(),T=(0,en.Z3)((null==y?void 0:y.id)||null),R=null!=h?h:T,D=k||_?l.formatMessage({defaultMessage:"Syncing knowledge...",id:"QuwefnZNVj"}):void 0,O=(0,d.useMemo)(()=>{var e;return[...x,...null!=(e=null==y?void 0:y.files)?e:[]].some(e=>e.file_kind===ex.M.Image||e.file_kind===ex.M.SanitizedDocument)},[x,y]),P=(0,d.useCallback)(e=>g(e.model),[g]),[L,F]=(0,ef.w)({box:"border-box"}),z=F.width||null,U=null===z||z<396;(0,ec.QJ)();let Y=(0,e1.nb)(),H=(0,eR.sZ)(),K=(0,eR._Y)();return(0,s.jsxs)("div",{className:"flex gap-2 w-full items-center",ref:L,children:[(0,s.jsxs)("div",{className:(0,f.A)("relative flex-1 flex items-center shrink min-w-0",i?"gap-1":"gap-2"),children:[i?H&&K?null:(0,s.jsx)(tB,{chatInputPlacement:t}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ak,{placement:t,canShowDot:null!==z&&U}),(0,s.jsx)(aM,{placement:t,canShowDot:null!==z&&U})]}),"",(0,s.jsx)(aS,{model:R,hideIndicatorText:!0}),"",null!==z&&(i?(0,s.jsx)(t3,{hideIndicators:U}):(0,s.jsx)(aa,{hideIndicatorText:null===z||z<480,hideIndicators:U})),(0,s.jsx)(ev,{model:h,projectUuid:c})]}),(0,s.jsx)(ey.B,{selectedModel:h,onSelect:P,hasMultiModalContent:O,placement:t,open:A,onOpenChange:C,isNewConversation:N,modelsConfig:r}),(0,s.jsx)(eS,{isSending:j,isDisabled:a,disabledReason:D,isPromptEmpty:o,files:x,attachments:u,syncSourceUuids:p,conversation:y,currentCompassTask:S,onSend:()=>b(),onStop:()=>v(),skipInitialAnimation:n,canQueueMessages:Y})]})};var aI=a(0x1f57763bb),aT=a(0x1d32cfbe5),aR=a(0x4376af8f),aD=a(0x15068fa65);let aO=e=>{let{disabled:t=!1,enableScreenDrop:a=!1}=e,{onDrop:n}=(0,w.oM)();return(0,s.jsx)(aT.wC,{disabled:t,onDrop:n,enableScreenDrop:a,children:a?(0,s.jsx)(aL,{}):(0,s.jsx)(aP,{})})},aP=()=>{let{dragState:e}=(0,aT.t1)(),t=e===aT.mq.DRAGGING_ON_TARGET,a=e===aT.mq.DRAGGING_OFF_TARGET||e===aT.mq.DRAGGING_ON_TARGET;return a?(0,s.jsx)(p.N,{children:a&&(0,s.jsx)(h.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"absolute top-0 border border-dashed bg-clip-padding rounded-2xl min-h-4 h-full w-full border-accent-secondary-100 bg-bg-000 overflow-hidden z-10",children:(0,s.jsx)("div",{className:(0,f.A)("flex items-center justify-center h-full w-full transition-colors",t?"bg-accent-secondary-900":"bg-accent-secondary-900/50"),children:(0,s.jsxs)("p",{className:"text-accent-secondary-100 flex flex-row items-center gap-2.5",children:[(0,s.jsx)(aR._,{size:20,className:"opacity-50"}),(0,s.jsx)(X.A,{defaultMessage:"Drop files here to add to chat",id:"IYBR/J+nuA"})]})})},"chat-input-drop-zone-overlay")}):null},aL=()=>{let{dragState:e}=(0,aT.t1)(),t=e===aT.mq.DRAGGING_OFF_TARGET||e===aT.mq.DRAGGING_ON_TARGET;return t?(0,aD.createPortal)((0,s.jsx)(p.N,{children:t&&(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"fixed inset-0 z-toast pointer-events-none",children:(0,s.jsx)("div",{className:"absolute inset-0 bg-bg-100/90 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 text-text-100",children:[(0,s.jsx)(aI.E8,{}),(0,s.jsx)(X.A,{defaultMessage:"Drop files here to add to chat",id:"IYBR/J+nuA"})]})})},"full-screen-drop-zone-overlay")}),document.body):null};var aF=a(0x12c9046cd),az=a(0x246846ae8),aU=a(0x23b9f35d7),aG=a.n(aU),aY=a(0x800328fa),aH=a(0x212aec62a);function aK(e){let{text:t,className:a}=e,[n,l]=(0,d.useState)(!1),i=(0,d.useRef)(null),r=(0,d.useRef)(0),[o,c]=(0,d.useState)(42),u=o>42;return((0,d.useLayoutEffect)(()=>{var e;c((null==(e=i.current)?void 0:e.scrollHeight)||0)},[t]),t)?(0,s.jsxs)("div",{className:(0,f.A)("overflow-hidden relative transition-[height] duration-150 ease-in-out","text-text-300 text-sm",a),style:{height:n?o+32*!!u:40},children:[(0,s.jsx)("div",{ref:i,className:"whitespace-pre-wrap",style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:t}),u&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-bg-100 bottom-0",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute top-0 bottom-0 -left-4 w-6 bg-gradient-to-r from-transparent to-bg-100"}),(0,s.jsx)(aY.Y,{onClick:()=>{var e;let t=null==(e=i.current)?void 0:e.closest(".overflow-y-auto");!n&&t?r.current=t.scrollTop:n&&t&&t.scrollTo({top:r.current,behavior:"instant"}),l(e=>!e)},className:"font-medium flex gap-1 items-center relative ",children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(aH.Z,{size:12,weight:"bold"}),(0,s.jsx)(X.A,{defaultMessage:"Less",id:"mFYgAXM/x4"})]}):(0,s.jsx)(X.A,{defaultMessage:"{ellipsis}More",id:"eRW5dl5m34",values:{ellipsis:"..."}})})]})})]}):null}function aV(e){var t,a;let{isOpen:n,onClose:l,prompt:i,serverUuid:r}=e,o=(0,G.A)(),c=(0,d.useCallback)(()=>{x({}),l()},[l]),u=(0,tv.vW)(c),[m,x]=(0,d.useState)({}),f=null==i||null==(t=i.arguments)?void 0:t.some(e=>!!(e.required&&!m[e.name]));return i?(0,s.jsxs)(eC.aF,{title:o.formatMessage({defaultMessage:"Enter prompt inputs",id:"zDs90mJ5UJ"}),subtitle:(0,s.jsxs)("div",{className:"flex flex-col gap-1 mt-1",children:[i.name,(0,s.jsx)(aK,{text:i.description})]}),isOpen:n,onClose:c,modalSize:"lg",children:[(0,s.jsx)("div",{className:"flex flex-col gap-4 max-h-[500px] mb-4 overflow-y-auto",children:null==(a=i.arguments)?void 0:a.map(e=>(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsx)(az.ks,{required:e.required,label:"".concat(aG()(e.name.toLowerCase())).concat(e.required?"*":""),placeholder:e.description,value:m[e.name]||"",onValueChange:t=>x(a=>({...a,[e.name]:null!=t?t:""})),onBlur:()=>{x(t=>{var a;return{...t,[e.name]:(null!=(a=t[e.name])?a:"").trim()}})},error:e.required&&""===m[e.name]},e.name)},e.name))}),(0,s.jsxs)(eC.vW,{children:[(0,s.jsx)(eo.$,{disabled:f,onClick:()=>void u({serverUuid:r,prompt:i,args:m}),children:(0,s.jsx)(X.A,{defaultMessage:"Add prompt",id:"8UhdEv01LN"})}),(0,s.jsx)(eo.$,{variant:"secondary",onClick:c,children:(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]}):null}var aW=a(0x1ab362a20),aB=a(0x1dbad8fd1),aJ=a(0x1bd42f6d2),aq=a(0x243c995f0),aX=a(0x6e0ffcda);let aZ=e=>{let{moveAttachments:t=!1,handleProjectCreated:a,isOpen:n,handleClose:l,syncSources:i=[],attachments:o=[],setSyncSourceUuids:c,setAttachments:u}=e,[m,x]=(0,d.useState)(null),{addError:f}=(0,r.Y)(),p=(0,aq.n)();return a$({project:m,syncSources:i,attachments:o,setSyncSourceUuids:c,setAttachments:u}),(0,s.jsxs)(eC.aF,{isOpen:n,onClose:l,modalSize:"xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h1",{className:"font-heading text-text-200 mb-4",children:t?(0,s.jsx)(X.A,{defaultMessage:"Create a project with attachments",id:"wSxz4Q9mjA"}):(0,s.jsx)(X.A,{defaultMessage:"Create a project",id:"HR5A+UPiIu"})}),(0,s.jsx)(eo.$,{onClick:l,size:"icon",variant:"ghost",children:(0,s.jsx)(aW.X,{size:16})})]}),n&&(0,s.jsx)(aX.Kk,{syncSources:t?i:void 0,onProjectCreated:e=>{t&&x(e),a(e)},onError:e=>f(e.message,{error:e,errorContext:{tags:{source:"create_project_modal"}}}),onCancel:l,strings:p})]})},a$=e=>{let{project:t,syncSources:a,attachments:s,setSyncSourceUuids:n,setAttachments:l}=e,i=(0,d.useRef)(!1),{addSuccess:o}=(0,r.Y)(),c=(0,G.A)(),{mutate:u}=(0,aB.fh)(null==t?void 0:t.uuid),{mutate:m}=(0,aJ.pz)(null==t?void 0:t.uuid),x=(0,d.useCallback)(()=>{t&&(s.length||a.length&&t.is_private)&&(s.forEach(e=>{let{file_name:t,extracted_content:a}=e;u({file_name:t,content:a})}),t.is_private&&(a.forEach(e=>{let t=(0,ee.tS)(e);t&&m(t)}),n([])),l([]),o(c.formatMessage({defaultMessage:"Attachments added to {projectName}",id:"dodZw3agKz"},{projectName:t.name||"your project"})))},[t,o,s,u,l,m,n,a,c]);(0,d.useEffect)(()=>{t&&!i.current&&(i.current=!0,x())},[t,x])};var aQ=a(0x761f2ec),a0=a(0xa1ce28b4),a1=a(0x141440998),a2=a(0xc9dabb82),a5=a(0x12bb05cb6),a8=a(0x1c6461a16),a3=a(0x20b796df9),a4=a(0x1a5c959ec),a6=a(0x5946b9a1),a9=a(0x10d0d913),a7=a(0x23506e4da),se=a(0x1016c6ed2),st=a(0x8c555bbe),sa=a(0xe885efe2);let ss=()=>{let{addError:e}=(0,r.Y)();return{handleRateLimitError:(t,a)=>{if(t instanceof se.LG&&429===t.statusCode){let a=null;if(t.message.includes("{"))try{a=JSON.parse(t.message)}catch(e){}(null==a?void 0:a.type)==="exceeded_limit"&&"concurrents"===a.representativeClaim?e("Looks like you have too many chats going. Please close a tab to continue.",{error:t}):"thinking_messages_rate_limit_exceeded"===t.errorCode?e("You’ve reached your weekly limit for thinking messages. Please try again next week.",{error:t}):"opus_messages_rate_limit_exceeded"===t.errorCode?(0,sa.T)():(e("You’ve reached the limit for Claude messages at this time. Please wait before trying again.",{error:t}),(0,st.D)())}else e(a,{error:t,errorContext:{tags:{source:"api_error_handler_default"}}})}}},sn=(0,a7.default)(()=>a.e(10320).then(a.bind(a,0xad3190)).then(e=>({default:e.WritingAnimation})),{loadableGenerated:{webpack:()=>[0xad3190]},ssr:!1}),sl={default:{type:"spring",stiffness:650,damping:60},opacity:{type:"tween",ease:"easeOut",duration:.35}},si=(0,d.forwardRef)((e,t)=>{let{setScreen:a,onStyleChange:n,animateBoolRef:l}=e,o=(0,G.A)(),c=(0,ed.st)(),[u,m]=(0,d.useState)(!1),[x,f]=(0,d.useState)(""),{handleRateLimitError:g}=ss(),{mutateAsync:b}=(0,a2.f$)(),v=(0,d.useRef)(null),y=(0,d.useRef)(null);(0,d.useEffect)(()=>{u&&setTimeout(()=>{var e;return null==(e=y.current)?void 0:e.focus()},50)},[u]);let[j,w]=(0,d.useState)(!1),[M,k]=(0,d.useState)(!1),_=(0,d.useRef)(null),A=(0,d.useRef)(null),C=4e3,{handleFileUpload:N,handleTextUpload:S}=function(e){let[t,a]=(0,d.useState)(!1),{activeOrganization:s}=(0,i.YL)(),{addError:n}=(0,r.Y)(),l=(0,aF.mn)();return{handleFileUpload:async i=>{if(t||!s)return;if(a(!0),!(0,J.eT)(i))try{let t=await (0,J.F9)(i);await e(t),a(!1);return}catch(e){}let r=new FormData;r.append("file",i);try{let t=await l("/api/organizations/".concat(s.uuid,"/convert_document"),{method:"POST",body:r});if(!t.ok)throw Error("Document conversion failed");let a=await t.json();if(!(null==a?void 0:a.extracted_content))throw Error("Document conversion failed: No extracted content");await e(a.extracted_content)}catch(e){n(e instanceof Error?e.message:"Error uploading file",{error:e,errorContext:{tags:{source:"example_upload_document_conversion"}}})}finally{a(!1)}},handleTextUpload:async n=>{!t&&s&&0!==n.trim().length&&(a(!0),await e(n),a(!1))},isUploading:t}}(async e=>{try{_.current=await b({content_example:e})}catch(e){g(e,o.formatMessage({defaultMessage:"Failed to create style. Please try again.",id:"GF2W10J5zb"})),w(!1)}}),E=()=>{_.current?n(_.current,!0):A.current=setTimeout(E,C=1e3)},I=async()=>{D(),await S(x)},T=async e=>{let t=Array.from(e.dataTransfer.files);t&&(k(!0),setTimeout(D,20),await N(t[0]))},R=async e=>{let t=e.target.files;t&&(D(),await N(Array.from(t)[0])),e.target.value=""},D=()=>{w(!0),A.current=setTimeout(E,C)};return(0,s.jsx)(h.P.div,{ref:t,className:"w-full h-full grid place-items-center",exit:{opacity:0,scale:.8},transition:l.current?sl:{duration:0},children:(0,s.jsxs)(p.N,{mode:"popLayout",children:[j&&(0,s.jsx)(h.P.div,{className:"w-full h-full grid place-items-center",initial:{opacity:0},animate:{opacity:1},transition:sl,children:(0,s.jsx)(so,{})},"CreateStyleAnalyzingContentScreen"),!j&&(0,s.jsxs)(h.P.div,{className:"w-full h-full pt-1 flex flex-col sm:grid sm:grid-cols-2 sm:gap-4",children:[(0,s.jsxs)(h.P.div,{exit:{opacity:0,y:40,transition:sl},className:"sm:h-full text-center flex flex-col gap-2 items-center justify-center px-2 pt-8 pb-8 sm:pt-14 sm:pb-20",children:[(0,s.jsx)("div",{className:"relative pb-2 w-full flex items-center justify-center",children:(0,s.jsx)(sn,{})}),(0,s.jsx)("p",{className:"text-text-300 font-claude-response sm:text-lg",children:(0,s.jsx)(X.A,{defaultMessage:"Share a writing example or describe your style and Claude will make a custom writing style tailored just for you.",id:"2qm6Zfzfx3"})})]},"CreatStyleStartScreenExplainer"),(0,s.jsx)(h.P.div,{className:"h-full flex-1",exit:{opacity:0,x:0,scale:.8,transition:{basicTransition:sl}},children:u?(0,s.jsxs)("div",{className:"h-full flex flex-col gap-2 p-2 rounded-xl border-0.5 border-border-300",children:[(0,s.jsx)("textarea",{ref:y,className:" flex-1 min-h-0 bg-bg-000 border border-border-200 p-3 leading-5 rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:o.formatMessage({defaultMessage:"Paste at least a few paragraphs of example writing, including from multiple various sources if you’d like, for Claude to analyze and the match style of...",id:"mC+9IzmmMY"}),value:x,onChange:e=>f(e.target.value),required:!0}),(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(eo.$,{variant:"secondary",onClick:()=>m(!1),children:(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(eo.$,{onClick:I,children:(0,s.jsx)(X.A,{defaultMessage:"Create style",id:"OC52fhpn7g"})})]})]}):(0,s.jsxs)(aT.wC,{className:"w-full h-full text-center border-dashed border border-border-300 bg-bg-000 rounded-xl relative grid place-items-center",onDrop:T,children:[(0,s.jsx)(sr,{showDropCover:M},"DropZoneOverlay"),(0,s.jsx)("input",{ref:v,type:"file",className:"hidden",accept:(0,J.cm)({imagesEnabled:!1}).join(","),onChange:R,multiple:!0}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(a5.ms,{trigger:(0,s.jsx)(eo.$,{variant:"claude",className:"mt-2 font-medium !text-accent-secondary-100 bg-accent-secondary-900 hover:!bg-accent-secondary-100/15 gap-2",prepend:(0,s.jsx)(a8.C,{weight:"bold"}),children:(0,s.jsx)(X.A,{defaultMessage:"Add writing example",id:"EhXT0lXWRc"})}),children:[(0,s.jsx)(a5.tJ,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",onClick:()=>{v.current&&v.current.click()},children:[(0,s.jsx)(a3.x,{size:16}),(0,s.jsx)(X.A,{defaultMessage:"Upload from device",id:"vMaZk5Jcnv"})]})}),(0,s.jsx)(a5.tJ,{onClick:()=>m(!0),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a4.v,{size:16}),(0,s.jsx)(X.A,{defaultMessage:"Paste text content",id:"nVQ9XcjUIh"})]})})]}),(0,s.jsxs)("div",{className:"text-xs text-text-400 mt-3 flex flex-col gap-1 max-sm:pb-8",children:[(0,s.jsx)("p",{children:window.innerWidth<=640?(0,s.jsx)(X.A,{defaultMessage:"Select or paste existing doc, post, message, etc.",id:"7oFd31Vmu3"}):(0,s.jsx)(X.A,{defaultMessage:"Select, drop, or paste existing doc, post, message, etc.",id:"ugXnNZ7Ix/"})}),(0,s.jsx)("p",{children:(0,s.jsx)(X.A,{defaultMessage:"Content is not stored after matching style.",id:"bLEGIyr72h"})})]})]}),(0,s.jsx)("div",{className:"absolute w-full bottom-6",children:(0,s.jsxs)(aY.Y,{className:"text-sm gap-1.5",onClick:()=>{c.track({event_key:"styles.custom.describe_clicked"}),a(tD.I.CREATE_MANUALLY)},children:[(0,s.jsx)(a6.u,{}),(0,s.jsx)(X.A,{defaultMessage:"Describe style instead",id:"p6hP+KeXkD"})]})})]})},"CreatStyleStartScreenDropZone")]},"CreatStyleStartScreen")]})})});si.displayName="CreateStyle";let sr=e=>{let{showDropCover:t}=e,{dragState:a}=(0,aT.t1)(),n=a===aT.mq.DRAGGING_OFF_TARGET||a===aT.mq.DRAGGING_ON_TARGET||t;return(0,s.jsx)(p.N,{children:n&&(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:(0,f.A)("absolute -inset-px z-10 flex flex-col justify-center rounded-xl border border-dashed transition-colors",a===aT.mq.DRAGGING_ON_TARGET||t?"bg-accent-secondary-900 border-accent-secondary-200 text-accent-secondary-000":"bg-bg-100 border-border-200 text-text-300"),children:(0,s.jsxs)("div",{className:"py-1.5 text-center",children:[(0,s.jsx)("div",{className:"relative inline-block opacity-60",children:(0,s.jsx)(a9.p,{size:36,weight:"thin"})}),(0,s.jsx)("div",{className:"font-claude-response pt-2 pb-4 italic",children:(0,s.jsx)(X.A,{defaultMessage:"Drop example writing here to match the style",id:"VcDT1Dt8dq"})})]})},"drop-zone-overlay")})},so=()=>(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(sn,{animate:!0}),(0,s.jsx)(h.P.div,{className:"font-claude-response italic text-lg",initial:{opacity:0,y:-15},animate:{opacity:1,y:0},transition:{opacity:{delay:.2,ease:"easeOut",duraation:.6},y:{delay:.2,type:"spring",stiffness:230,damping:20}},children:(0,s.jsx)(X.A,{defaultMessage:"Analyzing your writing...",id:"AnDnGKCn6M"})})]});var sd=a(0x196d7ac18),sc=a(0x1a51aac29),su=a(0x18f9bc151),sm=a(0x185b2b1e7),sx=a(0x1b7480851);let sf={objective:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sd.W,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Define style objective",id:"gJB/90MGQ7"})]}),description:"Describe the main purpose and goal of this writing style — whether to teach, analyze, persuade, inspire, etc.",placeholder:"Try something like:\nI want to teach complex topics step-by-step, with a focus on building understanding.",promptPrepend:"I’d like the writing to serve this purpose:"},audience:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sx.t,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Tailor to an audience",id:"TYdBxyl/f3"})]}),description:"Describe details of the target audience you’d like Claude to write for including relevant information, needs, or preferences.",placeholder:"Try something like:\nWrite for marketing professionals. They’re tech-savvy and appreciate a dash of humor with their data.",promptPrepend:"I’d like to tailor this style to a specific audience:"},voicetone:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sc.r,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Use specific voice & tone",id:"1Vo908p7lJ"})]}),description:"Think about characteristics like formality, emotion, personality, and how you want the written responses to feel.",placeholder:"Try something like:\nWrite in a warm, approachable tone with light professional humor - like a friendly mentor.",promptPrepend:"I’d like to write in this voice and tone:"},general:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a6.u,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Describe generally",id:"f3JnPS+B3+"})]}),description:"Describe in detail how you would like Claude to write. Be as specific as you can.",placeholder:"Try something like:\nWrite like an excited scientist explaining fascinating discoveries - technical but energetic.",promptPrepend:"I’d like to write like this:"},custom:{label:(0,s.jsx)(X.A,{defaultMessage:"Use custom instructions (advanced)",id:"hSfu0Sz47T"}),description:"Write exact custom instructions for this style instead of generating a style prompt automatically. Claude will ignore instructions that don’t follow our guidelines.",placeholder:"Write style custom instructions here...",promptPrepend:""}},sp=(0,d.forwardRef)((e,t)=>{let{setScreen:a,onStyleChange:n}=e,l=(0,G.A)(),i=(0,ed.st)(),[r,o]=(0,d.useState)(!1),[c,u]=(0,d.useState)(""),[m,x]=(0,d.useState)(Object.keys(sf)[0]),{handleRateLimitError:g}=ss(),{mutateAsync:b}=(0,a2.f$)(),v=(0,d.useRef)(null);(0,d.useEffect)(()=>{setTimeout(()=>{var e;return null==(e=v.current)?void 0:e.focus()},50)},[m]);let y=c.replace(/\s/g,"").length>24,j=async()=>{if(!r&&y){o(!0);try{let e="custom"===m?{prompt:c}:{input_text:sf[m].promptPrepend+"\n"+c},t=await b(e);n(t,!1)}catch(e){g(e,l.formatMessage({defaultMessage:"Failed to create style. Please try again.",id:"GF2W10J5zb"}))}finally{o(!1)}}},w=e=>{i.track({event_key:"styles.custom.describe_selected",key:e}),x(e)};return(0,s.jsxs)(h.P.div,{ref:t,className:"w-full h-full flex flex-col sm:grid sm:grid-cols-2 gap-4 pt-3",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:h-full sm:pr-3",children:[(0,s.jsxs)("div",{className:"flex-1 text-text-300",children:[(0,s.jsx)("p",{className:"mb-1 sm:mb-2 text-sm font-medium",children:(0,s.jsx)(X.A,{defaultMessage:"Generate style from a starting point:",id:"cz09/5alWg"})}),(0,s.jsx)("ul",{className:"hidden sm:flex flex-col gap-1.5",children:Object.keys(sf).map(e=>(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:(0,f.A)("flex gap-1.5 items-center font-ui h-11 rounded-lg border border-border-400 hover:border-border-300 px-3 w-full text-left transition active:scale-[1.015] hover:bg-bg-200",m===e&&"!bg-accent-secondary-900 text-accent-secondary-000 !border-accent-secondary-100/80","custom"===e&&"mt-2 text-sm"),onClick:()=>w(e),children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-full bg-bg-100 grid place-items-center border border-border-300 mr-1",children:m===e&&(0,s.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-accent-secondary-100"})}),sf[e].label]})},e))}),(0,s.jsx)("div",{className:"sm:hidden",children:(0,s.jsx)(a5.ms,{trigger:(0,s.jsx)(eo.$,{variant:"ghost",append:(0,s.jsx)(su.a,{}),className:"w-full !border !border-border-300",children:(0,s.jsx)("div",{className:"flex-1 text-left flex items-center gap-1",children:sf[m].label})}),children:Object.keys(sf).map(e=>(0,s.jsx)(a5.tJ,{onSelect:()=>w(e),children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:sf[e].label})},e))})})]}),(0,s.jsx)("div",{className:"mb-4 max-sm:hidden",children:(0,s.jsxs)(aY.Y,{className:"text-sm gap-1",onClick:()=>a(tD.I.CREATE),children:[(0,s.jsx)(sm.f,{}),(0,s.jsx)(X.A,{defaultMessage:"Never mind, I’ll add an example",id:"PpPoeCEz4X"})]})})]}),(0,s.jsxs)("form",{className:"flex flex-col h-full rounded-xl border-0.5 border-border-300 bg-bg-200 px-3 py-2 gap-2",onSubmit:e=>{e.preventDefault(),j()},children:[(0,s.jsx)("p",{className:"pt-0 p-1 text-text-300 font-claude-response max-sm:text-sm",children:sf[m].description}),(0,s.jsxs)("div",{className:"relative flex-1 w-full",children:[(0,s.jsx)("textarea",{ref:v,className:" min-h-0 w-full h-full bg-bg-000 border border-border-200 p-3 leading-snug rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:sf[m].placeholder,value:c,required:!0,onChange:e=>u(e.target.value)}),(0,s.jsx)(p.N,{children:c.length>0&&!y&&(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeIn",duration:.1},className:"absolute bottom-1 right-1 left-1 py-2 px-2 rounded-md text-sm bg-accent-secondary-900 text-text-200 text-center",children:(0,s.jsx)(X.A,{defaultMessage:"Be as descriptive as possible to help Claude generate the best possible style for you",id:"3ObAHHjHgF"})})})]}),(0,s.jsx)(ew.m,{tooltipContent:y?"":l.formatMessage({defaultMessage:"More description needed in order to generate style",id:"vX4dBOsKs3"}),side:"bottom",className:"text-center",children:(0,s.jsx)("div",{className:"flex items-center w-full justify-center pb-1",children:(0,s.jsx)(eo.$,{className:"w-full",type:"submit",loading:r,disabled:!y,children:"custom"===m?(0,s.jsx)(X.A,{defaultMessage:"Create style",id:"OC52fhpn7g"}):(0,s.jsx)(X.A,{defaultMessage:"Generate style",id:"tILvvoBa87"})})})})]})]})});sp.displayName="CreateStyleManually";var sh=a(0xbca8e388),sg=a(0xc288ff4d),sb=a(0x1bcaab0),sv=a(0x1628a449c),sy=a(0x1676f5524),sj=a(0xe2832f83),sw=a(0x2ff0240b),sM=a(0x24e190c04),sk=a(0x72116fe6),s_=a(0x133b478a1),sA=a(0xb804d868);function sC(){let[e,t]=(0,sA.Vc)("userHiddenStyles",[]),a=(0,d.useCallback)(e=>{let a=(0,tP.X)(e);t(e=>[...e,a])},[t]),s=(0,d.useCallback)(()=>{t([])},[t]),n=(0,d.useCallback)(t=>t.filter(t=>{let a=(0,tP.X)(t);return!e.includes(a)}),[e]);return{hiddenPresetStyles:e,setHiddenPresetStyles:t,addHiddenPresetStyle:a,resetHiddenPresetStyles:s,filterHiddenStyles:n}}var sN=function(e){return e.VIEW="view",e.EDIT="edit",e.EDIT_MANUALLY="edit_manually",e}(sN||{});let sS=ep.YO(ep.Ik({key:ep.Yj(),name:ep.Yj(),nameKey:ep.Yj().optional(),text:ep.Yj(),textKey:ep.Yj().optional()})),sE=[],sI=e=>{let{isSaveButton:t,children:a}=e;return(0,s.jsx)("div",{className:(0,f.A)("flex gap-1.5",t?"sm:absolute sm:top-5 sm:right-16 max-sm:mt-3 max-sm:-mb-2":"absolute top-5 right-16"),children:a})},sT=(0,d.forwardRef)((e,t)=>{let{animateBoolRef:a,style:n,setCurrentStyle:l,returnToListScreen:i,setChatStyle:r,setIsEditing:o,setIsEditingName:c}=e,u=(0,G.A)(),m=(0,tP.X)(n),x="default"===n.type,[f,p]=(0,d.useState)("view"),{mutateAsync:g}=(0,a2.lo)(m,x),{handleRateLimitError:b}=ss(),v=async e=>{let{prompt:t,editInput:a}=e;try{let e=await g({prompt:t,edit_instructions:a});e&&l(e)}catch(e){throw b(e,u.formatMessage({defaultMessage:"Failed to edit style. Please try again.",id:"1WkY08RVLW"})),Error}},y=e=>{o("edit"===e||"edit_manually"===e),p(e)};return(0,s.jsxs)(h.P.div,{className:"flex-1 min-h-0 grid sm:grid-cols-2 gap-3 pt-3",ref:t,children:["view"===f&&(0,s.jsxs)(sI,{children:[(0,s.jsx)(eo.$,{variant:"secondary",className:"text-sm max-sm:hidden",onClick:()=>r(n),children:(0,s.jsx)(X.A,{defaultMessage:"Use style",id:"f7VY0ldE+0"})}),(0,s.jsx)(sL,{style:n,returnToListScreen:i,onRename:()=>c(!0),setStateToManualEdit:()=>y("edit_manually")})]}),(0,s.jsxs)(h.P.div,{className:"min-h-0",initial:!!a.current&&{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{scale:{type:"spring",stiffness:230,damping:15,delay:.1},opacity:{duration:.3,delay:.1}},children:["view"===f&&(0,s.jsx)(sO,{style:n,onClick:()=>y("edit")}),"edit"===f&&(0,s.jsx)(sR,{style:n,updateStyle:v,onClose:()=>y("view")}),"edit_manually"===f&&(0,s.jsx)(sD,{style:n,updateStyle:v,onClose:()=>y("view")})]}),(0,s.jsx)(sP,{style:n,animateBoolRef:a})]})});sT.displayName="EditStyle";let sR=e=>{let{style:t,updateStyle:a,onClose:n}=e,l=(0,G.A)(),i=(0,d.useRef)(t.prompt),r=(0,d.useRef)(null),[o,c]=(0,d.useState)(!1),[u,m]=(0,d.useState)(!1),[x,g]=(0,d.useState)([]),[b,v]=(0,d.useState)(""),y=async e=>{if(e.preventDefault(),o||u)return!1;await j(b)},j=async e=>{v(""),c(!0),g([...x,e]);try{await a({editInput:e})}catch(e){v(b),g(e=>e.slice(0,-1))}c(!1)},w=async()=>{x.length&&(m(!0),await a({prompt:i.current}),m(!1)),n()},M=(0,d.useMemo)(()=>{if(!t.attributes)return[];let e=Math.floor(Math.random()*t.attributes.length),a=e+1<t.attributes.length?e+1:e-1;return[l.formatMessage({defaultMessage:"A bit more {attribute}",id:"au1WTQvqDg"},{attribute:t.attributes[e].name.toLowerCase()}),l.formatMessage({defaultMessage:"Much less {attribute}",id:"dIbq/Ow8Zn"},{attribute:t.attributes[a].name.toLowerCase()})]},[t.attributes,l]);return(0,d.useEffect)(()=>{if(x.length>0){var e;null==(e=r.current)||e.scrollTo({top:r.current.scrollHeight,behavior:"smooth"})}},[x,t.summary]),(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-1 min-h-0 flex flex-col gap-2 p-2.5 rounded-xl border border-accent-secondary-100/50 bg-bg-100 ",children:[(0,s.jsxs)("div",{className:(0,f.A)("border-0.5 rounded-lg p-3 pt-2.5 mb-2 relative transition bg-gradient-to-b",o?"border-border-300 from-accent-secondary-900/50 to-accent-secondary-900/10":"border-accent-secondary-100/50 from-accent-secondary-900/75 to-accent-secondary-900/25"),children:[(0,s.jsx)("div",{className:(0,f.A)("font-claude-response font-normal text-pretty leading-snug text-text-200 transition",o?"opacity-0 scale-[0.975]":"delay-150 duration-150 ease-out"),children:t.summary}),(0,s.jsx)(p.N,{children:o&&(0,s.jsx)(h.P.div,{className:"absolute inset-0 grid place-items-center",initial:{scale:.75,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.75,opacity:0},children:(0,s.jsx)(sg.a,{state:"thinking"})})})]}),(0,s.jsx)("ul",{ref:r,className:"flex-1 min-h-0 overflow-y-auto flex flex-col gap-2",children:x.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("div",{className:"inline-block py-2 px-3 rounded-lg bg-bg-300 text-sm",children:e})},e))}),x.length>0?(0,s.jsx)("div",{className:"text-sm text-center text-text-500",children:(0,s.jsx)(X.A,{defaultMessage:"Ask for more edits, save, or discard changes",id:"zOxoAYYCog"})}):(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("div",{className:"text-sm text-text-500 mb-2",children:(0,s.jsx)(X.A,{defaultMessage:"Describe how you’d like to edit the style, like:",id:"PRDvfjUkNA"})}),(0,s.jsx)("ul",{className:"flex flex-col gap-2",children:M.map((e,t)=>(0,s.jsx)("li",{children:(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),j(e)},className:"text-sm font-medium h-8 px-3 rounded-full border-0.5 border-border-200 text-text-200 bg-gradient-to-b hover:text-text-000 hover:from-bg-400/0 hover:to-bg-400/50 hover:border-border-100 active:scale-x-[0.985] active:scale-y-[0.995] transition",children:e})},t))})]}),(0,s.jsx)("form",{className:"mb-1.5 mx-0.5",onSubmit:e=>y(e),children:(0,s.jsx)(az.ks,{autoFocus:!0,className:"w-full",name:"inputText",placeholder:l.formatMessage({defaultMessage:"Ask Claude to edit the style...",id:"5D1Fao75P8"}),size:"lg",value:b,onChange:e=>v(e.target.value),append:(0,s.jsx)(p.N,{children:b.length>0&&(0,s.jsx)(h.P.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.85,opacity:0,transition:{ease:"easeIn",duration:.1}},children:(0,s.jsx)(eo.$,{type:"submit",size:"icon_sm",variant:"claude",disabled:o||u,children:(0,s.jsx)(sv.D,{})})})})})})]}),(0,s.jsxs)(sI,{isSaveButton:!0,children:[(0,s.jsx)(eo.$,{onClick:n,disabled:o||u||b.length>0||0===x.length,children:(0,s.jsx)(X.A,{defaultMessage:"Save changes",id:"X0ha1a+WYV"})}),(0,s.jsx)(eo.$,{onClick:w,disabled:o,loading:u,variant:"secondary",children:x.length>0?(0,s.jsx)(X.A,{defaultMessage:"Discard",id:"nmpevlUATU"}):(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})},sD=e=>{let{style:t,updateStyle:a,onClose:n}=e,[l,i]=(0,d.useState)(!1),[r,o]=(0,d.useState)(t.prompt),c=(0,G.A)(),u=async e=>{e.preventDefault(),i(!0),await a({prompt:r}),i(!1),n()};return(0,s.jsxs)("form",{className:"flex flex-col gap-2 h-full min-h-0 p-3 pt-2 rounded-xl border-0.5 border-border-200",onSubmit:e=>u(e),children:[(0,s.jsx)("div",{className:"text-center text-sm text-text-200 font-medium",children:(0,s.jsx)(X.A,{defaultMessage:"Edit style instructions manually",id:"+qSf1b/LLJ"})}),(0,s.jsx)("textarea",{className:" flex-1 min-h-0 bg-bg-000 border border-border-200 p-3 leading-5 rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:c.formatMessage({defaultMessage:"Describe your style instructions",id:"nk7EX3l+b4"}),value:r,disabled:l,onChange:e=>o(e.target.value),autoFocus:!0}),(0,s.jsxs)(sI,{isSaveButton:!0,children:[(0,s.jsx)(eo.$,{type:"submit",loading:l,children:(0,s.jsx)(X.A,{defaultMessage:"Save changes",id:"X0ha1a+WYV"})}),(0,s.jsx)(eo.$,{onClick:()=>{o(t.prompt),n()},disabled:l,variant:"secondary",children:(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})},sO=e=>{let{style:t,onClick:a}=e,n="default"===t.type;return(0,s.jsxs)("div",{className:(0,f.A)("flex flex-col items-center h-full px-6 gap-4 rounded-lg sm:rounded-xl max-sm:mx-1.5",!n&&"bg-gradient-to-b from-accent-secondary-900/75 to-accent-secondary-900/25 border border-accent-secondary-100/50",n&&"bg-bg-300 border border-border-300"),children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("div",{className:(0,f.A)("w-fit px-4 py-2 pb-2.5 gap-2.5 rounded-b-lg font-medium text-xs",n?"bg-bg-400 text-text-300":"bg-accent-secondary-200/10 text-accent-secondary-100"),children:n?(0,s.jsx)(X.A,{defaultMessage:"Preset style",id:"qwpRSZtBAV"}):(0,s.jsx)(X.A,{defaultMessage:"Your custom style",id:"o/vLK7B7mw"})})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1.5 pb-4",children:[!n&&(0,s.jsx)(ew.m,{className:"text-center",tooltipContent:(0,s.jsx)(X.A,{defaultMessage:"Full style instructions are generated and include more than shown in summary. You can edit instructions manually from the options menu",id:"R5PMcY1ELo"}),children:(0,s.jsxs)("div",{className:"flex items-center gap-1 cursor-help opacity-50 hover:opacity-60",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:(0,s.jsx)(X.A,{defaultMessage:"Style summary",id:"hVmQ4DO8io"})}),(0,s.jsx)(ax.R,{size:12,className:"translate-y-px",weight:"bold"})]})}),(0,s.jsx)("div",{"data-testid":"style-summary",className:"font-claude-response text-xl font-normal text-pretty leading-snug text-center flex-1 flex items-center",children:"default"===t.type&&t.summaryKey?(0,s.jsx)(tR.X5,{id:t.summaryKey}):t.summary})]}),(0,s.jsx)("div",{className:"flex-1 flex items-center text-sm",children:n?(0,s.jsx)(X.A,{defaultMessage:"Preset styles are not editable",id:"qjKy0s/reb"}):(0,s.jsx)(eo.$,{variant:"secondary",onClick:a,className:"!border-accent-secondary-200 !text-accent-secondary-000 hover:!bg-accent-secondary-100/10",prepend:(0,s.jsx)(sk.f,{weight:"bold"}),children:(0,s.jsx)(X.A,{defaultMessage:"Edit with Claude",id:"wdKoWlVN+G"})})})]})},sP=e=>{let{style:t,animateBoolRef:a}=e,n=(0,G.A)(),[l,i]=(0,d.useState)(""),[r,o]=(0,d.useState)(),c=(0,d.useRef)(t.prompt),u=(0,d.useRef)(r),x=(0,m.T9)("claude_style_previews","previewExamples",sE,sS),{handleRateLimitError:g}=ss(),{isPending:b,mutateAsync:v}=(0,a2.n7)(),y=(0,d.useCallback)(async()=>{if(r)try{let e=await v({style_prompt:t.prompt,example_key:r.key,example_text:r.textKey?(0,tR.fl)({id:r.textKey,intl:n}):r.text});i(e)}catch(e){g(e,n.formatMessage({defaultMessage:"Failed to preview style. Please try again.",id:"B2A4x/wbTg"}))}},[g,v,r,t.prompt,n]);return(0,d.useEffect)(()=>{var e;(c.current!==t.prompt||(null==(e=u.current)?void 0:e.key)!==(null==r?void 0:r.key))&&(c.current=t.prompt,u.current=r,y())},[y,r,t.prompt]),(0,s.jsx)(h.P.div,{className:(0,f.A)("max-sm:hidden flex flex-col gap-2 h-full min-h-0 p-2 rounded-xl border-0.5 border-border-300 transition-colors",r?"bg-bg-000/70":"bg-bg-000/20"),initial:!!a.current&&{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{scale:{type:"spring",stiffness:230,damping:15,delay:.2},opacity:{duration:.3,delay:.2}},children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center text-sm px-2 font-medium text-text-200",children:[(0,s.jsx)(X.A,{defaultMessage:"Previewing with",id:"tNFdPqESDT"}),(0,s.jsx)(a5.ms,{align:"center",trigger:(0,s.jsxs)("button",{className:"flex items-center !px-1 !py-0.5 gap-0.5 !text-accent-secondary-100 hover:!bg-accent-secondary-900",children:[r?r.nameKey?(0,s.jsx)(tR.X5,{id:r.nameKey}):r.name:(0,s.jsx)(X.A,{defaultMessage:"Example",id:"xrCRnH/mKK"}),(0,s.jsx)(s_.a,{className:"translate-y-px"})]}),children:x.map(e=>(0,s.jsx)(a5.tJ,{disabled:b,onClick:()=>o(e),children:e.nameKey?(0,s.jsx)(tR.X5,{id:e.nameKey}):e.name},e.key))})]}),(0,s.jsxs)(sb.E,{className:"p-2 pt-0 min-h-0 overflow-y-scroll",children:[(0,s.jsx)("div",{className:"bg-bg-300 -mx-0.5 mb-2 py-1.5 px-2 text-sm rounded-lg text-pretty",children:r.textKey?(0,s.jsx)(tR.X5,{id:r.textKey}):r.text}),(0,s.jsx)(p.N,{children:b?(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(sg.a,{state:"writing"})}):(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeIn",duration:.25},children:(0,s.jsx)(sh.f,{className:"font-claude-response flex-1 flex flex-col gap-2",text:l})})})]})]}):(0,s.jsx)("div",{className:"flex-1 grid place-items-center text-center",children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"text-sm text-text-500 font-medium mb-4",children:(0,s.jsx)(X.A,{defaultMessage:"Preview with an example...",id:"YdUmd5z6YL"})}),(0,s.jsx)("div",{className:"flex flex-wrap justify-center gap-2 w-full",children:x.map(e=>(0,s.jsx)("button",{onClick:()=>o(e),className:"\n                    rounded-full\n                    border-0.5\n                    border-border-300\n                    text-sm\n                    text-text-400\n                    font-medium\n                    h-8\n                    px-3\n                    flex\n                    items-center\n                    bg-gradient-to-b\n                    from-always-black/0\n                    to-always-black/5\n                    hover:bg-accent-secondary-900\n                    hover:text-accent-secondary-000\n                    hover:border-accent-secondary-100/50\n                    transition-colors",children:e.nameKey?(0,s.jsx)(tR.X5,{id:e.nameKey}):e.name},e.key))})]})})})},sL=e=>{let{style:t,returnToListScreen:a,onRename:n,setStateToManualEdit:l}=e,i=(0,tP.X)(t),o="default"===t.type,{isPending:d,mutateAsync:c}=(0,a2.M$)(i),{addHiddenPresetStyle:u}=sC(),{clearStoredStyle:m,storedStyle:x}=(0,tO.p)(),{addError:f}=(0,r.Y)(),p=(0,G.A)(),h=async()=>{if(o)u(t),setTimeout(()=>{a()},500);else try{await c(),x&&"uuid"in x&&x.uuid===t.uuid&&m(),a()}catch(e){f(p.formatMessage({defaultMessage:"Failed to delete style. Please try again.",id:"4eIHICfKCI"}),{error:e,messageForLogging:"Failed to delete style. Please try again."})}};return(0,s.jsxs)(a5.ms,{align:"end",unstyledTrigger:!0,trigger:(0,s.jsxs)(eo.$,{variant:"ghost",className:"max-sm:min-w-8 max-sm:px-2 sm:pl-3 sm:pr-2",children:[(0,s.jsxs)("span",{className:"hidden sm:flex items-center gap-1",children:[(0,s.jsx)(X.A,{defaultMessage:"Options",id:"NDV5MqT9ww"}),"\xa0",(0,s.jsx)(s_.a,{})]}),(0,s.jsx)("span",{className:"sm:hidden",children:(0,s.jsx)(sy.L,{weight:"bold",size:20})})]}),children:[!o&&(0,s.jsx)(a5.tJ,{disabled:d,onClick:()=>{n()},children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(sj.g,{className:"mr-2"}),(0,s.jsx)(X.A,{defaultMessage:"Rename style",id:"sEO8vFphTF"})]})}),"Concise"===i?(0,s.jsx)(a5.q,{className:"text-sm",children:(0,s.jsx)(X.A,{defaultMessage:"Concise style can’t be hidden",id:"zTztS+Om9I"})}):(0,s.jsx)(a5.tJ,{className:"pr-0 !text-danger-000",disabled:d,onClick:h,children:o?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(sw.C,{}),(0,s.jsx)(X.A,{defaultMessage:"Hide preset style",id:"z44N28JZYv"})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(sM.l,{}),(0,s.jsx)(X.A,{defaultMessage:"Delete style",id:"fAqSoPl78t"})]})}),!o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a5.DG,{}),(0,s.jsx)(a5.tJ,{onClick:l,children:(0,s.jsx)(X.A,{defaultMessage:"Edit style manually",id:"H+z4uo2Wfn"})})]})]})},sF=e=>{let{size:t=16,className:a}=e;return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",width:t,height:t,viewBox:"0 0 16 16",className:a,strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M8.5 4.5c-3 2-4.5 4-5.5 8L2.5 15l1-1.5"}),(0,s.jsx)("path",{d:"M3 4.5c-.5 1.3-.1 5 .4 6.5 0 0 1.9-2 4.1-3 1.8-.8 3.8-.6 4.5-2 .6-1.2-.2-1.7-1.5-1 1.2-.7 4-2 3-3.5-1-1.4-3.5-.1-4.5.8C9 1.9 9 .9 8 1c-1 .1-2 1.5-2.3 2.8 0 0 0-.7-.7-.8-.7-.1-1.6.5-2 1.5Z"}),(0,s.jsx)("path",{d:"M10.5 11v4m-2-2h4"})]})};var sz=a(0x1d06467a8),sU=a(0xff96fe3f),sG=a(0x9fa0975a),sY=a(0xc454ce54),sH=a(0x18af45dd9);let sK=(0,d.forwardRef)((e,t)=>{let{setScreen:a,styles:n,onStyleChange:l}=e,{hiddenPresetStyles:i,resetHiddenPresetStyles:r}=sC(),{sortStyles:o,setOrder:c}=function(){let[e,t]=(0,sA.Vc)("userStylesOrder",[]);return{sortStyles:(0,d.useCallback)(t=>[...t].sort((t,a)=>{let s=(0,tP.X)(t),n=(0,tP.X)(a);if("Default"===s)return -1;if("Default"===n)return 1;let l=e.indexOf(s),i=e.indexOf(n);return -1===l&&-1===i?0:-1===l?1:-1===i?-1:l-i}),[e]),stylesOrder:e,setOrder:(0,d.useCallback)(e=>{t(e.map(e=>(0,tP.X)(e)))},[t])}}(),[u,m]=(0,d.useState)([]),x=(0,d.useCallback)(e=>{let t=[...i,"Default"];return o(e.filter(e=>!t.includes((0,tP.X)(e))))},[i,o]);(0,d.useEffect)(()=>{m(x(n))},[n,x]);let f=(0,d.useCallback)(e=>{Array.isArray(e)&&(m(e),c(e))},[c]),p=(0,d.useMemo)(()=>n.some(e=>"custom"===e.type),[n]);return(0,s.jsxs)(h.P.div,{exit:{opacity:0,transition:{duration:0}},ref:t,className:"flex-1 min-h-0 flex flex-col -mx-3",children:[(0,s.jsxs)("div",{className:"flex-1 min-h-0",children:[(0,s.jsx)(sG.x,{as:"ul",axis:"y",values:u,onReorder:f,layoutScroll:!0,className:"pl-3 pr-3 pb-2 overflow-y-auto max-h-full [mask-image:linear-gradient(to_top,hsl(var(--always-black)/0%)_0%,_hsl(var(--always-black)/100%)_3%)]",children:u.map(e=>(0,s.jsx)(sV,{style:e,onClick:()=>l(e,!1)},(0,tP.X)(e)))}),!p&&(0,s.jsxs)(h.P.div,{initial:{opacity:0,scale:.985},animate:{opacity:1,scale:1,transition:{delay:.3,ease:"easeOut",duration:.3}},exit:{opacity:0},className:"flex bg-gradient-to-b from-accent-pro-900/20 to-accent-pro-900/50 py-3 pl-3.5 pr-5 mx-3 rounded-lg border-0.5 border-border-300 text-text-300 text-sm",children:[(0,s.jsx)("div",{className:"font-ui-serif font-medium mr-4 text-accent-pro-000 mt-px whitespace-nowrap",children:(0,s.jsx)(X.A,{defaultMessage:"Tip",id:"4j1TGZubAJ"})}),(0,s.jsx)("p",{children:(0,s.jsx)(X.A,{defaultMessage:"Choose from preset styles or create your own custom style to tailor elements of Claude’s written responses such as tone, voice, vocabulary, detail level, and more. <link>Learn about styles</link>",id:"pwT6iI4QV7",values:{link:e=>(0,s.jsx)(aY.Y,{href:"https://support.anthropic.com/en/articles/10181068-configuring-and-using-styles",target:"_blank",children:e})}})})]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4 mx-3",children:[(0,s.jsx)(eo.$,{onClick:()=>a(tD.I.CREATE),prepend:(0,s.jsx)(sF,{}),children:(0,s.jsx)(X.A,{defaultMessage:"Create custom style",id:"9y/YEanHck"})}),i.length>0&&(0,s.jsx)(aY.Y,{onClick:r,children:(0,s.jsx)(X.A,{defaultMessage:"Reset preset styles",id:"EITqrHaUNi"})})]})]})});sK.displayName="ListStyles";let sV=e=>{let{style:t,onClick:a}=e,n="default"===t.type,l=(0,sY.m)(),[i,r]=(0,d.useState)(!1);return(0,s.jsxs)(sH.N,{value:t,dragListener:!1,dragControls:l,dragTransition:{bounceStiffness:500,bounceDamping:40},onDragStart:()=>r(!0),onDragEnd:()=>r(!1),className:"relative my-2 min-w-0",children:[(0,s.jsxs)("button",{className:(0,f.A)("\n          flex\n          items-center\n          w-full\n          h-11\n          py-4\n          pl-1\n          pr-3\n          min-w-0\n          rounded-lg\n          transition\n          border-0.5\n          border-border-300\n          bg-bg-100\n          bg-gradient-to-b\n          from-bg-300/0\n          to-bg-300/50\n          select-none\n          relative\n        ",i?"scale-y-[1.015] scale-x-[1.0025] shadow-md":"group hover:enabled:from-accent-secondary-200/0 hover:enabled:to-accent-secondary-200/10 hover:enabled:border-accent-secondary-200/50"),onClick:a,children:[(0,s.jsx)("div",{className:"flex min-w-0 items-center flex-1 pl-7 truncate",children:"default"===t.type&&t.nameKey?(0,s.jsx)(tR.X5,{id:t.nameKey}):t.name}),n&&(0,s.jsx)("div",{className:"mr-0.5 rounded-full px-2 py-0.5 bg-text-300/5 text-text-400 font-medium text-[0.625rem]",children:(0,s.jsx)(X.A,{defaultMessage:"Preset",id:"EucS2pAMVS"})}),(0,s.jsx)("div",{className:"text-accent-secondary-200 opacity-0 scale-50 transition group-hover:scale-100 group-hover:opacity-100",children:n?(0,s.jsx)(sz.Q,{}):(0,s.jsx)(sj.g,{})})]}),(0,s.jsx)("div",{onPointerDown:e=>l.start(e),onClick:e=>e.stopPropagation(),className:"w-7 h-7 absolute left-1 top-1/2 -translate-y-1/2 grid place-items-center cursor-move text-text-500 hover:text-accent-secondary-000",children:(0,s.jsx)(sU.H,{size:16,weight:"bold"})})]})},sW=e=>{let{openWithScreen:t,onClose:a,styles:n,setChatStyle:l}=e,i=(0,G.A)(),r=!!t,o=(0,ed.st)(),[c,u]=(0,d.useState)(t||tD.I.LIST),[m,x]=(0,d.useState)(),[f,h]=(0,d.useState)(!1),[g,b]=(0,d.useState)(!1),v=(0,d.useRef)(!1);(0,d.useEffect)(()=>{t&&u(t)},[t]);let y=()=>{v.current=!1,u(tD.I.LIST),h(!1),b(!1)},j=()=>{(!f||window.confirm(i.formatMessage({defaultMessage:"Are you sure? Closing while editing may not synchronize changes.",id:"0XdWZrmwXu"})))&&(o.track({event_key:"styles.modal",open:!1}),y(),a())},w=(e,t)=>{v.current=t,x(e),u(tD.I.EDIT),h(!1),b(!1)};return(0,s.jsx)(eC.aF,{modalSize:"xl",title:(e=>{switch(e){case tD.I.CREATE:return(0,s.jsx)("div",{className:"font-ui-serif font-normal",children:(0,s.jsx)(X.A,{defaultMessage:"Create a style",id:"/pKvFi9Ak4"})});case tD.I.CREATE_MANUALLY:return(0,s.jsx)("div",{className:"font-ui-serif font-normal",children:(0,s.jsx)(X.A,{defaultMessage:"Describe your style",id:"Ntblq5cSRe"})});case tD.I.LIST:return(0,s.jsx)("div",{className:"font-ui-serif font-normal",children:(0,s.jsx)(X.A,{defaultMessage:"Customize your styles",id:"dn3MiW/vUH"})});case tD.I.EDIT:return(0,s.jsx)("div",{className:"w-10/12 sm:w-5/12 md:w-7/12",children:g?(0,s.jsx)(sB,{style:m,onClose:e=>{e&&x(e),b(!1)}}):(0,s.jsx)("button",{title:m.name,className:"w-full font-ui-serif font-normal text-left truncate cursor-text h-9 pr-4 leading-none translate-y-px text-text-200 hover:text-text-000",onClick:()=>!f&&b(!0),children:f?(0,s.jsx)(X.A,{defaultMessage:"Edit {name}",id:"s3IOQQ+nJU",values:{name:m.name}}):"default"===m.type&&m.nameKey?(0,s.jsx)(tR.X5,{id:m.nameKey}):m.name})})}})(c),icon:(e=>{switch(e){case tD.I.CREATE:case tD.I.EDIT:return(0,s.jsx)(eo.$,{variant:"ghost",size:"icon_sm",disabled:f,onClick:()=>y(),children:(0,s.jsx)(aQ.n,{})});case tD.I.CREATE_MANUALLY:return(0,s.jsx)(eo.$,{variant:"ghost",size:"icon_sm",onClick:()=>u(tD.I.CREATE),children:(0,s.jsx)(aQ.n,{})});case tD.I.LIST:return null}})(c),isOpen:r,onClose:j,className:"h-[35rem] !bg-gradient-to-b from-bg-100 to-bg-200 !pt-5 !pb-7",prependBeforeCloseButton:(0,s.jsx)(s.Fragment,{children:c===tD.I.LIST&&(0,s.jsx)(ew.m,{tooltipContent:i.formatMessage({defaultMessage:"Learn more about styles ↗",id:"nuhnis5YtY"}),children:(0,s.jsx)("div",{className:"mr-1",children:(0,s.jsx)(eo.$,{href:"https://support.anthropic.com/en/articles/10181068-configuring-and-using-styles",variant:"ghost",className:"text-text-300",size:"icon",target:"_blank",children:(0,s.jsx)(a0.v,{size:18})})})})}),hasCloseButton:!0,children:(0,s.jsxs)(p.N,{mode:"popLayout",children:[c===tD.I.CREATE&&(0,s.jsx)(si,{onStyleChange:w,setScreen:u,animateBoolRef:v},"CreateStyleScreen"),c===tD.I.CREATE_MANUALLY&&(0,s.jsx)(sp,{onStyleChange:w,setScreen:u},"CreateStyleManuallyScreen"),c===tD.I.LIST&&(0,s.jsx)(sK,{setScreen:u,styles:n,onStyleChange:w},"ListStylesScreen"),c===tD.I.EDIT&&m&&(0,s.jsx)(sT,{animateBoolRef:v,style:m,returnToListScreen:y,setIsEditingName:b,setCurrentStyle:x,setIsEditing:h,setChatStyle:e=>{l(e),j()}},"EditStyleScreen")]})})},sB=e=>{let{style:t,onClose:a}=e,n=(0,tP.X)(t),l="default"===t.type,i=(0,G.A)(),[r,o]=(0,d.useState)("default"===t.type&&t.nameKey?(0,tR.fl)({id:t.nameKey,intl:i}):t.name),{isPending:c,mutateAsync:u}=(0,a2.lo)(n,l),m=async()=>{a(await u({name:r}))};return(0,s.jsx)("form",{className:"w-full",onSubmit:async e=>{e.preventDefault(),await m()},children:(0,s.jsx)(az.ks,{autoFocus:!0,className:"w-full",value:r,maxLength:64,onChange:e=>o(e.target.value),error:0===r.length,append:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eo.$,{variant:"ghost",type:"button",size:"icon_xs",className:"mr-1",onClick:()=>a(),disabled:c,children:(0,s.jsx)(aW.X,{})}),(0,s.jsx)(eo.$,{variant:"claude",size:"icon_xs",type:"submit",loading:c,children:(0,s.jsx)(a1.J,{weight:"bold"})})]})})})};var sJ=a(0x1a28f0915),sq=a(0x1757bd130),sX=a(0xeaff4de);let sZ=()=>{let e=(0,W.QN)(),{conversation:t}=(0,W.lE)(),{setSyncSourceUuids:a,syncSourceUuids:n,attachments:l,setAttachments:i}=(0,W.Jy)(e=>({setSyncSourceUuids:e.setSyncSourceUuids,syncSourceUuids:e.syncSourceUuids,attachments:e.attachments,setAttachments:e.setAttachments})),{setProjectUuid:r,setIsUploadingGithubSync:o}=(0,w.oM)(),{styleModalOpenWithScreen:c,setStyleModalOpenWithScreen:u,createProjectModalIsOpen:m,setCreateProjectModalIsOpen:x,githubModalIsOpen:f,setGithubModalIsOpen:p,gmailAuthModalIsOpen:h,setGmailAuthModalIsOpen:b,createPromptArgumentModalIsOpen:v,setCreatePromptArgumentModalIsOpen:y}=(0,e5.CH)(),{mcpDirectoryModalIsOpen:j,setMcpDirectoryModalIsOpen:M}=(0,e5.tl)(),{personalizedStyleOptions:k}=(0,tO.p)(),{moveToProject:_}=(0,tk.j)(),A=(0,Q.sb)(),C=(0,th.pi)(),N=(0,d.useCallback)(e=>{a(t=>[...t,e.uuid]),o(!1)},[a,o]),S=(0,g.NY)(n),E=(0,aF.B7)(S);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sW,{openWithScreen:c,onClose:()=>u(null),styles:k,setChatStyle:e=>C(e.key)}),(0,s.jsx)(sq.r,{isOpen:!!h,onClose:()=>b(!1),callerIdentifier:"inputMenu"}),(0,s.jsx)(aZ,{moveAttachments:!!(null==m?void 0:m.moveAttachments),isOpen:!!(null==m?void 0:m.isOpen),handleClose:()=>x(null),handleProjectCreated:e=>{(null==t?void 0:t.id)?_([t.id],e.uuid,e.name,{enableNavigation:!0}):r(e.uuid),x(null)},syncSources:E,attachments:l,setSyncSourceUuids:a,setAttachments:i}),(0,s.jsx)(sJ.s,{location:"chat",projectUuid:e,isOpen:f,onClose:()=>p(!1),onCreated:N,setIsUploadingGithubSync:o}),v&&(0,s.jsx)(aV,{isOpen:v.isOpen,onClose:()=>y(null),serverUuid:v.serverUuid,prompt:v.prompt}),A&&(0,s.jsx)(ac.TY,{isOpen:j,setIsOpen:M,showManageButton:!0}),(0,s.jsx)(sX.Rk,{})]})},s$=(0,d.memo)(e=>{let{options:t,onSelect:a,onClose:n,position:l,selectedIndex:i}=e,r=(0,d.useRef)(null),[o,c]=(0,d.useState)(l),[u,m]=(0,d.useState)(null),x=null!=u?u:i;return((0,d.useEffect)(()=>{if(r.current){let e=r.current.getBoundingClientRect(),t=window.innerWidth,a=window.innerHeight,s=l.top,n=l.left;e.right>t&&(n=Math.max(0,t-e.width-16)),e.bottom>a&&(s=Math.max(0,l.top-e.height-24)),c({top:s,left:n})}},[l.top,l.left,t.length]),(0,d.useEffect)(()=>{if(r.current&&x>=0){let e=r.current.children[x];null==e||e.scrollIntoView({block:"nearest"})}},[x]),(0,d.useEffect)(()=>{let e=e=>{r.current&&!r.current.contains(e.target)&&n()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[n]),0===t.length)?null:(0,s.jsx)("div",{ref:r,className:"fixed z-50 max-h-96 w-60 overflow-y-auto rounded-2xl border-0.5 border-border-200 bg-bg-000 shadow-lg p-2",style:{top:"".concat(o.top,"px"),left:"".concat(o.left,"px")},children:t.map((e,t)=>(0,s.jsxs)("button",{type:"button",className:(0,f.A)("w-full flex items-center gap-2 overflow-clip","pl-2 pr-1.5 py-1.5 rounded-lg","font-base text-text-300 text-left","cursor-pointer select-none","hover:bg-bg-200 focus:bg-bg-200 focus:outline-none",x===t&&"bg-bg-200"),onClick:()=>a(e.id),onMouseEnter:()=>m(t),onMouseLeave:()=>m(null),children:[e.icon&&(0,s.jsx)("span",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center",children:"string"==typeof e.icon?(0,s.jsx)("img",{src:e.icon,alt:"",className:"w-4 h-4"}):e.icon}),(0,s.jsx)("span",{className:"flex-1 truncate text-left",children:e.label})]},e.id))})});s$.displayName="MentionDropdown";var sQ=a(0x1b847d515),s0=a(0xd674e3b3);let s1=new sQ.hs("mention"),s2=s0.YY.create({name:"mentionExtension",addOptions:()=>({providers:[],onStateChange:()=>void 0,onSelect:()=>void 0}),addProseMirrorPlugins(){let{providers:e,onStateChange:t}=this.options;return[new sQ.k_({key:s1,state:{init:()=>({active:!1,query:"",position:null,options:[],selectedIndex:0}),apply:(e,a,s,n)=>{let l=e.getMeta(s1);if(l){let e={...a,...l};return t(e),e}return a}},view:()=>{let t=null,a=null;return{update:(s,n)=>{let{state:l}=s,{selection:i}=l,{$from:r}=i,o=r.parent.textBetween(Math.max(0,r.parentOffset-50),r.parentOffset,void 0,"￼").match(/(?:^|\s)@(\w*)$/);if(!o){t=null,a&&(clearTimeout(a),a=null);let e=s1.getState(l);(null==e?void 0:e.active)&&s.dispatch(l.tr.setMeta(s1,{active:!1,query:"",options:[],position:null,selectedIndex:0}));return}let d=o[1]||"",c=s1.getState(l),u=s1.getState(n);if((null==u?void 0:u.active)&&!(null==c?void 0:c.active)){t=u.query,a&&(clearTimeout(a),a=null);return}if(null!==t){if(""===t&&""===d||""!==t&&d.startsWith(t))return;t=null}if((null==c?void 0:c.active)&&c.query===d)return;let m=s.coordsAtPos(r.pos),x={top:m.bottom+4,left:m.left};a&&clearTimeout(a),a=setTimeout(()=>{(async()=>{let t=(await Promise.all(e.map(e=>e.fetchOptions(d)))).flat();s.dispatch(l.tr.setMeta(s1,{active:!0,query:d,position:x,options:t,selectedIndex:(null==c?void 0:c.active)&&c.query===d?c.selectedIndex:0}))})()},250)},destroy:()=>{a&&clearTimeout(a)}}}})]},addKeyboardShortcuts(){return{ArrowDown:()=>{let e=s1.getState(this.editor.state);if(!(null==e?void 0:e.active))return!1;let t=Math.min(e.selectedIndex+1,e.options.length-1);return this.editor.view.dispatch(this.editor.state.tr.setMeta(s1,{selectedIndex:t})),!0},ArrowUp:()=>{let e=s1.getState(this.editor.state);if(!(null==e?void 0:e.active))return!1;let t=Math.max(e.selectedIndex-1,0);return this.editor.view.dispatch(this.editor.state.tr.setMeta(s1,{selectedIndex:t})),!0},Enter:()=>{let e=s1.getState(this.editor.state);if(!(null==e?void 0:e.active))return!1;let t=e.options[e.selectedIndex];return t&&this.options.onSelect(t.id),!0},Escape:()=>{let e=s1.getState(this.editor.state);return!!(null==e?void 0:e.active)&&(this.editor.view.dispatch(this.editor.state.tr.setMeta(s1,{active:!1,query:"",options:[],position:null,selectedIndex:0})),!0)}}}});var s5=a(0xe94b0893);let s8=(0,d.memo)(e=>{let{node:t,selected:a}=e,[n,l]=(0,d.useState)(!1),i=t.attrs,r=i.label||"";return(0,s.jsxs)(s5.VR,{as:"span",className:(0,f.A)("inline-flex relative cursor-pointer group mx-0.5",a?"text-accent-secondary-000":"text-accent-secondary-100"),contentEditable:!1,"data-drag-handle":!0,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[(0,s.jsx)("span",{className:(0,f.A)("absolute -inset-y-0.5 -left-0.5 -right-1 rounded-md pointer-events-none",a&&"bg-accent-secondary-900",n&&!a&&"bg-accent-secondary-900/50")}),(0,s.jsxs)("span",{className:(0,f.A)("relative",i.icon&&"pl-5"),children:[i.icon&&(0,s.jsx)("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 w-5 h-5 flex items-center justify-center",children:i.icon.startsWith("data:image")?(0,s.jsx)("img",{src:i.icon,alt:"",className:"h-4 w-4",title:r}):(0,s.jsx)("span",{className:"h-4 w-4",dangerouslySetInnerHTML:{__html:i.icon},title:r})}),(0,s.jsx)("span",{className:"relative [&::selection]:bg-transparent",children:r})]})]})});s8.displayName="MentionChip";let s3=s0.bP.create({name:"mention",group:"inline",inline:!0,atom:!0,addAttributes:()=>({id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>({"data-id":e.id})},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>({"data-label":e.label})},icon:{default:null,parseHTML:e=>e.getAttribute("data-icon"),renderHTML:e=>({"data-icon":e.icon})},providerId:{default:null,parseHTML:e=>e.getAttribute("data-provider-id"),renderHTML:e=>({"data-provider-id":e.providerId})}}),parseHTML:()=>[{tag:"span[data-type=“at-mention”]"}],renderHTML(e){let{HTMLAttributes:t}=e;return["span",(0,s0.KV)(t,{"data-type":"at-mention"}),"@".concat(t["data-label"]||"")]},addNodeView:()=>(0,s5.gu)(s8)});var s4=a(0x9f369389);function s6(e){let t=e.split(":");return{serverUuid:t[0],resourceUri:t.slice(1).join(":")}}function s9(e){let t=e.getState(),a=[];for(let[e,s]of Object.entries(t.remoteServers)){if(!s)continue;let n=t.remoteConnectionStates[e];if(!(null==n?void 0:n.isConnected))continue;let l=t.remoteResources[e]||[];0!==l.length&&a.push({uuid:e,name:s.name,resources:l,iconType:"favicon",iconSrc:s.url})}for(let[e,s]of Object.entries(t.localClients)){if(!s)continue;let n=t.localResources[e]||[];0!==n.length&&a.push({uuid:s.uuid,name:e,resources:n,iconType:"external",iconSrc:void 0})}return a}var s7=a(0x16b1d0c0f);let ne={active:!1,query:"",position:null,options:[],selectedIndex:0};var nt=a(0x107838ca5);let na=(0,d.createContext)({setOverrideSubmit:()=>!1});var ns=a(0x808b8338),nn=a(0x116207d9d),nl=a(0x11bffe47c),ni=a(0x39b6086b),nr=a(0x20541bd9),no=a(0x733b8fe2),nd=a.n(no);let nc=new sQ.hs("inputAutocomplete"),nu=()=>({decoration:null,completion:null}),nm=(e,t)=>sQ.LN.atEnd(e).$anchor.pos===t.$anchor.pos,nx=e=>{let{editor:t}=e;if(!nm(t.state.doc,t.state.selection))return!1;let a=nc.getState(t.state);return!!a.decoration&&(t.view.dispatch(t.state.tr.insertText(a.completion.content)),!0)},nf=(e,t,a,s)=>{let n=e.getMeta(nc);if(n&&n.prompt===s.doc.textContent&&(t.completion=n),!nm(s.doc,s.selection)||!t.completion||t.completion.prompt!==s.doc.textContent)return t.decoration=null,t;let l=document.createElement("span");l.className="text-text-500",l.textContent=t.completion.content;let i=document.createElement("span");i.className="ml-1 px-1 border rounded-lg align-[1px] font-medium text-xs text-text-500",i.textContent="Tab";let r=s.selection.$head.pos,o=nr.NZ.widget(r,l),d=nr.NZ.widget(r,i);return t.decoration=nr.zF.create(s.doc,[o,d]),t},np=s0.YY.create({name:"inputAutocompletion",addOptions:()=>({fetchInputAutocompletion:e=>Promise.resolve("")}),addProseMirrorPlugins(){let e=nd()(async(e,t)=>{try{let a=this.options.fetchInputAutocompletion,s=await a(t);s&&e.dispatch(e.state.tr.setMeta(nc,{prompt:t,content:s}))}catch(e){}},300);return[new sQ.k_({key:nc,state:{init:nu,apply:nf},props:{decorations(e){return this.getState(e).decoration}},view:t=>{let{textContent:a}=t.state.doc;return a.length>=3&&e(t,a),{update:(t,a)=>{var s;let{state:n}=t,{doc:l}=n;!a.doc.eq(l)&&(null==(s=nc.getState(n).completion)?void 0:s.prompt)!==l.textContent&&l.textContent.length>=3&&e(t,l.textContent)}}}})]},addKeyboardShortcuts:()=>({Tab:nx})});var nh=a(0x26b0b403);let ng=e=>0===e.state.selection.$from.parentOffset,nb=e=>e.state.selection.$from.marks().some(e=>"code"===e.type.name),nv=e=>"heading"===e.state.selection.$from.parent.type.name,ny=e=>{let t=e.state.selection.$from;return t.parentOffset===t.parent.nodeSize-2},nj=e=>{let t=e.state.tr;t.setStoredMarks([]),t.insertText("​"),e.view.dispatch(t)},nw=e=>!(e.state.selection.$from.after()<e.state.doc.content.size)&&(nj(e),!0),nM=e=>!(e.state.selection.$from.before()>0)&&e.chain().insertContentAt(0,"<p></p>").run(),nk=e=>!(e.state.selection.$from.after()<e.state.doc.content.size)&&e.chain().insertContent("<p></p>").run(),n_=s0.YY.create({name:"CodeBlockKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return"codeBlock"===t.state.selection.$from.parent.type.name&&!!ng(t)&&nM(t)}})}),nA=s0.YY.create({name:"InlineCodeKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return!!nb(t)&&!!ng(t)&&nM(t)},ArrowDown:e=>{let{editor:t}=e;return!!nb(t)&&!!ny(t)&&nk(t)},ArrowRight:e=>{let{editor:t}=e;return!!nb(t)&&!!ny(t)&&nw(t)},ArrowLeft:e=>{let{editor:t}=e;return!!nb(t)&&!!ng(t)&&(e=>!(e.state.selection.$from.before()>0)&&(nj(e),!0))(t)}})}),nC=s0.YY.create({name:"HeadingKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return!!nv(t)&&!!ng(t)&&nM(t)},ArrowDown:e=>{let{editor:t}=e;return!!nv(t)&&!!ny(t)&&nk(t)}})});s0.YY.create({name:"BoldKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"bold"===e.type.name)&&!!ny(t)&&nw(t)}})}),s0.YY.create({name:"ItalicKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"italic"===e.type.name)&&!!ny(t)&&nw(t)}})});let nN=s0.YY.create({name:"StrikeKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"strike"===e.type.name)&&!!ny(t)&&nw(t)}})}),nS=e=>{let{editor:t}=e;return t.commands.enter(),t.commands.scrollIntoView(),!0},nE=s0.YY.create({name:"PTagShiftEnterCreateExtension",addKeyboardShortcuts:()=>({"Shift-Enter":nS,"Alt-Enter":nS})}),nI=s0.YY.create({name:"pasteCodeAsPlainText",addProseMirrorPlugins:()=>[new sQ.k_({key:new sQ.hs("pasteCodeAsPlainText"),props:{handlePaste:(e,t,a)=>{let{schema:s}=e.state;if(!t.clipboardData||!t.clipboardData.types.includes("vscode-editor-data"))return!1;let n=t.clipboardData.getData("text/plain"),l=s.text(n);return e.dispatch(e.state.tr.replaceSelectionWith(l)),!0}}})]}),nT=()=>(0,s.jsx)(s5.VR,{className:"code-block",children:(0,s.jsx)("pre",{className:"my-4 block rounded-md bg-[#282c34] p-2 text-[0.875rem] text-[#abb2bf]",children:(0,s.jsx)("code",{children:(0,s.jsx)(s5.$p,{as:"div"})})})});var nR=a(0x13adb921e);let nD=(0,d.forwardRef)((e,t)=>{let{className:a,disabled:n,prompt:l,tipTapEditorState:i,setTipTapEditorState:o,placeholder:c,onSubmit:u,onReady:x,placement:p,fetchInputAutocompletion:h,onMentionAttachments:b,onMentionDeleted:v,extraExtensions:y=[]}=e,j=(0,G.A)(),w=(0,m.fS)("plain_text_input"),M=(0,m.fS)("chat_input_at_mentions"),k=N(),{mentionProviders:_,handleMentionDeleted:A}=function(e,t){let a=(0,tv.R4)(),n=(0,r.Y)(),{syncSourceUuids:l,setSyncSourceUuids:i}=(0,W.Jy)(e=>({syncSourceUuids:e.syncSourceUuids,setSyncSourceUuids:e.setSyncSourceUuids})),o=(0,g.NY)(l).map(e=>e.data).filter(e=>void 0!==e),c=(0,d.useRef)(a),u=(0,d.useRef)(n),m=(0,d.useRef)(o),x=(0,d.useRef)(i);c.current=a,u.current=n,(0,d.useEffect)(()=>{m.current=o},[o]),(0,d.useEffect)(()=>{x.current=i},[i]);let f=(0,d.useCallback)(e=>{null==t||t(e,"desktop")},[t]),p=(0,d.useCallback)(e=>{let{resourceUri:t}=s6(e),a=m.current.filter(e=>{var a;let s=e.config;return(null==s||null==(a=s.resource)?void 0:a.uri)===t});if(a.length>0){let e=a.map(e=>e.uuid);x.current(t=>t.filter(t=>!e.includes(t)))}},[]),h=(0,d.useCallback)(e=>(0,s.jsx)(e8.z,{size:16,type:e.iconType,src:e.iconSrc,name:e.name}),[]),b=(0,d.useCallback)(e=>(0,nR.qV)((0,s.jsx)(e8.z,{size:16,type:e.iconType,src:e.iconSrc,name:e.name})),[]),v=(0,d.useMemo)(()=>(function(e){let t=s4.EC;if(!(null==t?void 0:t.fetchMentionOptions)||!(null==t?void 0:t.handleMentionSelect))return null;let a=new Map;return{id:"desktop",fetchOptions:async e=>{let s=await t.fetchMentionOptions(e);return a.clear(),s.map(e=>(e.icon&&a.set(e.id,e.icon),{id:e.id,label:e.label,icon:e.icon?d.createElement("img",{src:e.icon,alt:"",className:"w-4 h-4"}):void 0,category:e.category,metadata:e.metadata?JSON.parse(e.metadata):void 0,providerId:"desktop"}))},onSelect:async e=>await t.handleMentionSelect(e),onDelete:e,getIconHtml:e=>a.get(e)}})(f),[f]),y=(0,d.useMemo)(()=>(function(e){let{connectorsStore:t,onSelect:a,onDelete:s,renderIcon:n,renderIconToHtml:l}=e;return{id:"mcp-resources",getIconHtml:e=>{let{serverUuid:a}=s6(e),s=s9(t).find(e=>e.uuid===a);return s?l(s):void 0},fetchOptions:e=>{let a=s9(t),s=e.toLowerCase(),l=[];for(let e of a)for(let t of e.resources.filter(e=>{var t,a;return(null==(t=e.name)?void 0:t.toLowerCase().includes(s))||(null==(a=e.description)?void 0:a.toLowerCase().includes(s))}))l.push({id:"".concat(e.uuid,":").concat(t.uri),label:t.name,icon:n(e),category:e.name,metadata:{serverUuid:e.uuid,resourceUri:t.uri},providerId:"mcp-resources"});return l},onSelect:async e=>{let{serverUuid:s,resourceUri:n}=s6(e),l=s9(t).find(e=>e.uuid===s),i=null==l?void 0:l.resources.find(e=>e.uri===n);if(!l||!i)throw Error("Resource not found");return await a(s,i),{chipText:i.name}},onDelete:s}})({connectorsStore:es.eZ,onSelect:async(e,t)=>{try{await c.current({serverUuid:e,resource:t})}catch(e){throw u.current.addError((0,ea.J)(e),{error:e,errorContext:{tags:{source:"mention_mcp_resource_attach"}}}),e}},onDelete:p,renderIcon:h,renderIconToHtml:b}),[p,h,b]),j=(0,d.useMemo)(()=>e?[v,y].filter(Boolean):[],[e,v,y]),w=(0,d.useCallback)((e,t)=>{let a=j.find(e=>e.id===t);a&&a.onDelete(e)},[j]);return{mentionProviders:j,handleMentionDeleted:w}}(M,v),C=function(e){let{mentionProviders:t,onMentionAttachments:a,onMentionDeleted:s}=e,n=(0,ed.st)(),l=(0,d.useRef)(null),[i,r]=(0,d.useState)(ne),o=(0,d.useRef)(!1),c=(0,d.useCallback)(e=>{e.active&&!o.current&&n.track({event_key:"claudeai.mentions.dropdown.opened"}),o.current=e.active,r(e)},[n]),u=(0,d.useCallback)(()=>{r(ne)},[]),{handleMentionSelect:m}=function(e){let{editor:t,mentionProviders:a,mentionOptions:s,onMentionAttachments:n,onMentionDeleted:l,onDropdownClose:i}=e,r=(0,ed.st)(),o=(0,s7.f)(e=>e.incrementLoading),c=(0,s7.f)(e=>e.decrementLoading),u=d.useRef(null),m=d.useRef(new Map);return d.useEffect(()=>{t&&(u.current=async e=>{var l,d,u;i();let x=s.find(t=>t.id===e);if(!x||!t)return;let f=a.find(e=>e.id===x.providerId);if(!f)return;let{state:p,view:h}=t,{$from:g}=p.selection,b=g.parent.textBetween(Math.max(0,g.parentOffset-50),g.parentOffset,void 0,"￼").match(/(?:^|\s)@(\w*)$/);if(!b)return;let v=g.pos-b[0].length+ +!!b[0].startsWith(" "),y=p.tr;y.delete(v,g.pos);let j=null==(l=p.schema.nodes.mention)?void 0:l.create({id:e,label:x.label,icon:f.getIconHtml(e),providerId:x.providerId});j&&(y.insert(v,j),y.insertText(" ",v+1)),h.dispatch(y),m.current.set(e,x.providerId);let w=await f.onSelect(e);if(!w){t.view.dispatch(t.state.tr.delete(v,v+2)),m.current.delete(e);return}if(w.additionalText){let e=t.state.tr;e.insertText(w.additionalText,t.state.doc.content.size),t.view.dispatch(e)}r.track({event_key:"claudeai.mentions.option.selected",attachment_count:null!=(u=null==(d=w.attachments)?void 0:d.length)?u:0}),(0,aD.flushSync)(()=>{o()});try{n&&w.attachments&&await n(e,w.attachments),t.commands.focus()}finally{(0,aD.flushSync)(()=>{c()})}})},[t,a,s,n,i,r,o,c]),d.useEffect(()=>{if(!t||!l)return;let e=e=>{let{transaction:t}=e,{before:a}=t;t.steps.forEach(e=>{if(void 0!==e.from&&void 0!==e.to){let t=e.from,s=e.to;t<s&&a.nodesBetween(t,s,e=>{if("mention"===e.type.name&&e.attrs.id){let t=e.attrs.id,a=m.current.get(t);a&&(l(t,a),m.current.delete(t))}})}})};return t.on("update",e),()=>{t.off("update",e)}},[t,l]),{handleMentionSelect:d.useCallback(async e=>{u.current&&await u.current(e)},[])}}({editor:l.current,mentionProviders:t,mentionOptions:i.options,onMentionAttachments:a,onMentionDeleted:s,onDropdownClose:u});return{mentionState:i,handleStateChange:c,handleDropdownClose:u,handleMentionSelect:m,setEditor:(0,d.useCallback)(e=>{l.current=e},[])}}({mentionProviders:_,onMentionAttachments:b,onMentionDeleted:A}),{editor:S}=(e=>{let{tipTapEditorState:t,setTipTapEditorState:a,onReady:s,placeholder:n,extraEditorAttributes:l={},fetchInputAutocompletion:i,plainTextMode:r=!1,mentionsEnabled:o=!1,mentionProviders:d=[],onMentionStateChange:c,onMentionSelect:u,extraExtensions:m=[]}=e,x=[nn.A.configure({placeholder:n,emptyEditorClass:"is-editor-empty before:!text-text-500 before:whitespace-nowrap"}),np.configure({fetchInputAutocompletion:i}),nE],f=o?[s3,s2.configure({providers:d,onStateChange:null!=c?c:()=>void 0,onSelect:null!=u?u:()=>void 0})]:[],p=[nI,ns.A.extend({addNodeView:()=>(0,s5.gu)(nT)}).configure({lowlight:ni.l,exitOnTripleEnter:!1}),n_,nC,nA,nN],h=[nl.A.configure(r?{bold:!1,italic:!1,strike:!1,code:!1,codeBlock:!1,blockquote:!1,hardBreak:!1,heading:!1,horizontalRule:!1,bulletList:{},orderedList:{},listItem:{}}:{bold:!1,italic:!1,codeBlock:!1,blockquote:!1,hardBreak:!1,heading:!1,horizontalRule:!1}),...x,...r?[]:p,...f,...m];return{editor:(0,s5.hG)({immediatelyRender:!1,editorProps:{attributes:{enterkeyhint:"enter",...l}},onCreate:e=>{let{editor:t}=e;null==s||s({editor:t})},autofocus:!(0,U.Fr)()&&"end",extensions:h,content:t,onUpdate(e){let{editor:t}=e,s=t.isEmpty&&!t.isFocused,n=t.getJSON();a((0,nh.DV)(n)),s&&t.commands.focus("end")}})}})({tipTapEditorState:i,setTipTapEditorState:o,onReady:x,placeholder:c,fetchInputAutocompletion:h,plainTextMode:w,mentionsEnabled:M,mentionProviders:_,onMentionStateChange:M?C.handleStateChange:void 0,onMentionSelect:M?e=>C.handleMentionSelect(e):void 0,extraEditorAttributes:{role:"textbox","data-testid":"chat-input","aria-label":j.formatMessage({defaultMessage:"Write your prompt to Claude",id:"Lxn7p6AQvE"}),"aria-multiline":"true","aria-required":"false","aria-invalid":"false"},extraExtensions:y});d.useEffect(()=>{M&&C.setEditor(S)},[S,M,C.setEditor]),d.useEffect(()=>{S&&M&&S.extensionManager.extensions.forEach(e=>{"mentionExtension"===e.name&&(e.options.providers=_)})},[S,M,_]);let[E,I]=(0,d.useState)(!1);(0,d.useImperativeHandle)(t,()=>({setContent(e){e!==l&&(null==S||S.commands.setContent(e,{emitUpdate:!1,parseOptions:{preserveWhitespace:"full"}}))},setEditable(e){S.setOptions({editable:e})},focus(){null==S||S.commands.focus()},getPosition:()=>null==S?void 0:S.state.selection.$anchor,getEditor:()=>S,getIsAtEnd(){if(!S)return;let e=S.state.selection.$anchor.pos;return sQ.LN.atEnd(S.state.doc).$anchor.pos===e},scrollToEnd(){S&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{S.commands.setTextSelection(S.state.doc.content.size),S.commands.scrollIntoView();let e=S.view.dom.parentElement;e&&(e.scrollTop=e.scrollHeight)})})}}),[S,l]),(0,d.useEffect)(()=>{null==S||S.setOptions({editable:!n})},[S,n]),(0,d.useEffect)(()=>{if(null!==S&&""!==c){let e=S.extensionManager.extensions.filter(e=>"placeholder"===e.name)[0];e&&(e.options.placeholder=c,S.view.dispatch(S.state.tr))}},[S,c]);let T=(0,d.useCallback)(e=>{if("Enter"!==e.key||!u||M&&C.mentionState.active)return;let t=null==S?void 0:S.storage["slash-command-suggestion"];(null==t||!t.isActive||null==t||!t.hasVisibleItems)&&(E||e.shiftKey||e.altKey||e.nativeEvent.isComposing||(0,U.Fr)()&&!e.metaKey&&!e.ctrlKey||(e.preventDefault(),u(e)))},[u,E,M,C.mentionState.active,null==S?void 0:S.storage]);return(0,s.jsxs)(na.Provider,{value:{setOverrideSubmit:I},children:[(0,s.jsx)(s5.$Z,{className:(0,f.A)("max-h-96 w-full overflow-y-auto font-large break-words transition-opacity duration-200","bottom"===p?"min-h-[1.5rem]":"min-h-[3rem]",!(null==S?void 0:S.isEditable)&&"opacity-60",k,a),editor:S,onKeyDownCapture:T}),M&&C.mentionState.active&&C.mentionState.position&&(0,s.jsx)(s$,{options:C.mentionState.options,onSelect:C.handleMentionSelect,onClose:C.handleDropdownClose,position:C.mentionState.position,selectedIndex:C.mentionState.selectedIndex})]})});nD.displayName="PromptInput";var nO=a(0x229407f5a);let nP=(0,s.jsx)(em.JtL,{}),nL=(0,s.jsx)(em.Nw1,{});var nF=a(0x176ac88f);let nz=(0,d.createContext)(void 0);function nU(e,t){let a=t+1;for(;a<e.length&&"separator"===e[a].type;)a++;return a<e.length?a:t}function nG(e,t){let a=t-1;for(;a>=0&&"separator"===e[a].type;)a--;return a>=0?a:t}function nY(e){let t=e.findIndex(e=>"separator"!==e.type);return t>=0?t:0}function nH(e){var t;return"button"===e.type||"checkbox"===e.type&&(null==(t=e.closeOnClick)||t)}function nK(e){let{children:t,items:a,onClose:n,resetKey:l}=e,[i,r]=(0,d.useState)(0),[o,c]=(0,d.useState)(null),[u,m]=(0,d.useState)(-1),[x,f]=(0,d.useState)("keyboard"),[p,h]=(0,d.useState)(!1),g=(0,nF.Z)(l);return(0,d.useEffect)(()=>{l!==g&&r(nY(a))},[l,g,a]),(0,d.useEffect)(()=>{let e=a[i];if(e&&"submenu"===e.type){var t;let a=null!=(t=e.label)?t:"";if(o!==a){let e=setTimeout(()=>{c(a),m(-1)},150);return()=>clearTimeout(e)}}else c(null)},[i,a,o]),(0,d.useEffect)(()=>{let e=e=>{var t,s,l;"Escape"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),n()),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"].includes(e.key)&&(f("keyboard"),h(!1),e.preventDefault(),e.stopImmediatePropagation());let d=a[i],c=o&&u>=0,x=(null==d?void 0:d.type)==="submenu"?d.items:[];if("ArrowDown"===e.key)c?m(nU(x,u)):r(nU(a,i));else if("ArrowUp"===e.key)c?m(nG(x,u)):r(nG(a,i));else if("ArrowRight"===e.key)(null==d?void 0:d.type)==="submenu"&&o===(null!=(t=d.label)?t:"")&&m(nY(x));else if("ArrowLeft"===e.key)u>=0&&m(-1);else if("Enter"===e.key)if(c){let e=x[u];e&&"separator"!==e.type&&"submenu"!==e.type&&"search-input"!==e.type&&"loading"!==e.type&&(null==(s=e.onAction)||s.call(e),nH(e)&&n())}else{let e=a[i];e&&"separator"!==e.type&&"loading"!==e.type&&("submenu"===e.type?m(nY(e.items)):"search-input"!==e.type&&(null==(l=e.onAction)||l.call(e),nH(e)&&n()))}};return document.addEventListener("keydown",e,!0),()=>document.removeEventListener("keydown",e,!0)},[a,i,o,u,n]),(0,s.jsx)(nz.Provider,{value:{items:a,onClose:n,setActiveItemById:e=>{let t=a.findIndex(t=>"label"in t&&t.label===e);t>=0&&r(t),f("mouse")},activeIndex:i,submenuOpen:o,submenuActiveIndex:u,setSubmenuOpen:c,setSubmenuActiveIndex:m,interactionMode:x,hasMouseMoved:p,setHasMouseMoved:h},children:t})}function nV(){let e=(0,d.useContext)(nz);if(!e)throw Error("useSlashCommandMenu must be used within SlashCommandMenuProvider");return e}var nW=a(0x18c856b49),nB=a(0x698cb19f),nJ=a(0x19b73ecad);function nq(e){let{reference:t,placement:a="top-start",horizontalOffset:n=-16,verticalOffset:l=10,usePortal:i=!1,onClickOutsideHandler:r,children:o,disableFlip:c=!1}=e,[u,m]=(0,d.useState)(void 0),x=(0,d.useMemo)(()=>({getBoundingClientRect:()=>"function"==typeof t?t():t||new DOMRect}),[t]),{refs:f,floatingStyles:p}=(0,nW.we)({placement:a,middleware:[(0,nB.cY)({mainAxis:l,crossAxis:n}),...c?[]:[(0,nB.UU)()],(0,nB.BN)({padding:8}),(0,nB.Ej)({apply(e){let{availableHeight:t}=e;m(t-16)},padding:8})],whileElementsMounted:nJ.ll}),h=(0,ao.L)(()=>{r&&r()},["mousedown"]);(0,d.useLayoutEffect)(()=>{f.setReference(x)},[f,x]);let g=(0,s.jsx)("div",{ref:e=>{f.setFloating(e),h&&(h.current=e)},role:"menu",style:{...p,maxHeight:u?"".concat(u,"px"):void 0},className:"z-dropdown bg-bg-000 backdrop-blur-xl rounded-xl border-0.5 border-border-200 shadow-[0px_2px_8px_0px_hsl(var(--always-black)/8%)] dark:shadow-[0px_2px_8px_0px_hsl(var(--always-black)/24%)] p-1.5 w-60 max-h-96 overflow-y-auto",children:o});return i?(0,aD.createPortal)(g,document.body):g}function nX(){return(0,s.jsx)("div",{className:"h-[0.5px] bg-border-300 my-1.5 mx-2"})}function nZ(e){let{items:t,activeIndex:a,isInSubmenu:n=!1}=e;return t&&0!==t.length?(0,s.jsx)("div",{className:"flex flex-col",children:t.map((e,t)=>{if("separator"===e.type)return(0,s.jsx)(nX,{},e.label);if("loading"===e.type)return null;let l="label"in e?e.label:"item-".concat(t);return(0,s.jsx)(n$,{item:e,index:t,isActive:t===a,isInSubmenu:n},l)})}):null}let n$=(0,d.memo)(function(e){var t,a;let{item:n,index:l,isActive:i,isInSubmenu:r=!1}=e,{onClose:o,submenuOpen:c,setActiveItemById:u,setSubmenuActiveIndex:m,submenuActiveIndex:x,interactionMode:p,hasMouseMoved:h,setHasMouseMoved:g}=nV(),b=(0,d.useRef)(null),v="search-input"!==n.type&&null!=(t=n.label)?t:"",y=("checkbox"===n.type||"toggle"===n.type)&&n.checked,j="checkbox"!==n.type&&"toggle"!==n.type||null==(a=n.closeOnClick)||a,w=h&&"mouse"===p,M=c===v&&x>=0;return((0,d.useEffect)(()=>{i&&"keyboard"===p&&b.current&&b.current.scrollIntoView({block:"nearest",inline:"nearest"})},[i,p]),"search-input"===n.type)?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{ref:b,role:"menuitem",tabIndex:-1,onMouseEnter:()=>{h||g(!0),r?m(l):u(v)},onMouseDown:e=>{e.stopPropagation()},className:(0,f.A)("group flex items-start gap-2 overflow-clip pl-2 pr-1.5 py-1.5 rounded-lg font-base cursor-pointer select-none",i&&y&&"bg-accent-secondary-100/10",i&&!y&&!M&&"bg-bg-200",i&&!y&&M&&"bg-bg-100",i&&!y&&w&&"hover:bg-bg-200",y?"text-accent-secondary-100":"text-text-300",w&&y&&"hover:bg-accent-secondary-100/10",w&&!y&&"hover:bg-bg-200",i&&y&&"active:bg-accent-secondary-100/20",i&&!y&&"active:bg-bg-300"),onClick:()=>{var e;"submenu"!==n.type&&(null==(e=n.onAction)||e.call(n),("button"===n.type||("checkbox"===n.type||"toggle"===n.type)&&j)&&o&&o())},children:[(0,s.jsx)("div",{className:"size-5 flex items-center justify-center",children:n.icon}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsx)("span",{children:n.label}),n.subtitle&&(0,s.jsx)("span",{className:(0,f.A)("font-small",y?"text-accent-secondary-200/75":"text-text-500"),children:n.subtitle})]}),"button"===n.type&&n.suffix&&(0,s.jsx)("div",{className:"flex items-center h-5 text-text-500 font-small",children:n.suffix}),("checkbox"===n.type||"toggle"===n.type)&&!j&&(0,s.jsx)("div",{className:"flex items-center h-5",children:(0,s.jsx)(eJ.j,{readOnly:!0,size:"small",checked:y})}),"checkbox"===n.type&&j&&y&&(0,s.jsx)(em.Jlk,{size:20,className:"text-accent-secondary-100"}),"submenu"===n.type&&(0,s.jsx)("div",{className:"h-5 flex items-center",children:(0,s.jsx)(em.K3R,{size:14,className:"text-text-500"})})]}),"submenu"===n.type&&c===v&&(0,s.jsx)(nq,{reference:b.current?b.current.getBoundingClientRect():null,placement:"right-start",horizontalOffset:-8,verticalOffset:0,usePortal:!0,children:(0,s.jsx)(nZ,{items:n.items,activeIndex:x,isInSubmenu:!0})})]})});function nQ(e){let{clientRect:t}=e,{onClose:a,items:n,activeIndex:l}=nV();return(0,s.jsx)(nq,{reference:t,onClickOutsideHandler:a,disableFlip:!0,children:(0,s.jsx)(nZ,{items:n,activeIndex:l})})}function n0(e){var t,a;let{editor:n,query:l}=e,[i,r]=(0,d.useState)(null),[o,c]=(0,d.useState)(!1),u=(0,d.useRef)(null);if((0,d.useLayoutEffect)(()=>{if(!n||!u.current)return void c(!1);let{from:e}=n.state.selection;if(e<n.state.doc.content.size-2){r(null),c(!1);return}let t=n.view.coordsAtPos(e);if(!t)return void c(!1);let a=t.left+2;r({top:t.top+(t.bottom-t.top)/2,left:a});let s=n.view.dom,l=null==s?void 0:s.parentElement;if(l){let e=l.getBoundingClientRect(),t=u.current.offsetWidth;c(e.right-a>=t+8)}else c(!1)},[n,l]),""!==l)return null;let m=i&&o;return(0,aD.createPortal)((0,s.jsx)("span",{ref:u,className:"absolute -translate-y-1/2 text-text-500/75 font-large pointer-events-none select-none z-50",style:{top:null!=(t=null==i?void 0:i.top)?t:0,left:null!=(a=null==i?void 0:i.left)?a:0,visibility:m?"visible":"hidden"},children:(0,s.jsx)(X.A,{defaultMessage:"Type to filter",id:"YHS8McfgFb"})}),document.body)}function n1(e,t){var a,s;if("separator"===e.type||"search-input"===e.type||"loading"===e.type)return!1;let n=(null!=(s=e.label)?s:"").toLowerCase().includes(t),l="subtitle"in e&&(null==(a=e.subtitle)?void 0:a.toLowerCase().includes(t));return n||!!l}function n2(e){let{placement:t,clientRect:a,editor:n,range:l,onClose:i,query:r}=e,o=(0,ed.st)(),c=(0,d.useRef)(!1),{items:u}=(e=>{let{placement:t}=e,a=(0,G.A)(),{conversation:n}=(0,W.lE)(),l=(0,tM.K)(),i=tC(),r=tT(),o=tW(),{items:c}=tu({includeConnectedOnly:!0}),u=tz(),m=tH(t),x=(0,e3.mL)(),f=(0,en.Z3)((null==n?void 0:n.id)||null),{model:p=f}=(0,w.oM)(),h=(0,v.vP)("paprika_mode"),g=(0,eg.j)()(p),{toggleConversationSetting:b}=(0,v.rX)({source:"slashCommandMenu"});return{items:(0,d.useMemo)(()=>{if(x){let e=[m];return c.length>0&&e.push({type:"submenu",label:a.formatMessage({defaultMessage:"Connectors",id:"2mMJRvsAg1"}),icon:nL,items:c}),e}let e=[m];return l&&i.length>0&&e.push({type:"submenu",icon:nP,label:a.formatMessage({defaultMessage:"Add to project",id:"+mqxxzVczn"}),items:i}),e.push({type:"separator",label:"separator-1"}),r&&e.push(r),o&&e.push(o),g&&e.push({type:"checkbox",label:a.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),icon:(0,s.jsx)(em.Sw4,{size:16}),checked:!!h,closeOnClick:!0,onAction:()=>{b("paprika_mode",h?null:"extended")}}),u&&e.push(u),c.length>0&&(e.push({type:"separator",label:"separator-2"}),e.push({type:"submenu",label:a.formatMessage({defaultMessage:"Connectors",id:"2mMJRvsAg1"}),icon:nL,items:c})),e},[x,l,i,a,r,o,h,g,b,u,c,m])}})({placement:t});(0,d.useEffect)(()=>{c.current||(c.current=!0,o.track({event_key:"claudeai.slash_command_menu.opened"}))},[o]);let m=(0,d.useMemo)(()=>{if(!r)return u.filter(e=>"submenu"!==e.type||e.items.length>0);let e=r.trim().toLowerCase();if(!e)return[];let t=[];return u.forEach(a=>{n1(a,e)&&t.push(a),"submenu"===a.type&&a.items.forEach(a=>{n1(a,e)&&t.push(a)})}),t},[u,r]),x=(0,d.useCallback)(e=>{if("separator"===e.type)return e;if("submenu"===e.type)return{...e,items:e.items.map(e=>x(e))};if("search-input"===e.type||"loading"===e.type)return e;let t=e.onAction;return{...e,onAction:()=>{var a,s;o.track({event_key:"claudeai.slash_command_menu.item_selected",item_label:null!=(a=e.label)?a:"",item_type:e.type}),null==t||t(),("button"===e.type||"checkbox"===e.type&&(null==(s=e.closeOnClick)||s))&&(n.chain().focus().deleteRange(l).run(),i())}}},[o,n,i,l]),f=(0,d.useMemo)(()=>m.map(e=>x(e)),[m,x]);(0,d.useEffect)(()=>{n&&n.view.dom.focus()},[n]);let p=f.length>0;return((0,d.useEffect)(()=>{let e=n.storage["slash-command-suggestion"];e&&(e.hasVisibleItems=p)},[n,p]),p)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n0,{editor:n,query:r||""}),(0,s.jsx)(nK,{items:f,onClose:i,resetKey:r,children:(0,s.jsx)(nQ,{clientRect:a})})]}):null}n$.displayName="SlashCommandMenuItem";let n5=new sQ.hs("slash-command-suggestion"),n8=s0.YY.create({name:"slash-command-suggestion",addOptions:()=>({placement:"onpage"}),addStorage:()=>({isActive:!1,justClosed:!1,hasVisibleItems:!1}),addProseMirrorPlugins(){let e,t;return[(0,nO.Ay)({editor:this.editor,pluginKey:n5,char:"/",allowSpaces:!0,...(e=this.options.placement,t=this.editor,{items:()=>[{}],command:()=>{},allow:e=>{let{state:a,range:s}=e,n=t.storage["slash-command-suggestion"];if(null==n?void 0:n.justClosed)return!1;let l=a.doc.textBetween(s.from,s.to,"");return!(l.startsWith("/")?l.slice(1):l).startsWith(" ")},render:()=>{let a=null,s=null,n=t=>({placement:e,clientRect:t.clientRect,editor:t.editor,range:t.range,query:t.query,onClose:()=>(0,nO.Pn)(t.editor.view,n5)});return{onStart:e=>{e.editor.storage["slash-command-suggestion"].isActive=!0,a=(s=new s5.NV(n2,{props:n(e),editor:e.editor})).element,document.body.appendChild(a)},onUpdate:e=>{null==s||s.updateProps(n(e))},onKeyDown:e=>{let{event:a,view:s}=e;if("Escape"===a.key)return(0,nO.Pn)(s,n5),!0;let n=t.storage["slash-command-suggestion"];return!!(null==n?void 0:n.hasVisibleItems)&&("Enter"!==a.key||!a.shiftKey)&&("Enter"===a.key||"ArrowUp"===a.key||"ArrowDown"===a.key)},onExit:e=>{let t=e.editor.storage["slash-command-suggestion"];t.isActive=!1,t.justClosed=!0,setTimeout(()=>{t.justClosed=!1},100),s&&(s.destroy(),s=null),(null==a?void 0:a.parentNode)&&(a.parentNode.removeChild(a),a=null)}}}})})]}});var n3=a(0x120e6a4a3);let n4=(0,d.forwardRef)((e,t)=>{var a;let{promptInputSsrEnabled:n,isTipTapReady:l,promptInputSsrTextareaRef:c,onSubmit:u,onReady:x,placement:f,placeholder:p,fetchInputAutocompletion:h,className:g}=e,{prompt:b,tipTapEditorState:v}=(0,W.QT)(),{setTipTapEditorState:y,setFiles:j}=(0,W.Jy)((0,nt.k)(e=>({setTipTapEditorState:e.setTipTapEditorJSON,setFiles:e.setFiles}))),{handleMentionAttachments:w,handleMentionDeleted:M}=function(e){let{setFiles:t,createMessageFileFromBase64:a}=e,s=(0,G.A)(),{activeOrganization:n}=(0,i.YL)(),l=(0,aF.mn)(),{addError:c}=(0,r.Y)(),u=(0,d.useRef)(new Map);return{handleMentionAttachments:(0,d.useCallback)(async(e,i)=>{let r=[];for(let e of i)if(e.extracted_content)try{var d;let t=await a(e.extracted_content,e.file_type,null!=(d=null==n?void 0:n.uuid)?d:"",l,e.file_name);r.push(...t)}catch(e){o.v.error(o.u.DESKTOP_API,"Failed to upload mention attachment",{error:e}),c(s.formatMessage({defaultMessage:"Failed to upload attachment. You can try again.",id:"lG4VIx4FDG"}),{error:e,messageForLogging:"Failed to upload attachment. You can try again."})}let m=r.map(e=>e.file_uuid);u.current.set(e,m),t(e=>{let t=new Set(e.map(e=>e.file_uuid));return[...e,...r.filter(e=>!t.has(e.file_uuid))]})},[t,n,l,a,c,s]),handleMentionDeleted:(0,d.useCallback)(e=>{let a=u.current.get(e);a&&(t(e=>e.filter(e=>!a.includes(e.file_uuid))),u.current.delete(e))},[t])}}({setFiles:j,createMessageFileFromBase64:n3.bl}),k=(0,m.fS)("claudeai-slash"),_=(0,d.useMemo)(()=>k?[n8.configure({placement:f})]:[],[f,k]),A=n&&!l&&(null==(a=c.current)?void 0:a.value)?{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:c.current.value}]}]}:v;return(0,s.jsx)(nD,{ref:t,prompt:b,tipTapEditorState:A,setTipTapEditorState:y,onSubmit:u,onReady:x,placement:f,placeholder:p,fetchInputAutocompletion:h,className:g,onMentionAttachments:w,onMentionDeleted:M,extraExtensions:_})});n4.displayName="PromptInputWithState";let n6=(0,d.forwardRef)((e,t)=>{let{disabled:a,placement:C,placeholder:N,onSubmit:I,onReady:T,onRetry:R,enableScreenDrop:D=!1,disableDropZone:L=!1}=e,z=(0,W.QN)(),U=(0,M.c)(),K=(0,W.N3)(),{previewPrompt:V,setPrompt:eo,setAttachments:ed,setFiles:ec,attachments:eu,files:em,syncSourceUuids:ex,setSyncSourceUuids:ef}=(0,W.Jy)(e=>({previewPrompt:e.previewPrompt,setPrompt:e.setPrompt,setAttachments:e.setAttachments,setFiles:e.setFiles,attachments:e.attachments,files:e.files,syncSourceUuids:e.syncSourceUuids,setSyncSourceUuids:e.setSyncSourceUuids})),{isUploadingDriveSync:ep,isUploadingGithubSync:eh,sendMessage:eg,conversation:eb,isChatSyncing:ev,isProjectSyncing:ey,isSending:ej,focusInput:ew,promptInputRef:eM,willRedirectOnSubmit:ek,hasBlockingWarning:e_,isUploadingFile:eA,validateMaxUploadLimit:eC,onPasteFiles:eN,uploadInputProps:eS,hasAttachments:eE,isNewConversation:eI,isImprovingPrompt:eT,currentCompassTask:eR}=(0,w.oM)(),{incognitoModeEnabled:eD}=(0,E.S)(),{toggleConversationSetting:eO}=(0,v.rX)({source:"extendedThinkingKeyBinding"}),eP=(0,v.vP)("paprika_mode");!function(e){let{matchShortcut:t}=(0,ei.wk)("extended_thinking");(0,ei.Kh)("extended_thinking",e),(0,d.useEffect)(()=>{if(!e)return;let a=a=>{if(t(a))return a.preventDefault(),a.stopPropagation(),e(),!1};return document.addEventListener("keydown",a,!0),()=>document.removeEventListener("keydown",a,!0)},[t,e])}((0,d.useCallback)(()=>{eO("paprika_mode",eP?null:"extended")},[eO,eP])),(0,d.useImperativeHandle)(t,()=>({setContent:(e,t,a)=>{eo(e,{forceUpdateTiptap:!0}),ed("function"==typeof t?t(eu):t),ec("function"==typeof a?a(em):a)},sendMessage:eg,setAttachments:e=>{ed("function"==typeof e?e(eu):e)},getAttachments:()=>eu})),(()=>{let{setPrompt:e,setAttachments:t,setFiles:a}=(0,W.Tc)(e=>({setPrompt:e.setPrompt,setAttachments:e.setAttachments,setFiles:e.setFiles}),"useSavePromptOnFail"),{failedStreamRetryData:s,setFailedStreamRetryData:n}=(0,en.x)();(0,d.useEffect)(()=>{null!==s&&(e(s.prompt),t(s.attachments),a(s.files),n(null))},[s,t,n,a,e])})();let{fetchInputAutocompletion:eL}=(0,b.$z)(null==eb?void 0:eb.id),{handleDriveDocUrlPaste:eF,parseDriveUrl:ez}=(()=>{let e=(0,W.BN)(),{setSyncSourceUuids:t}=(0,W.Jy)(e=>({setSyncSourceUuids:e.setSyncSourceUuids})),{isAtMaxNumUploads:a,setIsUploadingDriveSync:n}=(0,w.oM)(),l=(0,$.LP)(),{addError:o}=(0,r.Y)(),c=(0,G.A)(),{activeOrganization:u}=(0,i.YL)(),m=null==u?void 0:u.uuid,x=(0,es.Uz)({type:"remote"}),f=(0,ee.kO)(),p=(0,Z.p9)(),h=null==x?void 0:x.find(e=>e.url&&ee.TI[e.url]===q.v8.GDRIVE),b=!h&&f,{mutate:v}=(0,g.EF)({onMutate:()=>{n(!0)},onSuccess:e=>{t(t=>[...t,e.uuid]),n(!1)},onError:e=>{n(!1),o((0,ea.J)(e),{error:e,errorContext:{tags:{source:"drive_url_paste_sync_create"}}})},meta:{noToast:!0}}),{mutateAsync:y}=(0,Q.Ax)(),{isDriveAuthenticated:j,initDriveAuth:M}=(0,$.cI)({callerIdentifier:"chat-input",handleAuthSuccess:()=>{let t=e.getState().getPrompt().match(/(https?:\/\/[^\s]+)/gi)||[],a=h?et.V7:et.$g;for(let e of t){let t=a(e);t&&k(t,e,!0)}}}),k=(0,d.useCallback)(async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!b&&(l||i)){if(h&&h.isConnecting)return void o(c.formatMessage({defaultMessage:"Google Drive is still connecting. Please wait a moment and try again.",id:"TjIapq8P8R"}),{errorContext:{tags:{source:"drive_connector_connecting"}},messageForLogging:"Google Drive is still connecting. Please wait a moment and try again."});if(!j&&!i)return void o((0,s.jsx)("span",{children:(0,s.jsx)(X.A,{defaultMessage:"<button>Authenticate</button> to paste link as attachment",id:"85AH1hyv0s",values:{button:e=>(0,s.jsx)("button",{className:"underline",onClick:M,children:e})}})}));if(a)return void o(c.formatMessage({defaultMessage:"You can add at most {maxUploads, plural, one {# attachment} other {# attachments}} to a message.",id:"wvnM4s8976"},{maxUploads:J.XA.maxTotalUploadsPerMessage}),{messageForLogging:"You can add at most {maxUploads, plural, one {# attachment} other {# attachments}} to a message."});if(h){let e=h.resources.find(e=>e.uri===t);if(e)return void v({sync_source_type:q.v8.MCP_RESOURCES,sync_source_config:{server_uuid:h.uuid,resource:{...e}}});if(p&&!(0,es.HG)(h.uuid,p)&&m){n(!0);try{let e=await y({resource_uri:t,server_uuid:h.uuid});if(e){let t=e.resource;v({sync_source_type:q.v8.MCP_RESOURCES,sync_source_config:{server_uuid:h.uuid,resource:{...t}}})}n(!1)}catch(e){n(!1),o("Failed to fetch. You can try again.",{error:e,errorContext:{tags:{action:"get_resource_for_drive_doc_paste"}}})}}else try{n(!0);let e=(0,es.KU)(h.uuid),a=await e.readResource({uri:t});if(a.contents.length>0){var r;let e={...a.contents[0]};v({sync_source_type:q.v8.MCP_RESOURCES,sync_source_config:{server_uuid:h.uuid,resource:{...e,name:null!=(r=e.name)?r:"Unknown Title"}}})}n(!1)}catch(e){n(!1),o("Failed to fetch. You can try again.",{error:e,errorContext:{tags:{action:"get_resource_for_drive_doc_paste"}}})}}else v({sync_source_type:q.v8.GDRIVE,sync_source_config:{uri:e}})}},[b,l,j,a,h,p,m,y,o,M,c,v,n]);return{handleDriveDocUrlPaste:k,parseDriveUrl:h?et.V7:et.$g}})(),eU=function(e,t,a,s,n,l){let[i,r]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{let e=e=>{"Shift"===e.key&&r(!0)},t=e=>{"Shift"===e.key&&r(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]),(0,d.useCallback)(r=>{var o,d,c;let u=(null==(d=r.clipboardData)||null==(o=d.files)?void 0:o.length)>0,m=null==(c=r.clipboardData)?void 0:c.getData("text/plain"),x=null==m?void 0:m.length;if(x&&!u){let e=n(m);e&&s(e,m)}if(r.clipboardData.types.includes("text/plain")&&r.clipboardData.types.includes("text/html")&&r.clipboardData.types.includes("image/png")){let e=r.clipboardData.getData("text/html");e.includes(' class="Mso')&&e.includes("<o:")&&r.clipboardData.getData("text/plain")&&(u=!1)}if(u){t({newUploads:Array.from(r.clipboardData.files)})&&a(r.clipboardData.files),r.preventDefault();return}if(!t({numNewPotentialAttachments:1,showError:!1}))return;let f=new Blob([m]).size;l||!x||f<4096||i||(r.preventDefault(),e(e=>[...e,{file_name:"",file_size:f,file_type:"txt",extracted_content:m}]))},[t,e,a,s,n,i,l])}(ed,eC,eN,eF,ez,(0,e1.lS)()),eG=(0,d.useCallback)(e=>{var t,a;(null==eM||null==(a=eM.current)||null==(t=a.getEditor())?void 0:t.isFocused)&&eU(e)},[eU,eM]),eY=(0,B.U)(z),eH=(0,x.q)(),eK=(0,er.Zx)(null==eb?void 0:eb.id),eV=!!(eb&&eb.isSampling&&!eK),eW=a||ej||K&&0===eu.length&&0===em.length&&0===ex.length||eA||ep||eh||ev||ey||e_||eY||eV||!!eR,eB=(0,d.useCallback)(async()=>{!eW&&(await eg(),I&&I())},[eW,I,eg]),eJ=(0,d.useCallback)(e=>{let t=e.target;"BUTTON"===t.tagName||t.closest("button")||t.closest("[role]")||t.closest("a")||t.closest("input")||t.closest("select")||t.closest("textarea")||ew()},[ew]),eq=(0,d.useRef)(null),[eX]=(0,c.d)(),eZ=(null==eb?void 0:eb.id)||eX,e$=(0,u.u9)(),{deleteFile:eQ,deletingFileUuid:e0}=function(e){let{conversationUuid:t,wiggleEnabled:a}=e,{activeOrganization:s}=(0,i.YL)(),{addError:n}=(0,r.Y)(),[c,u]=(0,d.useState)(null),m=(0,d.useRef)(!1);return{deleteFile:(0,d.useCallback)(async e=>{if(!a)return!1;if(!t||!(null==s?void 0:s.uuid))return o.v.error(o.u.CHAT_COMPLETION,"wiggle_file_delete_skipped_missing_conversation",{fileUuid:e,conversationUuid:t,orgUuid:null==s?void 0:s.uuid}),!1;if(m.current)return!1;m.current=!0,u(e);try{return await (0,l.lm)(e,{orgUuid:s.uuid,conversationUuid:t,wiggleEnabled:!0}),!0}catch(t){return o.v.error(o.u.CHAT_COMPLETION,"wiggle_file_delete_failed",{error:t,fileUuid:e}),n("File couldn't be deleted. You can try again.",{error:t,errorContext:{tags:{source:"file_delete"}}}),!1}finally{m.current=!1,u(null)}},[t,a,null==s?void 0:s.uuid,n]),deletingFileUuid:c}}({conversationUuid:eZ,wiggleEnabled:null!=e$&&e$}),e2=(0,g.NY)(ex).map((e,t)=>{let{data:a}=e;return{syncSource:a,uuid:ex[t]}}),e5=(0,s.jsx)(p.N,{initial:!1,children:eE&&(0,s.jsx)(h.P.div,{className:(0,f.A)("overflow-hidden",!U&&"rounded-b-2xl"),initial:{height:0},animate:{height:"auto"},exit:{height:0},children:(0,s.jsx)("div",{className:(0,f.A)("p-3.5 overflow-x-auto",U?"pb-2.5":"rounded-b-2xl border-t-0.5 border-border-300/25 bg-bg-100"),children:(0,s.jsx)(j.B,{isUploadingFile:eA,isUploadingSync:ep||eh,attachments:eu,files:em,syncSourceResults:e2,deletingFileUuid:null!=e0?e0:void 0,onRemoveAttachment:e=>{ed(t=>t.filter((t,a)=>a!==e))},onRemoveFile:async e=>{let t=em[e];t&&await eQ(t.file_uuid)&&ec(t=>t.filter((t,a)=>a!==e))},onRemoveSyncSource:e=>{ef(t=>t.filter(t=>t!==e))}})})},"attachments")}),e8=(0,el.h)(null==eb?void 0:eb.id,null==eb?void 0:eb.model),e3=(0,n.WZ)(null==eb?void 0:eb.id),e4=(0,m.fS)("hey_hello_hi");(0,m.fS)("yukon_gold_nudge");let e6=(0,m.fS)("chat-ui-core"),e9=Y({placeholder:N,isNewConversation:eI}),{isTipTapReady:e7,promptInputSsrEnabled:te,promptInputSsrTextareaRef:tt,handleTipTapReady:ta,handleKeyDownCapture:ts}=O(),tn=!te&&!eH,tl=!te||eH;if(tn)return(0,s.jsx)(H,{placement:C,textareaRef:tt});if(e4&&eb&&e8&&"refusal"===e8.stopReason&&e8.fallback&&e8.lastMessage&&eb.id&&eb.model)return(0,s.jsx)(y.sF,{model:eb.model,conversationUuid:eb.id,lastMessage:e8.lastMessage,fallback:e8.fallback,onRetryWithFallback:async()=>{if(!e8.lastMessage.parent_message_uuid)return;let{model:e}=await e3.mutateAsync();null==R||R(e8.lastMessage.parent_message_uuid,e)}});let ti=V&&K;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(F,{onKeyDownCapture:ts,children:[te&&(0,s.jsx)(P,{children:(0,s.jsx)(H,{placement:C,textareaRef:tt,hidden:eH})}),tl&&(0,s.jsx)(P,{children:(0,s.jsxs)(A,{onPasteCapture:eG,children:[(0,s.jsx)("input",{ref:eq,id:(0,tG.h)(C),"data-testid":"file-upload","aria-hidden":"true",tabIndex:-1,className:"absolute -z-10 h-0 w-0 overflow-hidden opacity-0 select-none",...eS}),"bottom"===C&&(0,s.jsxs)("div",{className:"px-3 md:px-2",children:[(0,s.jsx)(y.Qg,{placement:C,onRetry:(e,t)=>null==R?void 0:R(e,t)}),""]}),(0,s.jsxs)(_,{onClick:eJ,className:(0,f.A)("border border-transparent",ek&&ej&&"animated-loading-background",eT?"transition-all duration-500 ring-1 ring-border-300/50 dark:ring-border-300/50":"",eD?"border-dashed bg-clip-padding !border-border-200 shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%)]":"shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-300)/0.15)] hover:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] hover:focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)]"),children:[U&&e5,(0,s.jsxs)(S,{children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n4,{ref:eM,onSubmit:eB,onReady:e=>{ta(e.editor),null==T||T()},placement:C,placeholder:e9,fetchInputAutocompletion:eL,className:(0,f.A)(ti?"!opacity-0":void 0),promptInputSsrEnabled:te,isTipTapReady:e7,promptInputSsrTextareaRef:tt}),(0,s.jsx)(p.N,{children:ti?(0,s.jsx)(h.P.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"self-start absolute pointer-events-none inset-0 text-text-500 line-clamp-2",children:V}):eT&&!K?(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none overflow-hidden rounded",children:(0,s.jsx)(h.P.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-always-white/20 dark:via-always-white/10 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:1.5,ease:"easeInOut",repeat:1/0}})}):null})]}),(0,s.jsx)(aE,{placement:C,isDisabled:eW,skipInitialAnimation:te&&!e7})]}),(0,s.jsx)(aO,{disabled:L,enableScreenDrop:D}),!U&&e5]}),"bottom"!==C&&(0,s.jsxs)("div",{className:"px-3 md:px-2",children:[(0,s.jsx)(y.Qg,{placement:C,onRetry:(e,t)=>null==R?void 0:R(e,t)}),""]}),"bottom"===C&&!e6&&(0,s.jsx)(k,{})]})})]}),(0,s.jsx)(sZ,{})]})});n6.displayName="ChatInputContent";let n9=(0,d.forwardRef)((e,t)=>{let{disabled:a,placement:n,placeholder:l,onSubmit:i,onReady:r,onRetry:o,enableScreenDrop:d=!1,disableDropZone:c=!1,sessionMcpServers:u}=e;return(0,s.jsx)(e5.Xx,{placement:n,sessionMcpServers:u,children:(0,s.jsx)(n6,{ref:t,disabled:a,placement:n,placeholder:l,onSubmit:i,onReady:r,onRetry:o,enableScreenDrop:d,disableDropZone:c})})});n9.displayName="ChatInput"},0x1e61aab5a:(e,t,a)=>{a.d(t,{I:()=>s});var s=function(e){return e.CREATE="create",e.CREATE_MANUALLY="create_manually",e.LIST="list",e.EDIT="edit",e}({})},0x1e9786782:(e,t,a)=>{a.d(t,{w:()=>s.w});var s=a(0x2114a8a78)},0x1f4bc48d7:(e,t,a)=>{a.d(t,{EY:()=>i});var s=a(0x12c9046cd),n=a(0x14de19ae8),l=a(0x78b33fbd);let i=()=>{let{data:e,...t}=(()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,a=(0,n.h0)(),i=(0,l.useLayer)("trials_freemium"),r=!a&&i.get("free_thinking",!1)&&!!t;return(0,s.Sk)("/api/organizations/".concat(t,"/feature_limits"),{queryKey:["FEATURE_LIMITS",t],enabled:r,staleTime:3e5})})(),a=null==e?void 0:e.limits.find(e=>"thinking"===e.feature);return{...t,data:a}}},0x1f59f8010:(e,t,a)=>{a.d(t,{V:()=>o});var s=a(0x22102fd88);a(0x1b813d90);var n=a(0xfc89b4a4),l=a(0x1e841cc7d),i=a(0x1c12b3087),r=a(0x1f92f9b94);function o(e){let{uuid:t,syncSource:a,onRemove:o,isEditable:d}=e,{mutateAsync:c}=(0,l.Ql)(),u=(0,n.useCallback)(()=>{c(t),null==o||o()},[c,t,o]),{projectUuid:m}=(0,i.lE)();return(0,s.jsx)(r.br,{location:"chat",projectUuid:m,syncSource:a,handleRemove:d?u:void 0,isEditable:d})}},0x204a5f1d2:(e,t,a)=>{a.d(t,{TW:()=>I,go:()=>E,wU:()=>S});var s=a(0x22102fd88),n=a(0x17aa9d8d7),l=a(0x1e3604791),i=a(0x1065e6d73),r=a(0xf32c56dd),o=a(0x14de19ae8),d=a(0x139b5e710),c=a(0x2471dc42f),u=a(0x252daebb2),m=a(0x183548b63),x=a(0x491d2ca),f=a(0x800328fa),p=a(0x1b370f49d),h=a(0xac309a83),g=a(0x286b4261),b=a.n(g),v=a(0xcaa21d58),y=a(0xfc89b4a4),j=a(0x38e6572),w=a(0x1ab0d1ca1),M=a(0x156c4e43b),k=a(0x111e01ecf);let _=M.Ik({title:M.Yj(),description:M.Yj(),shortDescription:M.Yj().optional(),titleKey:M.Yj().optional(),descriptionKey:M.Yj().optional(),shortDescriptionKey:M.Yj().optional()}),A=M.Ik({preview_feature_uses_artifacts:_.optional(),preview_feature_uses_latex:_.optional(),preview_feature_uses_citations:_.optional(),enabled_artifacts_attachments:_.optional(),enabled_turmeric:_.optional(),enabled_gdrive:_.optional(),enabled_bananagrams:_.optional(),enabled_web_search:_.optional(),enabled_sourdough:_.optional(),enabled_foccacia:_.optional()}),C={},N=(0,y.createContext)({openFeaturePreviewModal:b()}),S=e=>{let{children:t}=e,[a,n]=(0,y.useState)(!1);return(0,s.jsxs)(N.Provider,{value:{openFeaturePreviewModal:()=>n(!0)},children:[t,(0,s.jsx)(m.aF,{modalSize:"xl",isOpen:a,onClose:()=>n(!1),hasCloseButton:!0,title:(0,s.jsx)(j.A,{defaultMessage:"Feature preview",id:"3H/t1552xG"}),children:(0,s.jsx)(I,{})})]})},E=()=>(0,y.useContext)(N);function I(e){let{includeTitle:t}=e,a=function(){let e=(0,h.T9)("fp_menu","features",C,A),t=(0,h.fS)("claudeai_analysis_tool_allowed"),{value:a,source:s}=(0,l.N)({}),n=(0,i.Gh)(),r=(0,h.fS)("wiggle_graduated"),{preview_feature_uses_artifacts:o,enabled_artifacts_attachments:d,preview_feature_uses_latex:c,enabled_turmeric:u,...m}=e,x={...m};return t&&!(a&&"experiment"===s&&o)&&(x.enabled_artifacts_attachments=d),n&&!r&&(x.enabled_monkeys_in_a_barrel={title:"Code execution and file creation",description:"Claude can execute code and create and edit docs, spreadsheets, presentations, PDFs, and data reports."}),x}(),r=Object.keys(a).length>0,{account:d}=(0,o.YL)(),{mutate:c}=(0,n.yJ)(),u=(0,y.useRef)(!1);if((0,y.useEffect)(()=>{if(!(null==d?void 0:d.settings)||u.current)return;u.current=!0;let e=d.settings.enabled_monkeys_in_a_barrel,t=d.settings.preview_feature_uses_artifacts,a=d.settings.enabled_artifacts_attachments;e&&!t&&c({preview_feature_uses_artifacts:!0}),e&&a&&c({enabled_artifacts_attachments:!1})},[null==d?void 0:d.settings,c]),!r)return;let m=(0,s.jsx)(s.Fragment,{children:Object.entries(a).map((e,t)=>{let[a,n]=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[t>0&&(0,s.jsx)("div",{className:"border-t border-border-300"}),(0,s.jsx)(T,{label:a,...n})]},a)})});return t?(0,s.jsxs)(x.XY,{children:[(0,s.jsxs)(x.Kv,{children:[(0,s.jsx)(x.Rx,{children:(0,s.jsx)(j.A,{defaultMessage:"Experimental",id:"GOx7x4mbZd"})}),(0,s.jsx)(x.Xe,{id:"feature-preview",children:(0,s.jsx)(j.A,{defaultMessage:"Preview and provide feedback on upcoming enhancements to our platform. Please note: experimental features might influence Claude’s behavior and some interactions may differ from the standard experience.",id:"TJ0Nj7aQ5C"})})]}),m]}):m}function T(e){var t;let{label:a,...l}=e,m=(0,w.A)(),{track:g}=(0,r.st)(),{addSuccess:b}=(0,d.Y)(),{account:M}=(0,o.YL)(),{mutate:_,isPending:A}=(0,n.yJ)(),{checked:C}=R(a),N=(0,i.t5)(),S="enabled_monkeys_in_a_barrel"===a&&!N,E=(0,o.mV)(),I=(0,h.fS)("claudeai_wiggle_egress_settings"),T=(0,i.ut)(),O=(0,i.UA)(),P=(0,i.EG)(),L=(0,y.useCallback)(()=>{if(!M||S)return;g({event_key:"claudeai.settings.preview_feature.toggled",account_uuid:M.uuid,feature_id:a,action:!0===C?"disable":"enable"});let e=!C;if(b(m.formatMessage({defaultMessage:"{title} {action}",id:"XuGv50sPs9"},{title:l.title,action:C?"disabled":"enabled"})),e){var t,s,n;if("enabled_monkeys_in_a_barrel"===a){let e=null==(t=M.settings)?void 0:t.enabled_artifacts_attachments,a=[];e&&a.push("Analysis Tool"),a.length>0&&b(m.formatMessage({defaultMessage:"Automatically disabled: {features}",id:"7StJBCedWA"},{features:a.join(", ")})),(null==(s=M.settings)?void 0:s.preview_feature_uses_artifacts)||b(m.formatMessage({defaultMessage:"Automatically enabled: Artifacts",id:"v5zt5SRUyk"}))}else"enabled_artifacts_attachments"===a&&(null==(n=M.settings)?void 0:n.enabled_monkeys_in_a_barrel)&&b(m.formatMessage({defaultMessage:"Automatically disabled: Files feature",id:"8T9PGQkYRT"}))}_({[a]:e,..."enabled_monkeys_in_a_barrel"===a&&e&&{enabled_artifacts_attachments:!1,preview_feature_uses_artifacts:!0},..."enabled_artifacts_attachments"===a&&e&&{enabled_monkeys_in_a_barrel:!1}})},[M,g,a,C,b,m,l.title,_,S]);return(0,s.jsxs)("div",{className:"flex flex-col w-full gap-4",children:[(0,s.jsx)(x.ic,{image:(0,s.jsx)(v.default,{src:"/images/feature-preview/square/".concat(null!=(t=D[a])?t:"generic",".png"),style:{objectFit:"cover",width:62,height:62},className:"rounded-lg border border-border-300",width:248,height:248,alt:m.formatMessage({defaultMessage:"Preview image of feature",id:"6VliGZPeZA"})}),primaryText:(0,s.jsx)("span",{id:"feature-".concat(a,"-title"),children:l.titleKey?(0,s.jsx)(u.X5,{id:l.titleKey}):l.title}),secondaryText:(0,s.jsxs)(s.Fragment,{children:[l.descriptionKey?(0,s.jsx)(u.X5,{id:l.descriptionKey}):l.description,"enabled_monkeys_in_a_barrel"===a&&!I&&(0,s.jsx)("span",{className:"text-xs text-text-500",children:(0,s.jsx)(j.A,{defaultMessage:"This feature gives Claude network access to create and analyze files, which has <a>security risks</a>. Monitor chats closely when using this feature.",id:"2tm+lICYTm",values:{a:e=>(0,s.jsx)(f.Y,{href:"https://support.claude.com/en/articles/12111783-create-and-edit-files-with-claude#h_0ee9d698a1",target:"_blank",children:e})}})})]}),action:(0,s.jsx)("label",{className:"cursor-pointer mt-2",children:(0,s.jsx)(p.m,{tooltipContent:S?(0,s.jsx)(j.A,{defaultMessage:"This feature has been disabled by your administrator.",id:"Jpvq2WYysx"}):"enabled_monkeys_in_a_barrel"===a?(0,s.jsx)(j.A,{defaultMessage:"This is an upgrade to the analysis tool. It does not support versioning or remixing of Artifacts.",id:"OT4Z/tnKXZ"}):null,children:(0,s.jsx)("div",{children:(0,s.jsx)(c.j,{checked:!!C,onChange:L,"aria-labelledby":"feature-".concat(a,"-title"),disabled:S},a)})})})}),"enabled_monkeys_in_a_barrel"===a&&C&&!E&&I&&(0,s.jsx)(k.wi,{enabled:T,allowedHosts:O,hostsTemplate:P,onUpdate:_,isPending:A})]})}let R=e=>{var t,a,s,n,r,d,c;let{account:u}=(0,o.YL)(),{value:m,source:x}=(0,l.N)(null!=(n=null==u?void 0:u.settings)?n:{}),f=(0,i.u9)(),p=null!=(r=null==u||null==(t=u.settings)?void 0:t.preview_feature_uses_artifacts)&&r,h="flag"===x&&m||null!=(d=null==u||null==(a=u.settings)?void 0:a.enabled_artifacts_attachments)&&d;return"enabled_monkeys_in_a_barrel"===e?{checked:null!=f&&f}:"enabled_artifacts_attachments"===e?{checked:h}:"preview_feature_uses_artifacts"===e?{checked:p}:{checked:null!=(c=null==u||null==(s=u.settings)?void 0:s[e])&&c}},D={preview_feature_uses_artifacts:"artifacts",preview_feature_uses_latex:"latex",preview_feature_uses_citations:"generic",enabled_artifacts_attachments:"analyse",enabled_turmeric:"turmeric",enabled_gdrive:"google-drive",enabled_web_search:"web-search",enabled_bananagrams:"bananagrams",enabled_foccacia:"foccacia",enabled_sourdough:"sourdough",enabled_monkeys_in_a_barrel:"wiggle"}},0x2174968e5:(e,t,a)=>{a.d(t,{$3:()=>X,ey:()=>F});var s=a(0x22102fd88),n=a(0x226530adf),l=a(0x14a6d5f1),i=a(0x14de19ae8),r=a(0x252daebb2),o=a(0x10f221f41),d=a(0x116e76ca8),c=a(0xac309a83),u=a(0x1b813d90),m=a(0x17f3a2521),x=a(0x88148a10),f=a(0x78b33fbd),p=a(0x4d348f95),h=a(0xfc89b4a4),g=a(0x1ab0d1ca1),b=a(0x1f4bc48d7),v=a(0x1d302b010),y=a(0x24b92fff4),j=a(0x1334f6ecc),w=a(0xdf883ab6),M=a(0x25062734b),k=a(0x4d9fc74e),_=a(0x31c535e9),A=a(0x18175ce17),C=a(0x3769f4df),N=a(0x1ddbde9f),S=a(0x9cb4c2a2),E=a(0x1fb2770f2),I=a(0xf8bd7957),T=a(0x115b4e1b8),R=a(0xe824fb1c),D=a(0x80c59a8d),O=a(0x17774dcd8);let P="inputMenu",L=()=>({isDisabled:!0,tooltip:(0,g.A)().formatMessage({defaultMessage:"Select a different model to use this feature",id:"/9vSDy2Wm0"}),isChecked:!1}),F=e=>{let{actions:t,sessionMcpServers:a}=e,l=(0,g.A)(),r=(0,v.lu)(),d=(0,i.O9)(),c=(0,i.zc)(),u=(0,i.h0)(),m=(0,M.sb)(),f=(0,O.Ob)(),{conversation:h,model:b}=(0,S.oM)(),y=(0,n.Z3)((null==h?void 0:h.id)||null),j=null!=b?b:y,w=(0,p.useRouter)(),k=z({actions:t,currentModel:j}),_=q({sessionMcpServers:a}),A=K({actions:t}),C=V({actions:t}),N=W({currentModel:j,conversation:h}),E=B({currentModel:j,conversation:h}),I=(0,O.gB)(),T=(0,O.lS)();if(I)return A;let R=[...C&&!T?[C]:[],...N&&!T?[N]:[],...E?[E]:[]];k.length&&!T&&(R=R.concat([...R.length?[{key:"divider1",type:"divider",label:""}]:[],...k]));let D=r&&(d||c);return(_.length||D||m)&&(R=R.concat([..._,...m?[{key:"divider2",type:"divider",label:""},{key:"addIntegrations",type:"button",icon:(0,s.jsx)(x.c,{size:16}),label:l.formatMessage({defaultMessage:"Add connectors",id:"2dXigF1Pil"}),tag:u?void 0:f?"upgrade":"pro",onClick:u||!f?t.openMcpDirectoryModal:()=>{window.location.href="/upgrade"}},{key:"manageIntegrations",type:"button",icon:(0,s.jsx)(o.wB_,{size:16}),label:l.formatMessage({defaultMessage:"Manage connectors",id:"cqx+RdJnHp"}),onClick:()=>{w.push("/settings/connectors")}}]:D?[{key:"divider2",type:"divider",label:""},{key:"addIntegrations",type:"button",icon:(0,s.jsx)(x.c,{size:16}),label:l.formatMessage({defaultMessage:"Add connectors",id:"2dXigF1Pil"}),isExternal:!0,onClick:()=>{w.push("/settings/connectors")}}]:[]])),R},z=e=>{let{actions:t,currentModel:a}=e,s=U({currentModel:a}),n=G({currentModel:a}),l=H({actions:t,currentModel:a}),i=Y({currentModel:a});return[...s?[s]:[],...n?[n]:[],...l?[l]:[],...i?[i]:[]]},U=e=>{let{currentModel:t}=e,a=(0,g.A)(),{conversation:n}=(0,S.oM)(),l=(0,i.h0)(),r=(0,O.Ob)(),d=(0,C.Eu)(t),c=(0,C.be)(),u=(0,C.WJ)(),m=(0,C.fy)(n),{toggleSearchTool:x}=(0,T.D$)(n),f=L(),p=Z("web_search");if(!c&&!r)return null;let h=m&&d;return c||!r||l?{key:"webSearch",type:"switch",label:a.formatMessage({defaultMessage:"Web search",id:"x0W7xxxEcv"}),icon:(0,s.jsx)(o.qzq,{size:16}),isChecked:h,onClick:()=>x("enabled_web_search",!h),tag:p,...!u?{isDisabled:!0,tooltip:a.formatMessage({defaultMessage:"This feature has been disabled by your administrator.",id:"Jpvq2WYysx"})}:!d?f:null}:{key:"webSearch",type:"switch",label:a.formatMessage({defaultMessage:"Web search",id:"x0W7xxxEcv"}),icon:(0,s.jsx)(o.qzq,{size:16}),isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}}},G=e=>{let{currentModel:t}=e,a=(0,g.A)(),{conversation:n}=(0,S.oM)(),r=(0,i.h0)(),o=(0,O.Ob)(),{toggleSearchTool:c,toggleConversationSetting:m}=(0,T.D$)(n),x=(0,j.K6)(),f=(0,l.Wq)()(t,"gsuite_tools"),p=(0,j.$f)(n),{isDriveAuthenticated:h,initDriveAuth:b}=(0,j.cI)({callerIdentifier:P,handleAuthSuccess:()=>{m("enabled_bananagrams",!0)}}),v=(0,A.kO)(),y=(0,A.dJ)(u.v8.GDRIVE),{startAuth:w,authBreakdown:M}=(0,A.ob)(u.v8.GDRIVE,{callerIdentifier:P,handleAuthSuccess:()=>{m("enabled_foccacia",!0)}}),k=L(),_=Z("drive_search");if(v&&y&&h||v&&!y||y&&!M.firstParty||!x&&!o)return null;let C={key:"driveSearch",icon:(0,s.jsx)(d.ft,{size:16}),label:a.formatMessage({defaultMessage:"{drive} search",id:"nUykp097rV"},{drive:"Drive"})};if(!x&&o&&!r)return{...C,type:"switch",isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}};if(!h){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{...C,type:"button",isExternal:!0,secondaryText:v?t:e,onClick:()=>{b()},...v?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...f?null:k}}let N=h&&p;return{...C,type:"switch",isChecked:N,onClick:()=>{c("enabled_bananagrams",!N)},tag:_,...f?null:k}},Y=e=>{let{currentModel:t}=e,a=(0,g.A)(),{conversation:n}=(0,S.oM)(),i=(0,O.Ob)(),{toggleSearchTool:r,toggleConversationSetting:o}=(0,T.D$)(n),c=(0,A.Ys)(u.v8.GCAL),m=(0,l.Wq)()(t,"gsuite_tools"),x=(0,A.X0)(u.v8.GCAL,n),f=(0,A.vm)(),p=(0,A.dJ)(u.v8.GCAL),{isAuthenticated:h,startAuth:b,authBreakdown:v}=(0,A.ob)(u.v8.GCAL,{callerIdentifier:P,handleAuthSuccess:()=>{o("enabled_foccacia",!0)}}),y=L(),j=Z("calendar_search");if(f&&p&&h||f&&!p||f&&!v.firstParty||!c&&!i)return null;let w=a.formatMessage({defaultMessage:"Calendar search",id:"b7aUhdL5nd"}),M=a.formatMessage({defaultMessage:"Google Calendar",id:"kjenxGoM59"}),k={key:"gcal",label:f?M:w,icon:(0,s.jsx)(d.HI,{size:16})};if(!c&&i)return{...k,type:"switch",isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}};if(!h){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{...k,type:"button",isExternal:!0,secondaryText:f?t:e,onClick:()=>{b()},...f?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...m?null:y}}let _=h&&x;return{...k,type:"switch",isChecked:_,onClick:()=>{r("enabled_foccacia",!_)},tag:j,...m?null:y}},H=e=>{let{actions:t,currentModel:a}=e,n=(0,g.A)(),{conversation:r}=(0,S.oM)(),o=(0,i.h0)(),c=(0,O.Ob)(),{toggleSearchTool:m,toggleConversationSetting:x}=(0,T.D$)(r),f=(0,A.Ys)(u.v8.GMAIL),p=(0,l.Wq)()(a,"gsuite_tools"),h=(0,A.X0)(u.v8.GMAIL,r),b=L(),v=Z("gmail_search"),y=(0,A.vm)(),j=(0,A.dJ)(u.v8.GMAIL),{isAuthenticated:w,startAuth:M,authBreakdown:k}=(0,A.ob)(u.v8.GMAIL,{callerIdentifier:P,handleAuthSuccess:()=>{x("enabled_sourdough",!0)}});if(y&&j&&w||y&&!j||y&&!k.firstParty||!f&&!c)return null;let _=n.formatMessage({defaultMessage:"Gmail search",id:"v0qteoUCm+"}),C=n.formatMessage({defaultMessage:"Gmail",id:"2hslSeuDXe"}),N={key:"gmail",label:y?C:_,icon:(0,s.jsx)(d.kw,{size:16})};if(!f&&c&&!o)return{...N,type:"switch",isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}};if(!w){let e=n.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),a=n.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{...N,type:"button",isExternal:!0,secondaryText:y?a:e,onClick:()=>{y?M():t.openGmailAuthModal()},...y?{tooltip:n.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...p?null:b}}let E=w&&h;return{...N,type:"switch",isChecked:E,onClick:()=>{m("enabled_sourdough",!E)},tag:v,...p?null:b}},K=e=>{let{actions:t}=e,a=(0,g.A)(),{personalizedStyle:n}=(0,S.oM)(),{personalizedStyleOptions:l}=(0,E.p)();return[...l.map(e=>{let a=(null==n?void 0:n.key)===e.key;return{key:e.key,type:"option",label:"default"===e.type&&e.nameKey?(0,s.jsx)(r.X5,{id:e.nameKey}):e.name,icon:(0,s.jsx)(o.P_O,{size:16}),onClick:()=>{a?t.onStyleChange("Default"):t.onStyleChange(e.key)},isChecked:a}}),{key:"divider1",type:"divider",label:""},{key:"add",type:"button",variant:"primary",icon:(0,s.jsx)(o.OMN,{size:16}),label:a.formatMessage({defaultMessage:"Create & edit styles",id:"cY+Fgc8HvE"}),onClick:t.openStyleModal,nonSearchable:!0}]},V=e=>{let{actions:t}=e,a=(0,g.A)(),n=(0,O.Hd)(),{personalizedStyle:l}=(0,S.oM)(),i=K({actions:t}),r=a.formatMessage({defaultMessage:"Use style",id:"f7VY0ldE+0"});return{key:m.xd.STYLES,type:"optionGroup",icon:(0,s.jsx)(o.P_O,{size:16}),label:r,secondaryText:(null==l?void 0:l.isDefault)||null==l?void 0:l.name,children:[...n?[]:[{type:"back",key:"styles-back",label:r}],...i],indicatorActive:l&&"Default"!==l.key}},W=e=>{let t,{currentModel:a,conversation:n}=e,l=(0,g.A)(),r=(0,_.vP)("paprika_mode"),d=(0,w.J)(),u=(0,w.j)()(a),x=(0,D.J)((0,_.rX)({source:"extendedThinkingMenuItem"}).toggleConversationSetting),p=(0,c.fS)("model_selector_enabled"),{data:v}=(0,b.EY)(),y=(0,i.h0)(),j=(0,f.useLayer)("trials_freemium"),M=L(),k=(0,O.Ob)(),A=!n||0===n.messagesSoFar,C=!y,N=j.get("free_thinking",!1),S=C&&N&&(null==v?void 0:v.remaining)===0,E=S&&r&&!A;(0,h.useEffect)(()=>{E&&x("paprika_mode",null)},[E]);let I=j.get("free_thinking",!1);if(!d||!p&&!I&&!k)return null;let T=l.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),R=!S&&!!r;if(C&&N&&v&&void 0!==v.remaining&&v.resets_at){let e=new Date(1e3*v.resets_at),a=l.formatDate(e,{month:"short",day:"numeric"});t=l.formatMessage({defaultMessage:"{remaining} remaining until {date}",id:"httnsxXSeU"},{remaining:v.remaining,date:a})}let P={key:m.xd.EXTENDED_THINKING,type:"switch",label:T,icon:(0,s.jsx)(o.Sw4,{size:16}),isChecked:R,indicatorActive:R,...t&&{subtitle:t},...S&&{isDisabled:!0,tag:"upgrade",rateLimitReached:!0,onClick:()=>{window.location.href="/upgrade"}}};return d&&(p||I&&!y)||!k||y?u?{...P,...S?{}:{onClick:()=>{x("paprika_mode",r?null:"extended")},tooltip:l.formatMessage({defaultMessage:"Allow Claude to think out loud for longer for trickier questions and challenges.",id:"bbgQqH7Grg"}),tooltipImage:{src:"/images/feature-preview/extended-thinking.png",width:200,height:108}}}:{...P,...M}:{...P,isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}}},B=e=>{let t,{currentModel:a,conversation:l}=e,i=(0,g.A)(),{setModel:r}=(0,S.oM)(),d=(0,_.vP)("compass_mode"),c=(0,y.g7)(),u=(0,y.BU)(),x=null!=l?l:void 0,f=(0,y.Gm)(x),p=(0,n.Z3)((null==l?void 0:l.id)||null),h=(0,y.G8)()(a),b=(0,y.G8)()(p),{toggleResearchMode:v,canAutoEnableWebSearch:j}=(0,T.D$)(x),w=(0,O.lS)(),M=!l&&!h&&b,k=L();if(!c||w)return null;let A="advanced"===d,C=!1;if(u)if(f||j){if(!h&&!M)return{key:m.xd.COMPASS,type:"switch",label:i.formatMessage({defaultMessage:"Research",id:"JEe7dVso7F"}),icon:(0,s.jsx)(o.isz,{size:20}),indicatorActive:!1,...k}}else C=!0,t=i.formatMessage({defaultMessage:"Enable a search integration to use research",id:"WyiVeak7w5"});else C=!0,t=i.formatMessage({defaultMessage:"Your administrator must enable a search tool to use research",id:"CzjOV5rgPZ"});return{key:m.xd.COMPASS,type:"switch",label:i.formatMessage({defaultMessage:"Research",id:"JEe7dVso7F"}),icon:(0,s.jsx)(o.isz,{size:20}),isChecked:A,indicatorActive:A,isDisabled:C,...t&&{tooltip:t},onClick:()=>{M&&r(p),v(!A)}}},J=e=>{let{showConnectAction:t,mcpToolsSetting:a,toggleMcpToolEnabled:l,remoteOnly:i,activeServers:r}=e,d=(0,O.lS)(),u=(0,g.A)(),m=(0,k.Q)(),x=(0,c.fS)("chrome_ext_mcp_model_selector"),f=(0,c.fS)("chrome_ext_mcp_integration"),{conversation:p,model:h}=(0,S.oM)(),b=(0,n.Z3)((null==p?void 0:p.id)||null),v=null!=h?h:b,y=(0,R.Uz)({isConnecting:!1,...i?{type:"remote"}:{},...t?{}:{isConnected:!0}}),j=L();return(d&&r?y.filter(e=>r.has(e.uuid)):y).map(e=>{let t={key:e.uuid,label:e.name,icon:(0,s.jsx)(I.z,{size:16,type:e.iconType,src:e.iconSrc,name:e.name})};if(!e.isConnected)return{...t,type:"button",isExternal:!0,secondaryText:u.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),onClick:()=>m({uuid:e.uuid,url:e.url})};let n=e.tools.map(t=>{let n=t.enabledKey,i=!1!==a[n],r=(0,N.Xz)({uuid:e.uuid,model:v,bypassGate:x,isChromeExtEnabled:f});return{key:n,type:"switch",label:t.displayName,icon:(0,s.jsx)(I.z,{size:16,type:e.iconType,src:e.iconSrc,name:e.name}),isChecked:i,onClick:()=>{l(n,!i,e.url)},...r?j:{}}}),i=n.filter(e=>"switch"===e.type&&e.isChecked).length,c=i>0,h=e.tools.length,g=[];n.length>1&&g.push({key:"select-all",type:"button",label:c?u.formatMessage({defaultMessage:"Disable all tools",id:"8A9N39nihk"}):u.formatMessage({defaultMessage:"Enable all tools",id:"x4/g36jIjW"}),onClick:()=>{l(e.tools.map(e=>e.enabledKey),!c,e.url)},skipCloseOnClick:!0,nonSearchable:!0},{key:"divider1",type:"divider",label:""}),g.push(...n),0===g.length&&g.push({key:"empty",type:"button",label:u.formatMessage({defaultMessage:"No tools available",id:"+XSkrzcF/0"}),icon:(0,s.jsx)(o.k0E,{size:16}),onClick:()=>void 0,isDisabled:!0});let b={enabledCount:i,totalCount:h,isChecked:c,onClick:()=>{l(e.tools.map(e=>e.enabledKey),!c,e.url)}};return d?{...t,...b,isChecked:!!r||b.isChecked,isDisabled:!!(null==p?void 0:p.id),type:"toggle"}:{...t,...b,type:"toggleGroup",children:g}})},q=e=>{var t;let{sessionMcpServers:a}=e,s=null!=(t=(0,_.vP)("enabled_mcp_tools"))?t:{},{toggleMcpToolEnabled:n}=(0,M.es)();return J({showConnectAction:!1,mcpToolsSetting:s,toggleMcpToolEnabled:n,activeServers:(0,h.useMemo)(()=>a?new Set(a.map(e=>e.name)):void 0,[a])})},X=()=>{var e;let t=(0,R.Uz)({type:"remote"}),a=null!=(e=(0,_.vP)("enabled_mcp_tools"))?e:{},[s,n]=(0,h.useState)(()=>{let e=new Set(t.map(e=>e.uuid));return Object.fromEntries(Object.entries(a).filter(t=>{let[a]=t,s=a.split(":")[0];return e.has(s)}))});return{menuOptions:J({showConnectAction:!1,mcpToolsSetting:s,toggleMcpToolEnabled:function(e,t){n(a=>({...a,...Array.isArray(e)?Object.fromEntries(e.map(e=>[e,t])):{[e]:t}}))},remoteOnly:!0}),getEnabledRemoteTools:()=>{let e=[];for(let a of t)for(let t of a.tools)!1!==s[t.enabledKey]&&e.push({tool_name:t.name,server_uuid:a.uuid});return e}}},Z=e=>(0,f.useDynamicConfig)("claude_ai_beta_tools").get("beta_tools",[]).includes(e)?"beta":void 0}}]);