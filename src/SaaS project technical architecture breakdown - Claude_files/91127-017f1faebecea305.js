try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f6630f6c-003f-49df-9268-0e2f70af361c",e._sentryDebugIdIdentifier="sentry-dbid-f6630f6c-003f-49df-9268-0e2f70af361c")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91127],{0x2662014e:(e,t,r)=>{r.d(t,{c:()=>i});let i=(0,r(0x394ef833).v)((e,t)=>({currentRequest:null,setCurrentRequest:t=>e({currentRequest:t}),clearCurrentRequest:()=>{e({currentRequest:null})},acceptElicitation:r=>{let i=t().currentRequest;i&&(i.resolve({action:"accept",content:r}),e({currentRequest:null}))},declineElicitation:()=>{let r=t().currentRequest;r&&(r.resolve({action:"decline"}),e({currentRequest:null}))},cancelElicitation:()=>{let r=t().currentRequest;r&&(r.resolve({action:"cancel"}),e({currentRequest:null}))}}))},0x62983db6:(e,t,r)=>{r.d(t,{F:()=>l,R:()=>d});var i=r(0x139b5e710),n=r(0x18393fe29),s=r(0x10e01d04d),o=r(0xfc89b4a4),a=r(0xe824fb1c),c=r(0x2662014e),u=r(0xc6857cab);function l(){return!!(0,n.yz)()&&!u.env.DONT_USE_ELICITATION_MCP}function d(){let e=l(),{clients:t,clientMetadata:r}=(0,a.Ak)(),{setCurrentRequest:n}=(0,c.c)(),{addError:u}=(0,i.Y)();(0,o.useEffect)(()=>{if(e)return t.forEach(e=>{let t=r.get(e);e.setRequestHandler(s.$9,async e=>new Promise((r,i)=>{n({id:"".concat(Date.now(),"-").concat(Math.random()),serverName:t.name,iconType:t.iconType,iconSrc:t.iconSrc,request:e,resolve:r,reject:i})}))}),()=>{e&&t.forEach(e=>{e.removeRequestHandler(s.$9.shape.method.value)})}},[e,t,r,n,u])}},0xab063a97:(e,t,r)=>{r.d(t,{ConnectorsStore:()=>z});var i=r(0x14c0dfde7),n=r(0x21edecce6),s=r(0x19d2abba6),o=r(0x156c4e43b);function a(){let e=new s._({name:"Elicitation Test",version:"1.0.0"});return e.tool("elicit_confirmation","Elicitation confirmation tool",{style:o.k5(["bool","enum","no-field"])},async t=>{let{style:r}=t,i=await e.server.elicitInput({message:"Do you confirm you want to proceed?",requestedSchema:{type:"object",properties:"no-field"===r?{}:{confirm:"enum"===r?{title:"Confirm",type:"string",enum:["yes","no"],enumNames:["Yes, I confirm","No, cancel"]}:{title:"Confirm",type:"boolean",description:"Please confirm your action"}},required:["confirm"]}});return{content:[{type:"text",text:"Elicitation result: ".concat(JSON.stringify(i,null,2))}]}}),e.tool("elicit_inputs","Elicitation test tool",{},async(t,r)=>{let i=await e.server.elicitInput({message:"Please provide inputs for the following fields:",requestedSchema:{type:"object",properties:{name:{title:"Full Name",type:"string",description:"Your full, legal name"},check:{title:"Agree to terms",type:"boolean",description:"A boolean check"},color:{title:"Favorite Color",type:"string",description:"Favorite color (open text)",default:"blue"},email:{title:"Email Address",type:"string",format:"email",description:"Your email address (will be verified, and never shared with anyone else)"},homepage:{type:"string",format:"uri",description:"Homepage / personal site"},birthdate:{title:"Birthdate",type:"string",format:"date",description:"Your date of birth (will never be shared with anyone else)"},integer:{title:"Favorite Integer",type:"integer",description:"Your favorite integer (do not give us your phone number, pin, or other sensitive info)",minimum:1,maximum:100,default:42},number:{title:"Favorite Number",type:"number",description:"Favorite number (there are no wrong answers)",minimum:0,maximum:1e3,default:3.14},petType:{title:"Pet type",type:"string",enum:["cats","dogs","birds","fish","reptiles"],enumNames:["Cats","Dogs","Birds","Fish","Reptiles"],default:"dogs",description:"Your favorite pet type"}},required:["name"]}},{relatedRequestId:r.requestId,timeout:1e8});return{content:[{type:"text",text:"Elicitation result: ".concat(JSON.stringify(i,null,2))}]}}),e.tool("write_poem","Poem writing tool",{},async()=>{let t=await e.server.elicitInput({message:"Please provide inputs for the following fields:",requestedSchema:{type:"object",properties:{subject:{type:"string",title:"Subject",description:"Subject of the poem",enum:["Nature","Love","Adventure","Friendship","Mystery","Fantasy","Humor","Inspiration","Life","Death"]}},required:["subject"]}});if("accept"!==t.action||!(null==t?void 0:t.data))throw Error("Elicitation was not accepted or no data provided");let{subject:r}=t.data;return{content:[{type:"text",text:"TODO: write a poem about ".concat(r)}]}}),e}var c=r(0xf32c56dd),u=r(0x12c9046cd),l=r(0x14de19ae8),d=r(0x139b5e710),m=r(0x10e01d04d),p=r(0xfc89b4a4),h=r(0xe824fb1c);function f(){let e=new s._({name:"Demo",version:"1.0.0"});return e.tool("add",{a:o.ai(),b:o.ai()},e=>{let{a:t,b:r}=e;return{content:[{type:"text",text:String(t+r)}]}}),e.tool("greet_person",{name:o.Yj(),greeting:o.Yj()},e=>{let{name:t,greeting:r}=e;return{content:[{type:"text",text:"Message sent to ".concat(t,": ").concat(r," ").concat(t,"!")}]}}),e.registerTool("draft_email",{description:"Draft an email",inputSchema:{recipientName:o.Yj().optional().describe("Recipient name"),recipientEmail:o.Yj().email().optional().describe("Recipient email address"),subject:o.Yj().describe("Email subject")}},async(t,r)=>{let{recipientName:i,recipientEmail:n,subject:s}=t,o=await e.server.elicitInput({message:"Please validate this email draft",requestedSchema:{type:"object",properties:{recipientName:{type:"string",description:"Recipient name",default:i},recipientEmail:{type:"string",format:"email",description:"Recipient email",default:n},subject:{type:"string",description:"Subject",default:s},body:{type:"string",description:"Body",default:"Ad Consectetur Et\n\nLorem Ipsum enim lorem quis ad dolor sed incididunt veniam sit et incididunt. Et dolor ad amet sed dolor minim ipsum dolor aliqua et. Adipiscing ad dolore eiusmod lorem minim ipsum sed dolore elit consectetur. Et sit labore lorem incididunt labore nostrud enim enim. Dolore ipsum ipsum dolor elit do consectetur labore quis elit ipsum ad. Ad quis labore eiusmod sit ipsum elit minim labore sit consectetur eiusmod ut quis sit. Elit minim adipiscing do magna consectetur minim sed aliqua nostrud minim magna quis incididunt. Do enim magna et dolor ut amet ut.\n\nAmet elit sed dolore magna ut sed do aliqua ipsum nostrud et aliqua veniam. Sed incididunt tempor quis ad magna do do. Consectetur incididunt et incididunt dolore labore labore ad enim lorem ipsum et. Magna dolore do ipsum elit do lorem et lorem minim et ad sed. Adipiscing labore sed quis incididunt dolor dolor quis sit sed ipsum amet minim. Sed ad ut incididunt minim adipiscing dolor eiusmod ad nostrud. Amet ut sit et magna veniam dolor enim elit sed ipsum aliqua. Incididunt ipsum veniam veniam amet amet quis sit ut.\n\nEnim incididunt eiusmod dolor magna incididunt dolor quis quis minim incididunt incididunt. Incididunt minim et elit ipsum labore consectetur amet tempor enim. Ad magna sit aliqua sit adipiscing do ut. Sit aliqua nostrud et elit do veniam incididunt dolore ad magna enim lorem ipsum. Sed magna eiusmod magna nostrud consectetur dolor quis dolore ut. Consectetur lorem sed sit adipiscing magna ad consectetur do sit ad elit sed lorem. Adipiscing veniam quis nostrud aliqua eiusmod magna do labore et enim eiusmod dolor. Minim minim ipsum lorem quis eiusmod do do magna minim quis ut."}},required:["subject","body","recipientEmail"]}},{relatedRequestId:r.requestId});if("accept"!==o.action)return{content:[{type:"text",text:"Email drafting cancelled by user."}],isError:!0};let a={confirmation:"Email sent! (just kidding)",...o.content};return{content:[{type:"text",text:JSON.stringify(a,null,2)}],structuredContent:a}}),e.resource("Available greetings","greeting://all_greetings",e=>({contents:[{uri:e.href,text:"Hello!"},{uri:e.href,text:"Hi!"},{uri:e.href,text:"Hey!"}]})),e.registerTool("structuredContent",{description:"Returns some structured content",inputSchema:{backwardsCompatible:o.zM().describe("Whether to include the structured content in the content blocks as well (as per MCP spec recommendation, for backwards compatibility)")},outputSchema:{message:o.Yj()}},e=>{let{backwardsCompatible:t}=e,r={message:"Your name is now Claudette."};return{content:t?[{type:"text",text:JSON.stringify(r)}]:[],structuredContent:r}}),e.registerPrompt("ask_to_greet",{description:"Generate a prompt to ask the assistant to greet someone",argsSchema:{name:o.Yj().describe("Name of the person to greet")}},e=>{let{name:t}=e;return{messages:[{role:"user",content:{type:"text",text:"Please greet: ".concat(t)}}]}}),e}m.u9.shape.params;var g=r(0x18393fe29),y=r(0xac309a83),v=r(0x85e0fa34),b=r(0x134b9be24),_=r(0x62983db6);function C(){let e={};return(0,_.F)()&&(e.elicitation={}),new b.K({name:"claude-ai",version:"0.1.0"},{capabilities:e})}async function w(e){let t=C();return await t.connect(e),t}var k=r(0xc6857cab);let S=(e,t)=>{let r=(0,y.fS)("claude_ai_unicode_sanitize_mcp_data");(0,p.useEffect)(()=>{!async function(){if((0,g.yz)()&&!k.env.DONT_USE_EXAMPLE_MCP){let i=t(),[n,s]=v.W.createLinkedPair();(async()=>{await i.connect(s)})(),await w(n).then(t=>{(0,h.jh)(e,t),(0,h.fR)(e,t,r),(0,h.BG)(e,t),(0,h.zC)(e,t)})}}()},[r,e,t])};r(0x21e26ba67);var x=r(0x2252bfeb8),q=r(0x9845e38c);function R(e){let t=(0,p.useRef)(e);return(0,p.useEffect)(()=>{t.current=e},[e]),(0,p.useCallback)(function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.current(...r)},[])}var E=r(0x1d0eef17);class T{start(){return this._port.onmessage=e=>{var t;null==(t=this.onmessage)||t.call(this,e.data)},this._port.onmessageerror=e=>{var t;null==(t=this.onerror)||t.call(this,Error("MessagePort message error: ".concat(e.data)))},Promise.resolve()}close(){var e;return this._port.close(),null==(e=this.onclose)||e.call(this),Promise.resolve()}send(e){return this._port.postMessage(e),Promise.resolve()}constructor(e){this._port=e}}let M=()=>{let{track:e}=(0,c.st)(),t=R(e),r=(0,p.useCallback)(e=>{t({event_key:"mcp.websocket.authfailure",server_uuid:e})},[t]),i=(0,p.useCallback)((e,r)=>{t({event_key:"mcp.websocket.transport.connection.failed",server_uuid:e,used_authentication:r})},[t]),n=(0,p.useCallback)(e=>{t({event_key:"mcp.tools.listed",tool_count_on_server:e})},[t]);return{trackMcpServerAuthFailure:r,trackMcpServerConnectionFailed:i,trackMcpToolsListed:n,trackMcpResourcesListed:(0,p.useCallback)(e=>{t({event_key:"mcp.resources.listed",resource_count_on_server:e})},[t]),trackMcpPromptsListed:(0,p.useCallback)(e=>{t({event_key:"mcp.prompts.listed",prompt_count_on_server:e})},[t])}},P=Symbol();async function N(e){return w(new T(e))}var A=r(0x4d348f95),I=r(0x1ab0d1ca1),D=r(0x253a5c787),L=r(0x1d302b010),j=r(0x8475f78a),F=r(0x1db5af03),O=r(0xeac745ba),Y=r(0x78b33fbd);class H extends Error{constructor(e){super(e||"Authentication error"),this.name="UnauthedError"}}class W{start(){if(this._socket)throw Error("WebSocketClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,t)=>{this._socket=new WebSocket(this._url,["mcp"]),this._socket.onerror=e=>{var r;let i="error"in e?e.error:Error("WebSocket error: ".concat(JSON.stringify(e)));t(i),null==(r=this.onerror)||r.call(this,i)},this._socket.onopen=()=>{e()},this._socket.onclose=e=>{var t;null==(t=this.onclose)||t.call(this)},this._socket.onmessage=e=>{var t,r,i,n,s;let o,a;try{o=JSON.parse(e.data)}catch(e){null==(r=this.onerror)||r.call(this,e);return}let c=o;if("mcp_unauthorized"===c.error_code){null==(i=this.onAuthError)||i.call(this,new H(c.error||"Authentication required"));return}try{a=m.OR.parse(o)}catch(e){null==(n=this.onerror)||n.call(this,e);return}let u=a;if("connected"===u.method&&u.params){null==(s=this.onConnect)||s.call(this,u.params.used_auth);return}null==(t=this.onmessage)||t.call(this,a)}})}async close(){var e;null==(e=this._socket)||e.close()}send(e){return new Promise((t,r)=>{var i;if(!this._socket)return void r(Error("Not connected"));null==(i=this._socket)||i.send(JSON.stringify(e)),t()})}constructor(e){this._url=e}}class B{async refreshClient(){return this.cachedClient=await this.getClient(),this.cachedClient}disconnectIfNoOngoingRequests(){this.cachedClient&&0===this.inflightRequestCount&&(this.cachedClient.close(),this.cachedClient=void 0)}clearTimeout(){this.debouncedDisconnectTimeout&&(clearTimeout(this.debouncedDisconnectTimeout),this.debouncedDisconnectTimeout=null)}beforeRequest(){this.inflightRequestCount++,this.clearTimeout()}afterRequest(){this.inflightRequestCount--,this.clearTimeout(),null!==this.disconnectTimeout&&(this.debouncedDisconnectTimeout=setTimeout(()=>{this.disconnectIfNoOngoingRequests()},this.disconnectTimeout))}async useClient(e){this.beforeRequest();try{return await e(await this.refreshClient())}finally{this.afterRequest()}}async initialize(){await this.refreshClient()}async connect(e){throw await Promise.resolve(),Error("Cannot call connect on a wrapped client")}async close(){var e;return null==(e=this.cachedClient)?void 0:e.close()}async registerCapabilities(e){return(await this.refreshClient()).registerCapabilities(e)}getServerCapabilities(){var e;return null==(e=this.cachedClient)?void 0:e.getServerCapabilities()}getServerVersion(){var e;return null==(e=this.cachedClient)?void 0:e.getServerVersion()}getInstructions(){var e;return null==(e=this.cachedClient)?void 0:e.getInstructions()}async ping(e){return(await this.refreshClient()).ping(e)}async complete(e,t){return this.useClient(r=>r.complete(e,t))}async setLoggingLevel(e,t){return this.useClient(r=>r.setLoggingLevel(e,t))}async getPrompt(e,t){return this.useClient(r=>r.getPrompt(e,t))}async listPrompts(e,t){return this.useClient(r=>r.listPrompts(e,t))}async listResources(e,t){return this.useClient(r=>r.listResources(e,t))}async listResourceTemplates(e,t){return this.useClient(r=>r.listResourceTemplates(e,t))}async readResource(e,t){return this.useClient(r=>r.readResource(e,t))}async subscribeResource(e,t){return this.useClient(r=>r.subscribeResource(e,t))}async unsubscribeResource(e,t){return this.useClient(r=>r.unsubscribeResource(e,t))}async callTool(e,t,r){return this.useClient(i=>i.callTool(e,t,r))}async listTools(e,t){return this.useClient(r=>r.listTools(e,t))}async sendRootsListChanged(){return this.useClient(e=>e.sendRootsListChanged())}async request(e,t,r){return this.useClient(i=>i.request(e,t,r))}async notification(e){return this.useClient(t=>t.notification(e))}async setRequestHandler(e,t){return(await this.refreshClient()).setRequestHandler(e,t)}async removeRequestHandler(e){return(await this.refreshClient()).removeRequestHandler(e)}async assertCanSetRequestHandler(e){return(await this.refreshClient()).assertCanSetRequestHandler(e)}async setNotificationHandler(e,t){return(await this.refreshClient()).setNotificationHandler(e,t)}async removeNotificationHandler(e){return(await this.refreshClient()).removeNotificationHandler(e)}async assertCapabilityForMethod(e){return(await this.refreshClient()).assertCapabilityForMethod(e)}async assertNotificationCapability(e){return(await this.refreshClient()).assertNotificationCapability(e)}async assertRequestHandlerCapability(e){return(await this.refreshClient()).assertRequestHandlerCapability(e)}get transport(){var e;return null==(e=this.cachedClient)?void 0:e.transport}constructor(e,t,r=null){this.getClient=e,this.cachedClient=t,this.disconnectTimeout=r,this.debouncedDisconnectTimeout=null,this.inflightRequestCount=0}}var U=r(0xc6857cab);async function Z(e,t,r,i){let n=function(){if((0,g.yz)()){if(U.env.NEXT_MCP_WEBSOCKET_PROXY)return U.env.NEXT_MCP_WEBSOCKET_PROXY;let e=U.env.NEXT_PUBLIC_MCP_WEBSOCKET_BACKEND||"http://localhost:8000";if(null==e?void 0:e.startsWith("http"))return e.replace("http","ws");if(null==e?void 0:e.startsWith("ws"))return e.replace("https","wss")}return""}(),s=new W("".concat(n,"/api/ws/organizations/").concat(e,"/mcp/servers/").concat(t,"/"));s.onAuthError=r,s.onConnect=i;let o=C();return await o.connect(s),o}function z(){let e=(0,n.p)();return!function(e){let{activeOrganization:t}=(0,l.YL)(),r=null==t?void 0:t.uuid,{track:n}=(0,c.st)(),s=M(),o=function(){let{value:e}=(0,Y.useDynamicConfig)("apps_mcp_ws_reconnect_config");return e}(),a=(0,y.fS)("claude_ai_unicode_sanitize_mcp_data"),u=(0,i.p9)(),d=(0,y.fS)("mcp_shadow_comparison");d&&O.Z.getState().setTrackFn(n,Date.now());let m=(0,F.O)(e=>e.serversNeedingWebsocketRetry),{data:f,isLoading:g}=(0,L.eB)(r),v=u?m:f,b=null==o?void 0:o.reconnect_enabled,_=(null==o?void 0:o.disconnect_enabled)&&(null==o?void 0:o.disconnect_timeout)||null,C=(0,p.useCallback)(async(e,t)=>{let r=e=>{(0,D.Cp)(e,{tags:{serverUuid:t.uuid}}),s.trackMcpServerAuthFailure(t.uuid),(0,h.Ug)(t.uuid)},i=e=>{(0,h.n3)(t.uuid,e),(async()=>{let e=await (0,h.xk)(t.uuid);if(!e){(0,D.Cp)(Error("Client is undefined after connection"),{tags:{serverUuid:t.uuid}}),(0,h.Ug)(t.uuid);return}(0,h.MR)(t.uuid,e,a).then(e=>{if(s.trackMcpToolsListed(e.length),d){let r=Date.now(),i=O.Z.getState().websocketStartTime;O.Z.getState().recordWebsocketTools(t.uuid,{count:e.length,duration_ms:r-i,success:!0})}}).catch(()=>{if(d){let e=Date.now(),r=O.Z.getState().websocketStartTime;O.Z.getState().recordWebsocketTools(t.uuid,{count:0,duration_ms:e-r,success:!1})}}),(0,h.k$)(t.uuid,e).then(e=>{if(s.trackMcpPromptsListed(e.length),d){let r=Date.now(),i=O.Z.getState().websocketStartTime;O.Z.getState().recordWebsocketPrompts(t.uuid,{count:e.length,duration_ms:r-i,success:!0})}}).catch(()=>{if(d){let e=Date.now(),r=O.Z.getState().websocketStartTime;O.Z.getState().recordWebsocketPrompts(t.uuid,{count:0,duration_ms:e-r,success:!1})}}),(0,h.aF)(t.uuid,e).then(e=>{if(s.trackMcpResourcesListed(e.length),d){let r=Date.now(),i=O.Z.getState().websocketStartTime;O.Z.getState().recordWebsocketResources(t.uuid,{count:e.length,duration_ms:r-i,success:!0})}}).catch(()=>{if(d){let e=Date.now(),r=O.Z.getState().websocketStartTime;O.Z.getState().recordWebsocketResources(t.uuid,{count:0,duration_ms:e-r,success:!1})}})})()};try{let n=async()=>{let n=await (0,h.xk)(t.uuid);if(n&&n&&(null==n?void 0:n.transport)!==void 0)return n;let s=Z(e,t.uuid,r,i);(0,h.kc)((0,j.Ic)(t.uuid),s);let o=await s;return(0,h.kc)((0,j.Ic)(t.uuid),o),o},s=await n(),o=b?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new B(e,t,r)}(async()=>n(),s,_):s;(0,h.kc)(t.uuid,o)}catch(e){s.trackMcpServerConnectionFailed(t.uuid,!1),(0,D.Cp)(e,{tags:{serverUuid:t.uuid}}),(0,h.Ug)(t.uuid)}},[b,_,a,s,d]);(0,p.useEffect)(()=>{(0,h.pZ)(null!=g&&g)},[g]),(0,p.useEffect)(()=>{if(r&&v)for(let t of v)(0,h.s$)(t.uuid)&&((0,h.nd)(t.uuid)&&((0,h.rD)(t),(0,h.I3)(t.uuid,t.url,e)),C(r,t))},[v,C,r,u,e])}(e),(0,i.oQ)(e),!function(){let{addError:e}=(0,d.Y)(),{track:t}=(0,c.st)(),r=R(t),i=M(),n=(0,y.fS)("claude_ai_unicode_sanitize_mcp_data"),s=(0,y.fS)("chrome_ext_mcp_integration"),[o,a]=(0,p.useState)(P),u=(0,p.useCallback)(t=>{(0,h.dY)(t)||window.claudeAppBindings.connectToMcpServer(t).catch(r=>{q.v.error(q.u.MCP,"Could not connect to MCP server ".concat(t),r),e("Could not connect to MCP server ".concat(t),{error:r})})},[e]);(0,p.useEffect)(()=>{let e=!1;return(async()=>{var t,i;if(!(null==(t=window.claudeAppBindings)?void 0:t.listMcpServers)||!(null==(i=window.claudeAppBindings)?void 0:i.connectToMcpServer))return;o===P&&(0,h.kU)(!0);let n=(await window.claudeAppBindings.listMcpServers()).filter(e=>"Claude for Chrome"!==e||!!s);if(r({event_key:"mcp.servers.listed",server_count:n.length}),(0,h.kU)(!1),!e)for(let e of n)u(e)})(),()=>{e=!0}},[u,r,o,s]);let l=(0,p.useCallback)(t=>{if(t.source!==window)return;let{type:s,serverName:o,uuid:c}=t.data;if("mcp-server-auto-reconnect"===s&&o){(0,h.H)(o),a(Symbol());return}if("mcp-server-connected"!==s||!o)return;let[u]=t.ports;N(u).then(e=>{(0,h.jh)(o,e,c),(0,h.fR)(o,e,n).then(e=>{i.trackMcpToolsListed(e.length)}),(0,h.BG)(o,e).then(e=>{i.trackMcpPromptsListed(e.length)}),(0,h.zC)(o,e).then(e=>{i.trackMcpResourcesListed(e.length)}),r({event_key:"mcp.servers.connected",result:"success"})},t=>{e("Could not attach to MCP server ".concat(o),{error:t}),r({event_key:"mcp.servers.connected",result:"failure"})})},[e,r,n,i]);(0,E.M)("message",l),(0,p.useEffect)(()=>{(async()=>{try{var e;let t=await (null===x.Fd||void 0===x.Fd||null==(e=x.Fd.getInstalledExtensionsWithState)?void 0:e.call(x.Fd));null==t||t.forEach(e=>{var t;(0,h.yt)(null!=(t=e.manifest.display_name)?t:e.manifest.name,e)})}catch(e){}})()},[])}(),S("exampleServer",f),S("elicitationServer",a),!function(){let{clients:e}=(0,h.Ak)(),{addError:t}=(0,d.Y)(),{track:r}=(0,c.st)(),{activeOrganization:i}=(0,l.YL)(),n=(0,u.L2)("/api/organizations/".concat(null==i?void 0:i.uuid,"/dust/mcp_messages"),"POST",{enabled:!1,onError:()=>t("MCP sampling failed",{errorContext:{tags:{source:"mcp_sampling"}}})});(0,p.useEffect)(()=>{},[!1,e,n,r])}(),(0,_.R)(),!function(){let e=(0,I.A)(),t=(0,A.useSearchParams)(),{addError:r,addSuccess:i}=(0,d.Y)(),n=t.get("server"),s=t.get("step"),o=t.get("oauth_error"),a=t.get("oauth_error_description"),u=t.get("oauth_error_uri"),{track:l}=(0,c.st)();(0,p.useEffect)(()=>{let t=(0,h.et)(n||""),c=null==t?void 0:t.name;if(n&&s&&c){l({event_key:"claudeai.mcp.auth.completed",result:s,uuid:n,url:null==t?void 0:t.url});let d="";switch(o&&(d=" (".concat(o),a&&(d+=": ".concat(a)),u&&(d+=", ".concat(u)),d+=")"),s){case"success":i(e.formatMessage({defaultMessage:"Connected to {serverName}.",id:"WdZqvX3coc"},{serverName:c}));break;case"start_error":r(e.formatMessage({defaultMessage:"There was an error connecting to {serverName}. Please check your server URL and make sure your server handles auth correctly.",id:"pwACugMrqk"},{serverName:c}),{messageForLogging:"There was an error connecting to {serverName}. Please check your server URL and make sure your server handles auth correctly."});break;case"end_error":r(e.formatMessage({defaultMessage:"Error connecting to {serverName}. Please confirm that you have permission to access the service, that you’re using the correct credentials, and that your server handles auth correctly.",id:"x0m0Pdvskh"},{serverName:c})+d,{messageForLogging:"Error connecting to {serverName}. Please confirm that you have permission to access the service, that you’re using the correct credentials, and that your server handles auth correctly."});break;default:r(e.formatMessage({defaultMessage:"An unknown error occurred connecting to {serverName}.",id:"dURdJpCNlT"},{serverName:c}),{messageForLogging:"An unknown error occurred connecting to {serverName}."})}let m=new URL(window.location.href);m.searchParams.delete("server"),m.searchParams.delete("step"),window.history.replaceState({},"",m)}},[n,s,o,a,u,e,r,i,l])}(),null}}}]);